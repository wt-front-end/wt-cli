import{_ as bi}from"./_plugin-vue_export-helper-c27b6911.js";import{o as wi,f as xi,a as Si,c as Ei}from"./index-3e1575e6.js";function et(n,t){for(var e=0;e<t.length;e++){const r=t[e];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in n)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(n,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}const Y=Object.create(null);Y.open="0";Y.close="1";Y.ping="2";Y.pong="3";Y.message="4";Y.upgrade="5";Y.noop="6";const Ve=Object.create(null);Object.keys(Y).forEach(n=>{Ve[Y[n]]=n});const Ai={type:"error",data:"parser error"},Li=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Ri=typeof ArrayBuffer=="function",Ti=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n&&n.buffer instanceof ArrayBuffer,Wr=({type:n,data:t},e,r)=>Li&&t instanceof Blob?e?r(t):_r(t,r):Ri&&(t instanceof ArrayBuffer||Ti(t))?e?r(t):_r(new Blob([t]),r):r(Y[n]+(t||"")),_r=(n,t)=>{const e=new FileReader;return e.onload=function(){const r=e.result.split(",")[1];t("b"+(r||""))},e.readAsDataURL(n)},dr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Se=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let n=0;n<dr.length;n++)Se[dr.charCodeAt(n)]=n;const ki=n=>{let t=n.length*.75,e=n.length,r,i=0,s,a,c,o;n[n.length-1]==="="&&(t--,n[n.length-2]==="="&&t--);const l=new ArrayBuffer(t),u=new Uint8Array(l);for(r=0;r<e;r+=4)s=Se[n.charCodeAt(r)],a=Se[n.charCodeAt(r+1)],c=Se[n.charCodeAt(r+2)],o=Se[n.charCodeAt(r+3)],u[i++]=s<<2|a>>4,u[i++]=(a&15)<<4|c>>2,u[i++]=(c&3)<<6|o&63;return l},Di=typeof ArrayBuffer=="function",Ur=(n,t)=>{if(typeof n!="string")return{type:"message",data:jr(n,t)};const e=n.charAt(0);return e==="b"?{type:"message",data:Mi(n.substring(1),t)}:Ve[e]?n.length>1?{type:Ve[e],data:n.substring(1)}:{type:Ve[e]}:Ai},Mi=(n,t)=>{if(Di){const e=ki(n);return jr(e,t)}else return{base64:!0,data:n}},jr=(n,t)=>{switch(t){case"blob":return n instanceof ArrayBuffer?new Blob([n]):n;case"arraybuffer":default:return n}},$r=String.fromCharCode(30),Bi=(n,t)=>{const e=n.length,r=new Array(e);let i=0;n.forEach((s,a)=>{Wr(s,!1,c=>{r[a]=c,++i===e&&t(r.join($r))})})},Oi=(n,t)=>{const e=n.split($r),r=[];for(let i=0;i<e.length;i++){const s=Ur(e[i],t);if(r.push(s),s.type==="error")break}return r},Kr=4;function D(n){if(n)return Hi(n)}function Hi(n){for(var t in D.prototype)n[t]=D.prototype[t];return n}D.prototype.on=D.prototype.addEventListener=function(n,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+n]=this._callbacks["$"+n]||[]).push(t),this};D.prototype.once=function(n,t){function e(){this.off(n,e),t.apply(this,arguments)}return e.fn=t,this.on(n,e),this};D.prototype.off=D.prototype.removeListener=D.prototype.removeAllListeners=D.prototype.removeEventListener=function(n,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var e=this._callbacks["$"+n];if(!e)return this;if(arguments.length==1)return delete this._callbacks["$"+n],this;for(var r,i=0;i<e.length;i++)if(r=e[i],r===t||r.fn===t){e.splice(i,1);break}return e.length===0&&delete this._callbacks["$"+n],this};D.prototype.emit=function(n){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),e=this._callbacks["$"+n],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(e){e=e.slice(0);for(var r=0,i=e.length;r<i;++r)e[r].apply(this,t)}return this};D.prototype.emitReserved=D.prototype.emit;D.prototype.listeners=function(n){return this._callbacks=this._callbacks||{},this._callbacks["$"+n]||[]};D.prototype.hasListeners=function(n){return!!this.listeners(n).length};const W=(()=>typeof self<"u"?self:typeof window<"u"?window:Function("return this")())();function zr(n,...t){return t.reduce((e,r)=>(n.hasOwnProperty(r)&&(e[r]=n[r]),e),{})}const Fi=W.setTimeout,Pi=W.clearTimeout;function tt(n,t){t.useNativeTimers?(n.setTimeoutFn=Fi.bind(W),n.clearTimeoutFn=Pi.bind(W)):(n.setTimeoutFn=W.setTimeout.bind(W),n.clearTimeoutFn=W.clearTimeout.bind(W))}const Ii=1.33;function Ni(n){return typeof n=="string"?Wi(n):Math.ceil((n.byteLength||n.size)*Ii)}function Wi(n){let t=0,e=0;for(let r=0,i=n.length;r<i;r++)t=n.charCodeAt(r),t<128?e+=1:t<2048?e+=2:t<55296||t>=57344?e+=3:(r++,e+=4);return e}class Ui extends Error{constructor(t,e,r){super(t),this.description=e,this.context=r,this.type="TransportError"}}class qr extends D{constructor(t){super(),this.writable=!1,tt(this,t),this.opts=t,this.query=t.query,this.socket=t.socket}onError(t,e,r){return super.emitReserved("error",new Ui(t,e,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const e=Ur(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}}const Vr="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),xt=64,ji={};let pr=0,Fe=0,mr;function yr(n){let t="";do t=Vr[n%xt]+t,n=Math.floor(n/xt);while(n>0);return t}function Gr(){const n=yr(+new Date);return n!==mr?(pr=0,mr=n):n+"."+yr(pr++)}for(;Fe<xt;Fe++)ji[Vr[Fe]]=Fe;function Yr(n){let t="";for(let e in n)n.hasOwnProperty(e)&&(t.length&&(t+="&"),t+=encodeURIComponent(e)+"="+encodeURIComponent(n[e]));return t}function $i(n){let t={},e=n.split("&");for(let r=0,i=e.length;r<i;r++){let s=e[r].split("=");t[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return t}let Xr=!1;try{Xr=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Ki=Xr;function Jr(n){const t=n.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||Ki))return new XMLHttpRequest}catch{}if(!t)try{return new W[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function zi(){}const qi=function(){return new Jr({xdomain:!1}).responseType!=null}();class Vi extends qr{constructor(t){if(super(t),this.polling=!1,typeof location<"u"){const r=location.protocol==="https:";let i=location.port;i||(i=r?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||i!==t.port,this.xs=t.secure!==r}const e=t&&t.forceBase64;this.supportsBinary=qi&&!e}get name(){return"polling"}doOpen(){this.poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused",t()};if(this.polling||!this.writable){let r=0;this.polling&&(r++,this.once("pollComplete",function(){--r||e()})),this.writable||(r++,this.once("drain",function(){--r||e()}))}else e()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const e=r=>{if(this.readyState==="opening"&&r.type==="open"&&this.onOpen(),r.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(r)};Oi(t,this.socket.binaryType).forEach(e),this.readyState!=="closed"&&(this.polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this.poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,Bi(t,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let t=this.query||{};const e=this.opts.secure?"https":"http";let r="";this.opts.timestampRequests!==!1&&(t[this.opts.timestampParam]=Gr()),!this.supportsBinary&&!t.sid&&(t.b64=1),this.opts.port&&(e==="https"&&Number(this.opts.port)!==443||e==="http"&&Number(this.opts.port)!==80)&&(r=":"+this.opts.port);const i=Yr(t),s=this.opts.hostname.indexOf(":")!==-1;return e+"://"+(s?"["+this.opts.hostname+"]":this.opts.hostname)+r+this.opts.path+(i.length?"?"+i:"")}request(t={}){return Object.assign(t,{xd:this.xd,xs:this.xs},this.opts),new G(this.uri(),t)}doWrite(t,e){const r=this.request({method:"POST",data:t});r.on("success",e),r.on("error",(i,s)=>{this.onError("xhr post error",i,s)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(e,r)=>{this.onError("xhr poll error",e,r)}),this.pollXhr=t}}class G extends D{constructor(t,e){super(),tt(this,e),this.opts=e,this.method=e.method||"GET",this.uri=t,this.async=e.async!==!1,this.data=e.data!==void 0?e.data:null,this.create()}create(){const t=zr(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;const e=this.xhr=new Jr(t);try{e.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){e.setDisableHeaderCheck&&e.setDisableHeaderCheck(!0);for(let r in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(r)&&e.setRequestHeader(r,this.opts.extraHeaders[r])}}catch{}if(this.method==="POST")try{e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{e.setRequestHeader("Accept","*/*")}catch{}"withCredentials"in e&&(e.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(e.timeout=this.opts.requestTimeout),e.onreadystatechange=()=>{e.readyState===4&&(e.status===200||e.status===1223?this.onLoad():this.setTimeoutFn(()=>{this.onError(typeof e.status=="number"?e.status:0)},0))},e.send(this.data)}catch(r){this.setTimeoutFn(()=>{this.onError(r)},0);return}typeof document<"u"&&(this.index=G.requestsCount++,G.requests[this.index]=this)}onError(t){this.emitReserved("error",t,this.xhr),this.cleanup(!0)}cleanup(t){if(!(typeof this.xhr>"u"||this.xhr===null)){if(this.xhr.onreadystatechange=zi,t)try{this.xhr.abort()}catch{}typeof document<"u"&&delete G.requests[this.index],this.xhr=null}}onLoad(){const t=this.xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}G.requestsCount=0;G.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",gr);else if(typeof addEventListener=="function"){const n="onpagehide"in W?"pagehide":"unload";addEventListener(n,gr,!1)}}function gr(){for(let n in G.requests)G.requests.hasOwnProperty(n)&&G.requests[n].abort()}const Zr=(()=>typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,e)=>e(t,0))(),Pe=W.WebSocket||W.MozWebSocket,vr=!0,Gi="arraybuffer",Cr=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Yi extends qr{constructor(t){super(t),this.supportsBinary=!t.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const t=this.uri(),e=this.opts.protocols,r=Cr?{}:zr(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=vr&&!Cr?e?new Pe(t,e):new Pe(t):new Pe(t,e,r)}catch(i){return this.emitReserved("error",i)}this.ws.binaryType=this.socket.binaryType||Gi,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const r=t[e],i=e===t.length-1;Wr(r,this.supportsBinary,s=>{const a={};try{vr&&this.ws.send(s)}catch{}i&&Zr(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.close(),this.ws=null)}uri(){let t=this.query||{};const e=this.opts.secure?"wss":"ws";let r="";this.opts.port&&(e==="wss"&&Number(this.opts.port)!==443||e==="ws"&&Number(this.opts.port)!==80)&&(r=":"+this.opts.port),this.opts.timestampRequests&&(t[this.opts.timestampParam]=Gr()),this.supportsBinary||(t.b64=1);const i=Yr(t),s=this.opts.hostname.indexOf(":")!==-1;return e+"://"+(s?"["+this.opts.hostname+"]":this.opts.hostname)+r+this.opts.path+(i.length?"?"+i:"")}check(){return!!Pe}}const Xi={websocket:Yi,polling:Vi},Ji=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Zi=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function St(n){const t=n,e=n.indexOf("["),r=n.indexOf("]");e!=-1&&r!=-1&&(n=n.substring(0,e)+n.substring(e,r).replace(/:/g,";")+n.substring(r,n.length));let i=Ji.exec(n||""),s={},a=14;for(;a--;)s[Zi[a]]=i[a]||"";return e!=-1&&r!=-1&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=Qi(s,s.path),s.queryKey=en(s,s.query),s}function Qi(n,t){const e=/\/{2,9}/g,r=t.replace(e,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&r.splice(0,1),t.slice(-1)=="/"&&r.splice(r.length-1,1),r}function en(n,t){const e={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(r,i,s){i&&(e[i]=s)}),e}let ie=class extends D{constructor(t,e={}){super(),this.writeBuffer=[],t&&typeof t=="object"&&(e=t,t=null),t?(t=St(t),e.hostname=t.host,e.secure=t.protocol==="https"||t.protocol==="wss",e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=St(e.host).host),tt(this,e),this.secure=e.secure!=null?e.secure:typeof location<"u"&&location.protocol==="https:",e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=e.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=e.transports||["polling","websocket"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},e),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=$i(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,typeof addEventListener=="function"&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(t){const e=Object.assign({},this.opts.query);e.EIO=Kr,e.transport=t,this.id&&(e.sid=this.id);const r=Object.assign({},this.opts.transportOptions[t],this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new Xi[t](r)}open(){let t;if(this.opts.rememberUpgrade&&ie.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1)t="websocket";else if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else t=this.transports[0];this.readyState="opening";try{t=this.createTransport(t)}catch{this.transports.shift(),this.open();return}t.open(),this.setTransport(t)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",e=>this.onClose("transport close",e))}probe(t){let e=this.createTransport(t),r=!1;ie.priorWebsocketSuccess=!1;const i=()=>{r||(e.send([{type:"ping",data:"probe"}]),e.once("packet",h=>{if(!r)if(h.type==="pong"&&h.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;ie.priorWebsocketSuccess=e.name==="websocket",this.transport.pause(()=>{r||this.readyState!=="closed"&&(u(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())})}else{const f=new Error("probe error");f.transport=e.name,this.emitReserved("upgradeError",f)}}))};function s(){r||(r=!0,u(),e.close(),e=null)}const a=h=>{const f=new Error("probe error: "+h);f.transport=e.name,s(),this.emitReserved("upgradeError",f)};function c(){a("transport closed")}function o(){a("socket closed")}function l(h){e&&h.name!==e.name&&s()}const u=()=>{e.removeListener("open",i),e.removeListener("error",a),e.removeListener("close",c),this.off("close",o),this.off("upgrading",l)};e.once("open",i),e.once("error",a),e.once("close",c),this.once("close",o),this.once("upgrading",l),e.open()}onOpen(){if(this.readyState="open",ie.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush(),this.readyState==="open"&&this.opts.upgrade){let t=0;const e=this.upgrades.length;for(;t<e;t++)this.probe(this.upgrades[t])}}onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this.getWritablePackets();this.transport.send(t),this.prevBufferLen=t.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let r=0;r<this.writeBuffer.length;r++){const i=this.writeBuffer[r].data;if(i&&(e+=Ni(i)),r>0&&e>this.maxPayload)return this.writeBuffer.slice(0,r);e+=2}return this.writeBuffer}write(t,e,r){return this.sendPacket("message",t,e,r),this}send(t,e,r){return this.sendPacket("message",t,e,r),this}sendPacket(t,e,r,i){if(typeof e=="function"&&(i=e,e=void 0),typeof r=="function"&&(i=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;const s={type:t,data:e,options:r};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),i&&this.once("flush",i),this.flush()}close(){const t=()=>{this.onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},r=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():t()}):this.upgrading?r():t()),this}onError(t){ie.priorWebsocketSuccess=!1,this.emitReserved("error",t),this.onClose("transport error",t)}onClose(t,e){(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),typeof removeEventListener=="function"&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(t){const e=[];let r=0;const i=t.length;for(;r<i;r++)~this.transports.indexOf(t[r])&&e.push(t[r]);return e}};ie.protocol=Kr;function tn(n,t="",e){let r=n;e=e||typeof location<"u"&&location,n==null&&(n=e.protocol+"//"+e.host),typeof n=="string"&&(n.charAt(0)==="/"&&(n.charAt(1)==="/"?n=e.protocol+n:n=e.host+n),/^(https?|wss?):\/\//.test(n)||(typeof e<"u"?n=e.protocol+"//"+n:n="https://"+n),r=St(n)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const s=r.host.indexOf(":")!==-1?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+s+":"+r.port+t,r.href=r.protocol+"://"+s+(e&&e.port===r.port?"":":"+r.port),r}const rn=typeof ArrayBuffer=="function",nn=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n.buffer instanceof ArrayBuffer,Qr=Object.prototype.toString,sn=typeof Blob=="function"||typeof Blob<"u"&&Qr.call(Blob)==="[object BlobConstructor]",on=typeof File=="function"||typeof File<"u"&&Qr.call(File)==="[object FileConstructor]";function Rt(n){return rn&&(n instanceof ArrayBuffer||nn(n))||sn&&n instanceof Blob||on&&n instanceof File}function Ge(n,t){if(!n||typeof n!="object")return!1;if(Array.isArray(n)){for(let e=0,r=n.length;e<r;e++)if(Ge(n[e]))return!0;return!1}if(Rt(n))return!0;if(n.toJSON&&typeof n.toJSON=="function"&&arguments.length===1)return Ge(n.toJSON(),!0);for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e)&&Ge(n[e]))return!0;return!1}function an(n){const t=[],e=n.data,r=n;return r.data=Et(e,t),r.attachments=t.length,{packet:r,buffers:t}}function Et(n,t){if(!n)return n;if(Rt(n)){const e={_placeholder:!0,num:t.length};return t.push(n),e}else if(Array.isArray(n)){const e=new Array(n.length);for(let r=0;r<n.length;r++)e[r]=Et(n[r],t);return e}else if(typeof n=="object"&&!(n instanceof Date)){const e={};for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=Et(n[r],t));return e}return n}function ln(n,t){return n.data=At(n.data,t),delete n.attachments,n}function At(n,t){if(!n)return n;if(n&&n._placeholder===!0){if(typeof n.num=="number"&&n.num>=0&&n.num<t.length)return t[n.num];throw new Error("illegal attachments")}else if(Array.isArray(n))for(let e=0;e<n.length;e++)n[e]=At(n[e],t);else if(typeof n=="object")for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&(n[e]=At(n[e],t));return n}const hn=5;var w;(function(n){n[n.CONNECT=0]="CONNECT",n[n.DISCONNECT=1]="DISCONNECT",n[n.EVENT=2]="EVENT",n[n.ACK=3]="ACK",n[n.CONNECT_ERROR=4]="CONNECT_ERROR",n[n.BINARY_EVENT=5]="BINARY_EVENT",n[n.BINARY_ACK=6]="BINARY_ACK"})(w||(w={}));class cn{constructor(t){this.replacer=t}encode(t){return(t.type===w.EVENT||t.type===w.ACK)&&Ge(t)?this.encodeAsBinary({type:t.type===w.EVENT?w.BINARY_EVENT:w.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let e=""+t.type;return(t.type===w.BINARY_EVENT||t.type===w.BINARY_ACK)&&(e+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(e+=t.nsp+","),t.id!=null&&(e+=t.id),t.data!=null&&(e+=JSON.stringify(t.data,this.replacer)),e}encodeAsBinary(t){const e=an(t),r=this.encodeAsString(e.packet),i=e.buffers;return i.unshift(r),i}}class Tt extends D{constructor(t){super(),this.reviver=t}add(t){let e;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(t);const r=e.type===w.BINARY_EVENT;r||e.type===w.BINARY_ACK?(e.type=r?w.EVENT:w.ACK,this.reconstructor=new un(e),e.attachments===0&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else if(Rt(t)||t.base64)if(this.reconstructor)e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let e=0;const r={type:Number(t.charAt(0))};if(w[r.type]===void 0)throw new Error("unknown packet type "+r.type);if(r.type===w.BINARY_EVENT||r.type===w.BINARY_ACK){const s=e+1;for(;t.charAt(++e)!=="-"&&e!=t.length;);const a=t.substring(s,e);if(a!=Number(a)||t.charAt(e)!=="-")throw new Error("Illegal attachments");r.attachments=Number(a)}if(t.charAt(e+1)==="/"){const s=e+1;for(;++e&&!(t.charAt(e)===","||e===t.length););r.nsp=t.substring(s,e)}else r.nsp="/";const i=t.charAt(e+1);if(i!==""&&Number(i)==i){const s=e+1;for(;++e;){const a=t.charAt(e);if(a==null||Number(a)!=a){--e;break}if(e===t.length)break}r.id=Number(t.substring(s,e+1))}if(t.charAt(++e)){const s=this.tryParse(t.substr(e));if(Tt.isPayloadValid(r.type,s))r.data=s;else throw new Error("invalid payload")}return r}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,e){switch(t){case w.CONNECT:return typeof e=="object";case w.DISCONNECT:return e===void 0;case w.CONNECT_ERROR:return typeof e=="string"||typeof e=="object";case w.EVENT:case w.BINARY_EVENT:return Array.isArray(e)&&e.length>0;case w.ACK:case w.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class un{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const e=ln(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const fn=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Tt,Encoder:cn,get PacketType(){return w},protocol:hn},Symbol.toStringTag,{value:"Module"}));function K(n,t,e){return n.on(t,e),function(){n.off(t,e)}}const _n=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class ei extends D{constructor(t,e,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[K(t,"open",this.onopen.bind(this)),K(t,"packet",this.onpacket.bind(this)),K(t,"error",this.onerror.bind(this)),K(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){if(_n.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(e.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(e),this;const r={type:w.EVENT,data:e};if(r.options={},r.options.compress=this.flags.compress!==!1,typeof e[e.length-1]=="function"){const a=this.ids++,c=e.pop();this._registerAckCallback(a,c),r.id=a}const i=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!i||!this.connected)||(this.connected?(this.notifyOutgoingListeners(r),this.packet(r)):this.sendBuffer.push(r)),this.flags={},this}_registerAckCallback(t,e){var r;const i=(r=this.flags.timeout)!==null&&r!==void 0?r:this._opts.ackTimeout;if(i===void 0){this.acks[t]=e;return}const s=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let a=0;a<this.sendBuffer.length;a++)this.sendBuffer[a].id===t&&this.sendBuffer.splice(a,1);e.call(this,new Error("operation has timed out"))},i);this.acks[t]=(...a)=>{this.io.clearTimeoutFn(s),e.apply(this,[null,...a])}}emitWithAck(t,...e){const r=this.flags.timeout!==void 0||this._opts.ackTimeout!==void 0;return new Promise((i,s)=>{e.push((a,c)=>r?a?s(a):i(c):i(a)),this.emit(t,...e)})}_addToQueue(t){let e;typeof t[t.length-1]=="function"&&(e=t.pop());const r={id:this.ids++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((i,...s)=>r!==this._queue[0]?void 0:(i!==null?r.tryCount>this._opts.retries&&(this._queue.shift(),e&&e(i)):(this._queue.shift(),e&&e(null,...s)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(){if(this._queue.length===0)return;const t=this._queue[0];if(t.pending)return;t.pending=!0,t.tryCount++;const e=this.ids;this.ids=t.id,this.flags=t.flags,this.emit.apply(this,t.args),this.ids=e}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:w.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,e)}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case w.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case w.EVENT:case w.BINARY_EVENT:this.onevent(t);break;case w.ACK:case w.BINARY_ACK:this.onack(t);break;case w.DISCONNECT:this.ondisconnect();break;case w.CONNECT_ERROR:this.destroy();const r=new Error(t.data.message);r.data=t.data.data,this.emitReserved("connect_error",r);break}}onevent(t){const e=t.data||[];t.id!=null&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const r of e)r.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const e=this;let r=!1;return function(...i){r||(r=!0,e.packet({type:w.ACK,id:t,data:i}))}}onack(t){const e=this.acks[t.id];typeof e=="function"&&(e.apply(this,t.data),delete this.acks[t.id])}onconnect(t,e){this.id=t,this.recovered=e&&this._pid===e,this._pid=e,this.connected=!0,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:w.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let r=0;r<e.length;r++)if(t===e[r])return e.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const e=this._anyOutgoingListeners;for(let r=0;r<e.length;r++)if(t===e[r])return e.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const e=this._anyOutgoingListeners.slice();for(const r of e)r.apply(this,t.data)}}}function ye(n){n=n||{},this.ms=n.min||100,this.max=n.max||1e4,this.factor=n.factor||2,this.jitter=n.jitter>0&&n.jitter<=1?n.jitter:0,this.attempts=0}ye.prototype.duration=function(){var n=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),e=Math.floor(t*this.jitter*n);n=Math.floor(t*10)&1?n+e:n-e}return Math.min(n,this.max)|0};ye.prototype.reset=function(){this.attempts=0};ye.prototype.setMin=function(n){this.ms=n};ye.prototype.setMax=function(n){this.max=n};ye.prototype.setJitter=function(n){this.jitter=n};class Lt extends D{constructor(t,e){var r;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(e=t,t=void 0),e=e||{},e.path=e.path||"/socket.io",this.opts=e,tt(this,e),this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor((r=e.randomizationFactor)!==null&&r!==void 0?r:.5),this.backoff=new ye({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(e.timeout==null?2e4:e.timeout),this._readyState="closed",this.uri=t;const i=e.parser||fn;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=e.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(e=this.backoff)===null||e===void 0||e.setMin(t),this)}randomizationFactor(t){var e;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(e=this.backoff)===null||e===void 0||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(e=this.backoff)===null||e===void 0||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new ie(this.uri,this.opts);const e=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;const i=K(e,"open",function(){r.onopen(),t&&t()}),s=K(e,"error",a=>{r.cleanup(),r._readyState="closed",this.emitReserved("error",a),t?t(a):r.maybeReconnectOnOpen()});if(this._timeout!==!1){const a=this._timeout;a===0&&i();const c=this.setTimeoutFn(()=>{i(),e.close(),e.emit("error",new Error("timeout"))},a);this.opts.autoUnref&&c.unref(),this.subs.push(function(){clearTimeout(c)})}return this.subs.push(i),this.subs.push(s),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(K(t,"ping",this.onping.bind(this)),K(t,"data",this.ondata.bind(this)),K(t,"error",this.onerror.bind(this)),K(t,"close",this.onclose.bind(this)),K(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(e){this.onclose("parse error",e)}}ondecoded(t){Zr(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,e){let r=this.nsps[t];return r||(r=new ei(this,t,e),this.nsps[t]=r),this._autoConnect&&r.connect(),r}_destroy(t){const e=Object.keys(this.nsps);for(const r of e)if(this.nsps[r].active)return;this._close()}_packet(t){const e=this.encoder.encode(t);for(let r=0;r<e.length;r++)this.engine.write(e[r],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(t,e){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();this._reconnecting=!0;const r=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(i=>{i?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",i)):t.onreconnect()}))},e);this.opts.autoUnref&&r.unref(),this.subs.push(function(){clearTimeout(r)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const we={};function Ye(n,t){typeof n=="object"&&(t=n,n=void 0),t=t||{};const e=tn(n,t.path||"/socket.io"),r=e.source,i=e.id,s=e.path,a=we[i]&&s in we[i].nsps,c=t.forceNew||t["force new connection"]||t.multiplex===!1||a;let o;return c?o=new Lt(r,t):(we[i]||(we[i]=new Lt(r,t)),o=we[i]),e.query&&!t.query&&(t.query=e.queryKey),o.socket(e.path,t)}Object.assign(Ye,{Manager:Lt,Socket:ei,io:Ye,connect:Ye});var C=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ti={},kt={},Dt={},Mt={},Bt={},z={};Object.defineProperty(z,"__esModule",{value:!0});var dn=function(){function n(){this._listeners=[]}return Object.defineProperty(n.prototype,"event",{get:function(){var t=this;return this._event||(this._event=function(e){t._listeners.push(e);var r={dispose:function(){for(var i=0;i<t._listeners.length;i++)if(t._listeners[i]===e){t._listeners.splice(i,1);return}}};return r}),this._event},enumerable:!0,configurable:!0}),n.prototype.fire=function(t){for(var e=[],r=0;r<this._listeners.length;r++)e.push(this._listeners[r]);for(var r=0;r<e.length;r++)e[r].call(void 0,t)},n}();z.EventEmitter2=dn;Object.defineProperty(Bt,"__esModule",{value:!0});var lt=z,pn=function(){function n(t){this._maxLength=t,this.onDeleteEmitter=new lt.EventEmitter2,this.onInsertEmitter=new lt.EventEmitter2,this.onTrimEmitter=new lt.EventEmitter2,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}return Object.defineProperty(n.prototype,"onDelete",{get:function(){return this.onDeleteEmitter.event},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"onInsert",{get:function(){return this.onInsertEmitter.event},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"onTrim",{get:function(){return this.onTrimEmitter.event},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"maxLength",{get:function(){return this._maxLength},set:function(t){if(this._maxLength!==t){for(var e=new Array(t),r=0;r<Math.min(t,this.length);r++)e[r]=this._array[this._getCyclicIndex(r)];this._array=e,this._maxLength=t,this._startIndex=0}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"length",{get:function(){return this._length},set:function(t){if(t>this._length)for(var e=this._length;e<t;e++)this._array[e]=void 0;this._length=t},enumerable:!0,configurable:!0}),n.prototype.get=function(t){return this._array[this._getCyclicIndex(t)]},n.prototype.set=function(t,e){this._array[this._getCyclicIndex(t)]=e},n.prototype.push=function(t){this._array[this._getCyclicIndex(this._length)]=t,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++},n.prototype.recycle=function(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]},Object.defineProperty(n.prototype,"isFull",{get:function(){return this._length===this._maxLength},enumerable:!0,configurable:!0}),n.prototype.pop=function(){return this._array[this._getCyclicIndex(this._length---1)]},n.prototype.splice=function(t,e){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(e){for(var s=t;s<this._length-e;s++)this._array[this._getCyclicIndex(s)]=this._array[this._getCyclicIndex(s+e)];this._length-=e}for(var s=this._length-1;s>=t;s--)this._array[this._getCyclicIndex(s+r.length)]=this._array[this._getCyclicIndex(s)];for(var s=0;s<r.length;s++)this._array[this._getCyclicIndex(t+s)]=r[s];if(this._length+r.length>this._maxLength){var a=this._length+r.length-this._maxLength;this._startIndex+=a,this._length=this._maxLength,this.onTrimEmitter.fire(a)}else this._length+=r.length},n.prototype.trimStart=function(t){t>this._length&&(t=this._length),this._startIndex+=t,this._length-=t,this.onTrimEmitter.fire(t)},n.prototype.shiftElements=function(t,e,r){if(!(e<=0)){if(t<0||t>=this._length)throw new Error("start argument out of range");if(t+r<0)throw new Error("Cannot shift elements in list beyond index 0");if(r>0){for(var i=e-1;i>=0;i--)this.set(t+i+r,this.get(t+i));var s=t+e+r-this._length;if(s>0)for(this._length+=s;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(var i=0;i<e;i++)this.set(t+i+r,this.get(t+i))}},n.prototype._getCyclicIndex=function(t){return(this._startIndex+t)%this._maxLength},n}();Bt.CircularList=pn;var q={},Q={};Object.defineProperty(Q,"__esModule",{value:!0});function mn(n){return n>65535?(n-=65536,String.fromCharCode((n>>10)+55296)+String.fromCharCode(n%1024+56320)):String.fromCharCode(n)}Q.stringFromCodePoint=mn;function yn(n,t,e){t===void 0&&(t=0),e===void 0&&(e=n.length);for(var r="",i=t;i<e;++i){var s=n[i];s>65535?(s-=65536,r+=String.fromCharCode((s>>10)+55296)+String.fromCharCode(s%1024+56320)):r+=String.fromCharCode(s)}return r}Q.utf32ToString=yn;var gn=function(){function n(){this._interim=0}return n.prototype.clear=function(){this._interim=0},n.prototype.decode=function(t,e){var r=t.length;if(!r)return 0;var i=0,s=0;if(this._interim){var a=t.charCodeAt(s++);56320<=a&&a<=57343?e[i++]=(this._interim-55296)*1024+a-56320+65536:(e[i++]=this._interim,e[i++]=a),this._interim=0}for(var c=s;c<r;++c){var o=t.charCodeAt(c);if(55296<=o&&o<=56319){if(++c>=r)return this._interim=o,i;var a=t.charCodeAt(c);56320<=a&&a<=57343?e[i++]=(o-55296)*1024+a-56320+65536:(e[i++]=o,e[i++]=a);continue}e[i++]=o}return i},n}();Q.StringToUtf32=gn;var vn=function(){function n(){this.interim=new Uint8Array(3)}return n.prototype.clear=function(){this.interim.fill(0)},n.prototype.decode=function(t,e){var r=t.length;if(!r)return 0;var i=0,s,a,c,o,l=0,u=0;if(this.interim[0]){var h=!1,f=this.interim[0];f&=(f&224)===192?31:(f&240)===224?15:7;for(var _=0,d=void 0;(d=this.interim[++_]&63)&&_<4;)f<<=6,f|=d;for(var p=(this.interim[0]&224)===192?2:(this.interim[0]&240)===224?3:4,m=p-_;u<m;){if(u>=r)return 0;if(d=t[u++],(d&192)!==128){u--,h=!0;break}else this.interim[_++]=d,f<<=6,f|=d&63}h||(p===2?f<128?u--:e[i++]=f:p===3?f<2048||f>=55296&&f<=57343||(e[i++]=f):l<65536||l>1114111||(e[i++]=f)),this.interim.fill(0)}for(var x=r-4,g=u;g<r;){for(;g<x&&!((s=t[g])&128)&&!((a=t[g+1])&128)&&!((c=t[g+2])&128)&&!((o=t[g+3])&128);)e[i++]=s,e[i++]=a,e[i++]=c,e[i++]=o,g+=4;if(s=t[g++],s<128)e[i++]=s;else if((s&224)===192){if(g>=r)return this.interim[0]=s,i;if(a=t[g++],(a&192)!==128){g--;continue}if(l=(s&31)<<6|a&63,l<128){g--;continue}e[i++]=l}else if((s&240)===224){if(g>=r)return this.interim[0]=s,i;if(a=t[g++],(a&192)!==128){g--;continue}if(g>=r)return this.interim[0]=s,this.interim[1]=a,i;if(c=t[g++],(c&192)!==128){g--;continue}if(l=(s&15)<<12|(a&63)<<6|c&63,l<2048||l>=55296&&l<=57343)continue;e[i++]=l}else if((s&248)===240){if(g>=r)return this.interim[0]=s,i;if(a=t[g++],(a&192)!==128){g--;continue}if(g>=r)return this.interim[0]=s,this.interim[1]=a,i;if(c=t[g++],(c&192)!==128){g--;continue}if(g>=r)return this.interim[0]=s,this.interim[1]=a,this.interim[2]=c,i;if(o=t[g++],(o&192)!==128){g--;continue}if(l=(s&7)<<18|(a&63)<<12|(c&63)<<6|o&63,l<65536||l>1114111)continue;e[i++]=l}}return i},n}();Q.Utf8ToUtf32=vn;var ge={};Object.defineProperty(ge,"__esModule",{value:!0});ge.DEFAULT_COLOR=256;(function(n){var t=C&&C.__extends||function(){var o=function(l,u){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(h,f){h.__proto__=f}||function(h,f){for(var _ in f)f.hasOwnProperty(_)&&(h[_]=f[_])},o(l,u)};return function(l,u){o(l,u);function h(){this.constructor=l}l.prototype=u===null?Object.create(u):(h.prototype=u.prototype,new h)}}();Object.defineProperty(n,"__esModule",{value:!0});var e=Q,r=ge;n.DEFAULT_ATTR=0<<18|r.DEFAULT_COLOR<<9|256<<0,n.CHAR_DATA_ATTR_INDEX=0,n.CHAR_DATA_CHAR_INDEX=1,n.CHAR_DATA_WIDTH_INDEX=2,n.CHAR_DATA_CODE_INDEX=3,n.NULL_CELL_CHAR="",n.NULL_CELL_WIDTH=1,n.NULL_CELL_CODE=0,n.WHITESPACE_CELL_CHAR=" ",n.WHITESPACE_CELL_WIDTH=1,n.WHITESPACE_CELL_CODE=32;var i=3,s=function(){function o(){this.fg=0,this.bg=0}return o.toColorRGB=function(l){return[l>>>16&255,l>>>8&255,l&255]},o.fromColorRGB=function(l){return(l[0]&255)<<16|(l[1]&255)<<8|l[2]&255},o.prototype.clone=function(){var l=new o;return l.fg=this.fg,l.bg=this.bg,l},o.prototype.isInverse=function(){return this.fg&67108864},o.prototype.isBold=function(){return this.fg&134217728},o.prototype.isUnderline=function(){return this.fg&268435456},o.prototype.isBlink=function(){return this.fg&536870912},o.prototype.isInvisible=function(){return this.fg&1073741824},o.prototype.isItalic=function(){return this.bg&67108864},o.prototype.isDim=function(){return this.bg&134217728},o.prototype.getFgColorMode=function(){return this.fg&50331648},o.prototype.getBgColorMode=function(){return this.bg&50331648},o.prototype.isFgRGB=function(){return(this.fg&50331648)===50331648},o.prototype.isBgRGB=function(){return(this.bg&50331648)===50331648},o.prototype.isFgPalette=function(){return(this.fg&50331648)===16777216||(this.fg&50331648)===33554432},o.prototype.isBgPalette=function(){return(this.bg&50331648)===16777216||(this.bg&50331648)===33554432},o.prototype.isFgDefault=function(){return(this.fg&50331648)===0},o.prototype.isBgDefault=function(){return(this.bg&50331648)===0},o.prototype.getFgColor=function(){switch(this.fg&50331648){case 16777216:case 33554432:return this.fg&255;case 50331648:return this.fg&16777215;default:return-1}},o.prototype.getBgColor=function(){switch(this.bg&50331648){case 16777216:case 33554432:return this.bg&255;case 50331648:return this.bg&16777215;default:return-1}},o}();n.AttributeData=s,n.DEFAULT_ATTR_DATA=Object.freeze(new s);var a=function(o){t(l,o);function l(){var u=o!==null&&o.apply(this,arguments)||this;return u.content=0,u.fg=0,u.bg=0,u.combinedData="",u}return l.fromCharData=function(u){var h=new l;return h.setFromCharData(u),h},l.prototype.isCombined=function(){return this.content&2097152},l.prototype.getWidth=function(){return this.content>>22},l.prototype.getChars=function(){return this.content&2097152?this.combinedData:this.content&2097151?e.stringFromCodePoint(this.content&2097151):""},l.prototype.getCode=function(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):this.content&2097151},l.prototype.setFromCharData=function(u){this.fg=u[n.CHAR_DATA_ATTR_INDEX],this.bg=0;var h=!1;if(u[n.CHAR_DATA_CHAR_INDEX].length>2)h=!0;else if(u[n.CHAR_DATA_CHAR_INDEX].length===2){var f=u[n.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=f&&f<=56319){var _=u[n.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=_&&_<=57343?this.content=(f-55296)*1024+_-56320+65536|u[n.CHAR_DATA_WIDTH_INDEX]<<22:h=!0}else h=!0}else this.content=u[n.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|u[n.CHAR_DATA_WIDTH_INDEX]<<22;h&&(this.combinedData=u[n.CHAR_DATA_CHAR_INDEX],this.content=2097152|u[n.CHAR_DATA_WIDTH_INDEX]<<22)},l.prototype.getAsCharData=function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]},l}(s);n.CellData=a;var c=function(){function o(l,u,h){h===void 0&&(h=!1),this.isWrapped=h,this._combined={},this._data=new Uint32Array(l*i);for(var f=u||a.fromCharData([0,n.NULL_CELL_CHAR,n.NULL_CELL_WIDTH,n.NULL_CELL_CODE]),_=0;_<l;++_)this.setCell(_,f);this.length=l}return o.prototype.get=function(l){var u=this._data[l*i+0],h=u&2097151;return[this._data[l*i+1],u&2097152?this._combined[l]:h?e.stringFromCodePoint(h):"",u>>22,u&2097152?this._combined[l].charCodeAt(this._combined[l].length-1):h]},o.prototype.set=function(l,u){this._data[l*i+1]=u[n.CHAR_DATA_ATTR_INDEX],u[n.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[l]=u[1],this._data[l*i+0]=l|2097152|u[n.CHAR_DATA_WIDTH_INDEX]<<22):this._data[l*i+0]=u[n.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|u[n.CHAR_DATA_WIDTH_INDEX]<<22},o.prototype.getWidth=function(l){return this._data[l*i+0]>>22},o.prototype.hasWidth=function(l){return this._data[l*i+0]&12582912},o.prototype.getFg=function(l){return this._data[l*i+1]},o.prototype.getBg=function(l){return this._data[l*i+2]},o.prototype.hasContent=function(l){return this._data[l*i+0]&4194303},o.prototype.getCodePoint=function(l){var u=this._data[l*i+0];return u&2097152?this._combined[l].charCodeAt(this._combined[l].length-1):u&2097151},o.prototype.isCombined=function(l){return this._data[l*i+0]&2097152},o.prototype.getString=function(l){var u=this._data[l*i+0];return u&2097152?this._combined[l]:u&2097151?e.stringFromCodePoint(u&2097151):""},o.prototype.loadCell=function(l,u){var h=l*i;return u.content=this._data[h+0],u.fg=this._data[h+1],u.bg=this._data[h+2],u.content&2097152&&(u.combinedData=this._combined[l]),u},o.prototype.setCell=function(l,u){u.content&2097152&&(this._combined[l]=u.combinedData),this._data[l*i+0]=u.content,this._data[l*i+1]=u.fg,this._data[l*i+2]=u.bg},o.prototype.setCellFromCodePoint=function(l,u,h,f,_){this._data[l*i+0]=u|h<<22,this._data[l*i+1]=f,this._data[l*i+2]=_},o.prototype.addCodepointToCell=function(l,u){var h=this._data[l*i+0];h&2097152?this._combined[l]+=e.stringFromCodePoint(u):(h&2097151?(this._combined[l]=e.stringFromCodePoint(h&2097151)+e.stringFromCodePoint(u),h&=-2097152,h|=2097152):h=u|1<<22,this._data[l*i+0]=h)},o.prototype.insertCells=function(l,u,h){if(l%=this.length,u<this.length-l){for(var f=new a,_=this.length-l-u-1;_>=0;--_)this.setCell(l+u+_,this.loadCell(l+_,f));for(var _=0;_<u;++_)this.setCell(l+_,h)}else for(var _=l;_<this.length;++_)this.setCell(_,h)},o.prototype.deleteCells=function(l,u,h){if(l%=this.length,u<this.length-l){for(var f=new a,_=0;_<this.length-l-u;++_)this.setCell(l+_,this.loadCell(l+u+_,f));for(var _=this.length-u;_<this.length;++_)this.setCell(_,h)}else for(var _=l;_<this.length;++_)this.setCell(_,h)},o.prototype.replaceCells=function(l,u,h){for(;l<u&&l<this.length;)this.setCell(l++,h)},o.prototype.resize=function(l,u){if(l!==this.length){if(l>this.length){var h=new Uint32Array(l*i);this.length&&(l*i<this._data.length?h.set(this._data.subarray(0,l*i)):h.set(this._data)),this._data=h;for(var f=this.length;f<l;++f)this.setCell(f,u)}else if(l){var h=new Uint32Array(l*i);h.set(this._data.subarray(0,l*i)),this._data=h;for(var _=Object.keys(this._combined),f=0;f<_.length;f++){var d=parseInt(_[f],10);d>=l&&delete this._combined[d]}}else this._data=new Uint32Array(0),this._combined={};this.length=l}},o.prototype.fill=function(l){this._combined={};for(var u=0;u<this.length;++u)this.setCell(u,l)},o.prototype.copyFrom=function(l){this.length!==l.length?this._data=new Uint32Array(l._data):this._data.set(l._data),this.length=l.length,this._combined={};for(var u in l._combined)this._combined[u]=l._combined[u];this.isWrapped=l.isWrapped},o.prototype.clone=function(){var l=new o(0);l._data=new Uint32Array(this._data),l.length=this.length;for(var u in this._combined)l._combined[u]=this._combined[u];return l.isWrapped=this.isWrapped,l},o.prototype.getTrimmedLength=function(){for(var l=this.length-1;l>=0;--l)if(this._data[l*i+0]&4194303)return l+(this._data[l*i+0]>>22);return 0},o.prototype.copyCellsFrom=function(l,u,h,f,_){var d=l._data;if(_)for(var p=f-1;p>=0;p--)for(var m=0;m<i;m++)this._data[(h+p)*i+m]=d[(u+p)*i+m];else for(var p=0;p<f;p++)for(var m=0;m<i;m++)this._data[(h+p)*i+m]=d[(u+p)*i+m];for(var x=Object.keys(l._combined),m=0;m<x.length;m++){var g=parseInt(x[m],10);g>=u&&(this._combined[g-u+h]=l._combined[g])}},o.prototype.translateToString=function(l,u,h){l===void 0&&(l=!1),u===void 0&&(u=0),h===void 0&&(h=this.length),l&&(h=Math.min(h,this.getTrimmedLength()));for(var f="";u<h;){var _=this._data[u*i+0],d=_&2097151;f+=_&2097152?this._combined[u]:d?e.stringFromCodePoint(d):n.WHITESPACE_CELL_CHAR,u+=_>>22||1}return f},o}();n.BufferLine=c})(q);var ne={};Object.defineProperty(ne,"__esModule",{value:!0});function Cn(n,t,e,r,i){for(var s=[],a=0;a<n.length-1;a++){var c=a,o=n.get(++c);if(o.isWrapped){for(var l=[n.get(a)];c<n.length&&o.isWrapped;)l.push(o),o=n.get(++c);if(r>=a&&r<c){a+=l.length-1;continue}for(var u=0,h=Ae(l,u,t),f=1,_=0;f<l.length;){var d=Ae(l,f,t),p=d-_,m=e-h,x=Math.min(p,m);l[u].copyCellsFrom(l[f],_,h,x,!1),h+=x,h===e&&(u++,h=0),_+=x,_===d&&(f++,_=0),h===0&&u!==0&&l[u-1].getWidth(e-1)===2&&(l[u].copyCellsFrom(l[u-1],e-1,h++,1,!1),l[u-1].setCell(e-1,i))}l[u].replaceCells(h,e,i);for(var g=0,v=l.length-1;v>0&&(v>u||l[v].getTrimmedLength()===0);v--)g++;g>0&&(s.push(a+l.length-g),s.push(g)),a+=l.length-1}}return s}ne.reflowLargerGetLinesToRemove=Cn;function bn(n,t){for(var e=[],r=0,i=t[r],s=0,a=0;a<n.length;a++)if(i===a){var c=t[++r];n.onDeleteEmitter.fire({index:a-s,amount:c}),a+=c-1,s+=c,i=t[++r]}else e.push(a);return{layout:e,countRemoved:s}}ne.reflowLargerCreateNewLayout=bn;function wn(n,t){for(var e=[],r=0;r<t.length;r++)e.push(n.get(t[r]));for(var r=0;r<e.length;r++)n.set(r,e[r]);n.length=t.length}ne.reflowLargerApplyNewLayout=wn;function xn(n,t,e){for(var r=[],i=n.map(function(h,f){return Ae(n,f,t)}).reduce(function(h,f){return h+f}),s=0,a=0,c=0;c<i;){if(i-c<e){r.push(i-c);break}s+=e;var o=Ae(n,a,t);s>o&&(s-=o,a++);var l=n[a].getWidth(s-1)===2;l&&s--;var u=l?e-1:e;r.push(u),c+=u}return r}ne.reflowSmallerGetNewLineLengths=xn;function Ae(n,t,e){if(t===n.length-1)return n[t].getTrimmedLength();var r=!n[t].hasContent(e-1)&&n[t].getWidth(e-1)===1,i=n[t+1].getWidth(0)===2;return r&&i?e-1:e}ne.getWrappedLineTrimmedLength=Ae;var Ot={},F={};Object.defineProperty(F,"__esModule",{value:!0});var Sn=function(){function n(){this._disposables=[],this._isDisposed=!1}return n.prototype.dispose=function(){this._isDisposed=!0,this._disposables.forEach(function(t){return t.dispose()}),this._disposables.length=0},n.prototype.register=function(t){this._disposables.push(t)},n.prototype.unregister=function(t){var e=this._disposables.indexOf(t);e!==-1&&this._disposables.splice(e,1)},n}();F.Disposable=Sn;var En=C&&C.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(t,e)};return function(t,e){n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Ot,"__esModule",{value:!0});var An=z,Ln=F,Rn=function(n){En(t,n);function t(e){var r=n.call(this)||this;return r.line=e,r._id=t._nextId++,r.isDisposed=!1,r._onDispose=new An.EventEmitter2,r}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onDispose",{get:function(){return this._onDispose.event},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,this._onDispose.fire())},t._nextId=1,t}(Ln.Disposable);Ot.Marker=Rn;(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=Bt,e=q,r=ne,i=Ot;n.MAX_BUFFER_SIZE=4294967295;var s=function(){function c(o,l){this._terminal=o,this._hasScrollback=l,this.savedCurAttrData=e.DEFAULT_ATTR_DATA.clone(),this.markers=[],this._nullCell=e.CellData.fromCharData([0,e.NULL_CELL_CHAR,e.NULL_CELL_WIDTH,e.NULL_CELL_CODE]),this._whitespaceCell=e.CellData.fromCharData([0,e.WHITESPACE_CELL_CHAR,e.WHITESPACE_CELL_WIDTH,e.WHITESPACE_CELL_CODE]),this._cols=this._terminal.cols,this._rows=this._terminal.rows,this.clear()}return c.prototype.getNullCell=function(o){return o?(this._nullCell.fg=o.fg,this._nullCell.bg=o.bg):(this._nullCell.fg=0,this._nullCell.bg=0),this._nullCell},c.prototype.getWhitespaceCell=function(o){return o?(this._whitespaceCell.fg=o.fg,this._whitespaceCell.bg=o.bg):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0),this._whitespaceCell},c.prototype.getBlankLine=function(o,l){return new e.BufferLine(this._terminal.cols,this.getNullCell(o),l)},Object.defineProperty(c.prototype,"hasScrollback",{get:function(){return this._hasScrollback&&this.lines.maxLength>this._rows},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"isCursorInViewport",{get:function(){var o=this.ybase+this.y,l=o-this.ydisp;return l>=0&&l<this._rows},enumerable:!0,configurable:!0}),c.prototype._getCorrectBufferLength=function(o){if(!this._hasScrollback)return o;var l=o+this._terminal.options.scrollback;return l>n.MAX_BUFFER_SIZE?n.MAX_BUFFER_SIZE:l},c.prototype.fillViewportRows=function(o){if(this.lines.length===0){o===void 0&&(o=e.DEFAULT_ATTR_DATA);for(var l=this._rows;l--;)this.lines.push(this.getBlankLine(o))}},c.prototype.clear=function(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new t.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()},c.prototype.resize=function(o,l){var u=this.getNullCell(e.DEFAULT_ATTR_DATA),h=this._getCorrectBufferLength(l);if(h>this.lines.maxLength&&(this.lines.maxLength=h),this.lines.length>0){if(this._cols<o)for(var f=0;f<this.lines.length;f++)this.lines.get(f).resize(o,u);var _=0;if(this._rows<l)for(var d=this._rows;d<l;d++)this.lines.length<l+this.ybase&&(this.ybase>0&&this.lines.length<=this.ybase+this.y+_+1?(this.ybase--,_++,this.ydisp>0&&this.ydisp--):this.lines.push(new e.BufferLine(o,u)));else for(var d=this._rows;d>l;d--)this.lines.length>l+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(h<this.lines.maxLength){var p=this.lines.length-h;p>0&&(this.lines.trimStart(p),this.ybase=Math.max(this.ybase-p,0),this.ydisp=Math.max(this.ydisp-p,0)),this.lines.maxLength=h}this.x=Math.min(this.x,o-1),this.y=Math.min(this.y,l-1),_&&(this.y+=_),this.savedY=Math.min(this.savedY,l-1),this.savedX=Math.min(this.savedX,o-1),this.scrollTop=0}if(this.scrollBottom=l-1,this._isReflowEnabled&&(this._reflow(o,l),this._cols>o))for(var f=0;f<this.lines.length;f++)this.lines.get(f).resize(o,u);this._cols=o,this._rows=l},Object.defineProperty(c.prototype,"_isReflowEnabled",{get:function(){return this._hasScrollback&&!this._terminal.options.windowsMode},enumerable:!0,configurable:!0}),c.prototype._reflow=function(o,l){this._cols!==o&&(o>this._cols?this._reflowLarger(o,l):this._reflowSmaller(o,l))},c.prototype._reflowLarger=function(o,l){var u=r.reflowLargerGetLinesToRemove(this.lines,this._cols,o,this.ybase+this.y,this.getNullCell(e.DEFAULT_ATTR_DATA));if(u.length>0){var h=r.reflowLargerCreateNewLayout(this.lines,u);r.reflowLargerApplyNewLayout(this.lines,h.layout),this._reflowLargerAdjustViewport(o,l,h.countRemoved)}},c.prototype._reflowLargerAdjustViewport=function(o,l,u){for(var h=this.getNullCell(e.DEFAULT_ATTR_DATA),f=u;f-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<l&&this.lines.push(new e.BufferLine(o,h))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--)},c.prototype._reflowSmaller=function(o,l){for(var u=this.getNullCell(e.DEFAULT_ATTR_DATA),h=[],f=0,_=this.lines.length-1;_>=0;_--){var d=this.lines.get(_);if(!(!d||!d.isWrapped&&d.getTrimmedLength()<=o)){for(var p=[d];d.isWrapped&&_>0;)d=this.lines.get(--_),p.unshift(d);var m=this.ybase+this.y;if(!(m>=_&&m<_+p.length)){var x=p[p.length-1].getTrimmedLength(),g=r.reflowSmallerGetNewLineLengths(p,this._cols,o),v=g.length-p.length,A=void 0;this.ybase===0&&this.y!==this.lines.length-1?A=Math.max(0,this.y-this.lines.maxLength+v):A=Math.max(0,this.lines.length-this.lines.maxLength+v);for(var k=[],b=0;b<v;b++){var T=this.getBlankLine(e.DEFAULT_ATTR_DATA,!0);k.push(T)}k.length>0&&(h.push({start:_+p.length+f,newLines:k}),f+=k.length),p.push.apply(p,k);var P=g.length-1,L=g[P];L===0&&(P--,L=g[P]);for(var j=p.length-v-1,E=x;j>=0;){var te=Math.min(E,L);if(p[P].copyCellsFrom(p[j],E-te,L-te,te,!0),L-=te,L===0&&(P--,L=g[P]),E-=te,E===0){j--;var be=Math.max(j,0);E=r.getWrappedLineTrimmedLength(p,be,this._cols)}}for(var b=0;b<p.length;b++)g[b]<o&&p[b].setCell(g[b],u);for(var le=v-A;le-- >0;)this.ybase===0?this.y<l-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+f)-l&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++)}}}if(h.length>0){for(var $=[],he=[],b=0;b<this.lines.length;b++)he.push(this.lines.get(b));var ce=this.lines.length,ue=ce-1,fe=0,I=h[fe];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+f);for(var cr=0,b=Math.min(this.lines.maxLength-1,ce+f-1);b>=0;b--)if(I&&I.start>ue+cr){for(var at=I.newLines.length-1;at>=0;at--)this.lines.set(b--,I.newLines[at]);b++,$.push({index:ue+1,amount:I.newLines.length}),cr+=I.newLines.length,I=h[++fe]}else this.lines.set(b,he[ue--]);for(var ur=0,b=$.length-1;b>=0;b--)$[b].index+=ur,this.lines.onInsertEmitter.fire($[b]),ur+=$[b].amount;var fr=Math.max(0,ce+f-this.lines.maxLength);fr>0&&this.lines.onTrimEmitter.fire(fr)}},c.prototype.stringIndexToBufferIndex=function(o,l,u){for(u===void 0&&(u=!1);l;){var h=this.lines.get(o);if(!h)return[-1,-1];for(var f=u?h.getTrimmedLength():h.length,_=0;_<f;++_)if(h.get(_)[e.CHAR_DATA_WIDTH_INDEX]&&(l-=h.get(_)[e.CHAR_DATA_CHAR_INDEX].length||1),l<0)return[o,_];o++}return[o,0]},c.prototype.translateBufferLineToString=function(o,l,u,h){u===void 0&&(u=0);var f=this.lines.get(o);return f?f.translateToString(l,u,h):""},c.prototype.getWrappedRangeForLine=function(o){for(var l=o,u=o;l>0&&this.lines.get(l).isWrapped;)l--;for(;u+1<this.lines.length&&this.lines.get(u+1).isWrapped;)u++;return{first:l,last:u}},c.prototype.setupTabStops=function(o){for(o!=null?this.tabs[o]||(o=this.prevStop(o)):(this.tabs={},o=0);o<this._cols;o+=this._terminal.options.tabStopWidth)this.tabs[o]=!0},c.prototype.prevStop=function(o){for(o==null&&(o=this.x);!this.tabs[--o]&&o>0;);return o>=this._cols?this._cols-1:o<0?0:o},c.prototype.nextStop=function(o){for(o==null&&(o=this.x);!this.tabs[++o]&&o<this._cols;);return o>=this._cols?this._cols-1:o<0?0:o},c.prototype.addMarker=function(o){var l=this,u=new i.Marker(o);return this.markers.push(u),u.register(this.lines.onTrim(function(h){u.line-=h,u.line<0&&u.dispose()})),u.register(this.lines.onInsert(function(h){u.line>=h.index&&(u.line+=h.amount)})),u.register(this.lines.onDelete(function(h){u.line>=h.index&&u.line<h.index+h.amount&&u.dispose(),u.line>h.index&&(u.line-=h.amount)})),u.register(u.onDispose(function(){return l._removeMarker(u)})),u},c.prototype._removeMarker=function(o){this.markers.splice(this.markers.indexOf(o),1)},c.prototype.iterator=function(o,l,u,h,f){return new a(this,o,l,u,h,f)},c}();n.Buffer=s;var a=function(){function c(o,l,u,h,f,_){u===void 0&&(u=0),h===void 0&&(h=o.lines.length),f===void 0&&(f=0),_===void 0&&(_=0),this._buffer=o,this._trimRight=l,this._startIndex=u,this._endIndex=h,this._startOverscan=f,this._endOverscan=_,this._startIndex<0&&(this._startIndex=0),this._endIndex>this._buffer.lines.length&&(this._endIndex=this._buffer.lines.length),this._current=this._startIndex}return c.prototype.hasNext=function(){return this._current<this._endIndex},c.prototype.next=function(){var o=this._buffer.getWrappedRangeForLine(this._current);o.first<this._startIndex-this._startOverscan&&(o.first=this._startIndex-this._startOverscan),o.last>this._endIndex+this._endOverscan&&(o.last=this._endIndex+this._endOverscan),o.first=Math.max(o.first,0),o.last=Math.min(o.last,this._buffer.lines.length);for(var l="",u=o.first;u<=o.last;++u)l+=this._buffer.translateBufferLineToString(u,this._trimRight);return this._current=o.last+1,{range:o,content:l}},c}();n.BufferStringIterator=a})(Mt);Object.defineProperty(Dt,"__esModule",{value:!0});var br=Mt,Tn=z,kn=function(){function n(t){this._terminal=t,this._onBufferActivate=new Tn.EventEmitter2,this._normal=new br.Buffer(this._terminal,!0),this._normal.fillViewportRows(),this._alt=new br.Buffer(this._terminal,!1),this._activeBuffer=this._normal,this.setupTabStops()}return Object.defineProperty(n.prototype,"onBufferActivate",{get:function(){return this._onBufferActivate.event},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"alt",{get:function(){return this._alt},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"active",{get:function(){return this._activeBuffer},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"normal",{get:function(){return this._normal},enumerable:!0,configurable:!0}),n.prototype.activateNormalBuffer=function(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))},n.prototype.activateAltBuffer=function(t){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(t),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))},n.prototype.resize=function(t,e){this._normal.resize(t,e),this._alt.resize(t,e)},n.prototype.setupTabStops=function(t){this._normal.setupTabStops(t),this._alt.setupTabStops(t)},n}();Dt.BufferSet=kn;var Ht={};Object.defineProperty(Ht,"__esModule",{value:!0});var Dn=function(){function n(t,e,r){this._textarea=t,this._compositionView=e,this._terminal=r,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:null,end:null}}return n.prototype.compositionstart=function(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._compositionView.classList.add("active")},n.prototype.compositionupdate=function(t){var e=this;this._compositionView.textContent=t.data,this.updateCompositionElements(),setTimeout(function(){e._compositionPosition.end=e._textarea.value.length},0)},n.prototype.compositionend=function(){this._finalizeComposition(!0)},n.prototype.keydown=function(t){if(this._isComposing||this._isSendingComposition){if(t.keyCode===229)return!1;if(t.keyCode===16||t.keyCode===17||t.keyCode===18)return!1;this._finalizeComposition(!1)}return t.keyCode===229?(this._handleAnyTextareaChanges(),!1):!0},n.prototype._finalizeComposition=function(t){var e=this;if(this._compositionView.classList.remove("active"),this._isComposing=!1,this._clearTextareaPosition(),t){var i={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(function(){if(e._isSendingComposition){e._isSendingComposition=!1;var s=void 0;e._isComposing?s=e._textarea.value.substring(i.start,i.end):s=e._textarea.value.substring(i.start),e._terminal.handler(s)}},0)}else{this._isSendingComposition=!1;var r=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._terminal.handler(r)}},n.prototype._handleAnyTextareaChanges=function(){var t=this,e=this._textarea.value;setTimeout(function(){if(!t._isComposing){var r=t._textarea.value,i=r.replace(e,"");i.length>0&&t._terminal.handler(i)}},0)},n.prototype.updateCompositionElements=function(t){var e=this;if(this._isComposing){if(this._terminal.buffer.isCursorInViewport){var r=Math.ceil(this._terminal.charMeasure.height*this._terminal.options.lineHeight),i=this._terminal.buffer.y*r,s=this._terminal.buffer.x*this._terminal.charMeasure.width;this._compositionView.style.left=s+"px",this._compositionView.style.top=i+"px",this._compositionView.style.height=r+"px",this._compositionView.style.lineHeight=r+"px",this._compositionView.style.fontFamily=this._terminal.options.fontFamily,this._compositionView.style.fontSize=this._terminal.options.fontSize+"px";var a=this._compositionView.getBoundingClientRect();this._textarea.style.left=s+"px",this._textarea.style.top=i+"px",this._textarea.style.width=a.width+"px",this._textarea.style.height=a.height+"px",this._textarea.style.lineHeight=a.height+"px"}t||setTimeout(function(){return e.updateCompositionElements(!0)},0)}},n.prototype._clearTextareaPosition=function(){this._textarea.style.left="",this._textarea.style.top=""},n}();Ht.CompositionHelper=Dn;var Ft={},Mn=C&&C.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(t,e)};return function(t,e){n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Ft,"__esModule",{value:!0});var Bn=F,On=function(n){Mn(t,n);function t(){var e=n.call(this)||this;return e._events=e._events||{},e}return t.prototype.on=function(e,r){this._events[e]=this._events[e]||[],this._events[e].push(r)},t.prototype.addDisposableListener=function(e,r){var i=this;this.on(e,r);var s=!1;return{dispose:function(){s||(i.off(e,r),s=!0)}}},t.prototype.off=function(e,r){if(this._events[e]){for(var i=this._events[e],s=i.length;s--;)if(i[s]===r){i.splice(s,1);return}}},t.prototype.removeAllListeners=function(e){this._events[e]&&delete this._events[e]},t.prototype.emit=function(e){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];if(this._events[e])for(var s=this._events[e],a=0;a<s.length;a++)s[a].apply(this,r)},t.prototype.emitMayRemoveListeners=function(e){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];if(this._events[e])for(var s=this._events[e],a=s.length,c=0;c<s.length;c++)s[c].apply(this,r),c-=a-s.length,a=s.length},t.prototype.listeners=function(e){return this._events[e]||[]},t.prototype.dispose=function(){n.prototype.dispose.call(this),this._events={}},t}(Bn.Disposable);Ft.EventEmitter=On;var Pt={},se={};Object.defineProperty(se,"__esModule",{value:!0});function Hn(n,t,e,r){return n.addEventListener(t,e,r),{dispose:function(){e&&n.removeEventListener(t,e,r)}}}se.addDisposableDomListener=Hn;var Fn=C&&C.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(t,e)};return function(t,e){n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Pt,"__esModule",{value:!0});var Pn=F,In=se,Nn=15,Wn=function(n){Fn(t,n);function t(e,r,i,s,a){var c=n.call(this)||this;return c._terminal=e,c._viewportElement=r,c._scrollArea=i,c._charMeasure=s,c._dimensions=a,c.scrollBarWidth=0,c._currentRowHeight=0,c._lastRecordedBufferLength=0,c._lastRecordedViewportHeight=0,c._lastRecordedBufferHeight=0,c._lastScrollTop=0,c._wheelPartialScroll=0,c._refreshAnimationFrame=null,c._ignoreNextScrollEvent=!1,c.scrollBarWidth=c._viewportElement.offsetWidth-c._scrollArea.offsetWidth||Nn,c.register(In.addDisposableDomListener(c._viewportElement,"scroll",c._onScroll.bind(c))),setTimeout(function(){return c.syncScrollArea()},0),c}return t.prototype.onDimensionsChance=function(e){this._dimensions=e},t.prototype.onThemeChange=function(e){this._viewportElement.style.backgroundColor=e.background.css},t.prototype._refresh=function(){var e=this;this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=requestAnimationFrame(function(){return e._innerRefresh()}))},t.prototype._innerRefresh=function(){if(this._charMeasure.height>0){this._currentRowHeight=this._dimensions.scaledCellHeight/window.devicePixelRatio,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;var e=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._dimensions.canvasHeight);this._lastRecordedBufferHeight!==e&&(this._lastRecordedBufferHeight=e,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}var r=this._terminal.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==r&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=r),this._refreshAnimationFrame=null},t.prototype.syncScrollArea=function(){if(this._lastRecordedBufferLength!==this._terminal.buffer.lines.length){this._lastRecordedBufferLength=this._terminal.buffer.lines.length,this._refresh();return}if(this._lastRecordedViewportHeight!==this._dimensions.canvasHeight){this._refresh();return}var e=this._terminal.buffer.ydisp*this._currentRowHeight;if(this._lastScrollTop!==e){this._refresh();return}if(this._lastScrollTop!==this._viewportElement.scrollTop){this._refresh();return}if(this._dimensions.scaledCellHeight/window.devicePixelRatio!==this._currentRowHeight){this._refresh();return}},t.prototype._onScroll=function(e){if(this._lastScrollTop=this._viewportElement.scrollTop,!!this._viewportElement.offsetParent){if(this._ignoreNextScrollEvent){this._ignoreNextScrollEvent=!1;return}var r=Math.round(this._lastScrollTop/this._currentRowHeight),i=r-this._terminal.buffer.ydisp;this._terminal.scrollLines(i,!0)}},t.prototype.onWheel=function(e){var r=this._getPixelsScrolled(e);r!==0&&(this._viewportElement.scrollTop+=r,e.preventDefault())},t.prototype._getPixelsScrolled=function(e){if(e.deltaY===0)return 0;var r=e.deltaY;return e.deltaMode===WheelEvent.DOM_DELTA_LINE?r*=this._currentRowHeight:e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(r*=this._currentRowHeight*this._terminal.rows),r},t.prototype.getLinesScrolled=function(e){if(e.deltaY===0)return 0;var r=e.deltaY;return e.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(r/=this._currentRowHeight+0,this._wheelPartialScroll+=r,r=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(r*=this._terminal.rows),r},t.prototype.onTouchStart=function(e){this._lastTouchY=e.touches[0].pageY},t.prototype.onTouchMove=function(e){var r=this._lastTouchY-e.touches[0].pageY;this._lastTouchY=e.touches[0].pageY,r!==0&&(this._viewportElement.scrollTop+=r,e.preventDefault())},t}(Pn.Disposable);Pt.Viewport=Wn;var ee={};Object.defineProperty(ee,"__esModule",{value:!0});function ri(n){return n.replace(/\r?\n/g,"\r")}ee.prepareTextForTerminal=ri;function ii(n,t){return t?"\x1B[200~"+n+"\x1B[201~":n}ee.bracketTextForPaste=ii;function Un(n,t,e){t.browser.isMSIE?window.clipboardData.setData("Text",e.selectionText):n.clipboardData.setData("text/plain",e.selectionText),n.preventDefault()}ee.copyHandler=Un;function jn(n,t){n.stopPropagation();var e,r=function(i){i=ri(i),i=ii(i,t.bracketedPasteMode),t.handler(i),t.textarea.value="",t.emit("paste",i),t.cancel(n)};t.browser.isMSIE?window.clipboardData&&(e=window.clipboardData.getData("Text"),r(e)):n.clipboardData&&(e=n.clipboardData.getData("text/plain"),r(e))}ee.pasteHandler=jn;function ni(n,t){var e=t.screenElement.getBoundingClientRect(),r=n.clientX-e.left-10,i=n.clientY-e.top-10;t.textarea.style.position="absolute",t.textarea.style.width="20px",t.textarea.style.height="20px",t.textarea.style.left=r+"px",t.textarea.style.top=i+"px",t.textarea.style.zIndex="1000",t.textarea.focus(),setTimeout(function(){t.textarea.style.position=null,t.textarea.style.width=null,t.textarea.style.height=null,t.textarea.style.left=null,t.textarea.style.top=null,t.textarea.style.zIndex=null},200)}ee.moveTextAreaUnderMouseCursor=ni;function $n(n,t,e,r){ni(n,t),r&&!e.isClickInSelection(n)&&e.selectWordAtCursor(n),t.textarea.value=e.selectionText,t.textarea.select()}ee.rightClickHandler=$n;var Re={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),function(t){t.NUL="\0",t.SOH="",t.STX="",t.ETX="",t.EOT="",t.ENQ="",t.ACK="",t.BEL="\x07",t.BS="\b",t.HT="	",t.LF=`
`,t.VT="\v",t.FF="\f",t.CR="\r",t.SO="",t.SI="",t.DLE="",t.DC1="",t.DC2="",t.DC3="",t.DC4="",t.NAK="",t.SYN="",t.ETB="",t.CAN="",t.EM="",t.SUB="",t.ESC="\x1B",t.FS="",t.GS="",t.RS="",t.US="",t.SP=" ",t.DEL=""}(n.C0||(n.C0={})),function(t){t.PAD="",t.HOP="",t.BPH="",t.NBH="",t.IND="",t.NEL="",t.SSA="",t.ESA="",t.HTS="",t.HTJ="",t.VTS="",t.PLD="",t.PLU="",t.RI="",t.SS2="",t.SS3="",t.DCS="",t.PU1="",t.PU2="",t.STS="",t.CCH="",t.MW="",t.SPA="",t.EPA="",t.SOS="",t.SGCI="",t.SCI="",t.CSI="",t.ST="",t.OSC="",t.PM="",t.APC=""}(n.C1||(n.C1={}))})(Re);var It={},si={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.CHARSETS={},n.DEFAULT_CHARSET=n.CHARSETS.B,n.CHARSETS[0]={"`":"",a:"",b:"	",c:"\f",d:"\r",e:`
`,f:"",g:"",h:"",i:"\v",j:"",k:"",l:"",m:"",n:"",o:"",p:"",q:"",r:"",s:"",t:"",u:"",v:"",w:"",x:"",y:"",z:"","{":"","|":"","}":"","~":""},n.CHARSETS.A={"#":""},n.CHARSETS.B=null,n.CHARSETS[4]={"#":"","@":"","[":"ij","\\":"","]":"|","{":"","|":"f","}":"","~":""},n.CHARSETS.C=n.CHARSETS[5]={"[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},n.CHARSETS.R={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},n.CHARSETS.Q={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},n.CHARSETS.K={"@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""},n.CHARSETS.Y={"#":"","@":"","[":"","\\":"","]":"","`":"","{":"","|":"","}":"","~":""},n.CHARSETS.E=n.CHARSETS[6]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},n.CHARSETS.Z={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":""},n.CHARSETS.H=n.CHARSETS[7]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""},n.CHARSETS["="]={"#":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":""}})(si);var Nt={},ve={};Object.defineProperty(ve,"__esModule",{value:!0});function Kn(n,t,e,r){return n.fill?n.fill(t,e,r):oi(n,t,e,r)}ve.fill=Kn;function oi(n,t,e,r){if(e===void 0&&(e=0),r===void 0&&(r=n.length),e>=n.length)return n;e=(n.length+e)%n.length,r>=n.length?r=n.length:r=(n.length+r)%n.length;for(var i=e;i<r;++i)n[i]=t;return n}ve.fillFallback=oi;function zn(n,t){var e=new n.constructor(n.length+t.length);return e.set(n),e.set(t,n.length),e}ve.concat=zn;(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=ve;n.wcwidth=function(r){var i=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],s=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];function a(h,f){var _=0,d=f.length-1,p;if(h<f[0][0]||h>f[d][1])return!1;for(;d>=_;)if(p=_+d>>1,h>f[p][1])_=p+1;else if(h<f[p][0])d=p-1;else return!0;return!1}function c(h){return a(h,s)?0:h>=131072&&h<=196605||h>=196608&&h<=262141?2:1}var o=r.control|0,l=new Uint8Array(65536);t.fill(l,1),l[0]=r.nul,t.fill(l,r.control,1,32),t.fill(l,r.control,127,160),t.fill(l,2,4352,4448),l[9001]=2,l[9002]=2,t.fill(l,2,11904,42192),l[12351]=1,t.fill(l,2,44032,55204),t.fill(l,2,63744,64256),t.fill(l,2,65040,65050),t.fill(l,2,65072,65136),t.fill(l,2,65280,65377),t.fill(l,2,65504,65511);for(var u=0;u<i.length;++u)t.fill(l,0,i[u][0],i[u][1]+1);return function(h){return h<32?o|0:h<127?1:h<65536?l[h]:c(h)}}({nul:0,control:0});function e(r){for(var i=0,s=r.length,a=0;a<s;++a){var c=r.charCodeAt(a);if(55296<=c&&c<=56319){if(++a>=s)return i+n.wcwidth(c);var o=r.charCodeAt(a);56320<=o&&o<=57343?c=(c-55296)*1024+o-56320+65536:i+=n.wcwidth(o)}i+=n.wcwidth(c)}return i}n.getStringCellWidth=e})(Nt);var ai={};(function(n){var t=C&&C.__extends||function(){var h=function(f,_){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,p){d.__proto__=p}||function(d,p){for(var m in p)p.hasOwnProperty(m)&&(d[m]=p[m])},h(f,_)};return function(f,_){h(f,_);function d(){this.constructor=f}f.prototype=_===null?Object.create(_):(d.prototype=_.prototype,new d)}}();Object.defineProperty(n,"__esModule",{value:!0});var e=F,r=Q;function i(h,f){for(var _=f-h,d=new Array(_);_--;)d[_]=--f;return d}var s=function(){function h(f){this.table=typeof Uint8Array>"u"?new Array(f):new Uint8Array(f)}return h.prototype.add=function(f,_,d,p){this.table[_<<8|f]=(d|0)<<4|(p===void 0?_:p)},h.prototype.addMany=function(f,_,d,p){for(var m=0;m<f.length;m++)this.add(f[m],_,d,p)},h}();n.TransitionTable=s;var a=i(32,127),c=i(0,24);c.push(25),c.push.apply(c,i(28,32));var o=160;n.VT500_TRANSITION_TABLE=function(){var h=new s(4095),f=i(0,13+1),_;for(_ in f)for(var d=0;d<=o;++d)h.add(d,_,1,0);h.addMany(a,0,2,0);for(_ in f)h.addMany([24,26,153,154],_,3,0),h.addMany(i(128,144),_,3,0),h.addMany(i(144,152),_,3,0),h.add(156,_,0,0),h.add(27,_,11,1),h.add(157,_,4,8),h.addMany([152,158,159],_,0,7),h.add(155,_,11,3),h.add(144,_,11,9);return h.addMany(c,0,3,0),h.addMany(c,1,3,1),h.add(127,1,0,1),h.addMany(c,8,0,8),h.addMany(c,3,3,3),h.add(127,3,0,3),h.addMany(c,4,3,4),h.add(127,4,0,4),h.addMany(c,6,3,6),h.addMany(c,5,3,5),h.add(127,5,0,5),h.addMany(c,2,3,2),h.add(127,2,0,2),h.add(93,1,4,8),h.addMany(a,8,5,8),h.add(127,8,5,8),h.addMany([156,27,24,26,7],8,6,0),h.addMany(i(28,32),8,0,8),h.addMany([88,94,95],1,0,7),h.addMany(a,7,0,7),h.addMany(c,7,0,7),h.add(156,7,0,0),h.add(127,7,0,7),h.add(91,1,11,3),h.addMany(i(64,127),3,7,0),h.addMany(i(48,58),3,8,4),h.add(59,3,8,4),h.addMany([60,61,62,63],3,9,4),h.addMany(i(48,58),4,8,4),h.add(59,4,8,4),h.addMany(i(64,127),4,7,0),h.addMany([58,60,61,62,63],4,0,6),h.addMany(i(32,64),6,0,6),h.add(127,6,0,6),h.addMany(i(64,127),6,0,0),h.add(58,3,0,6),h.addMany(i(32,48),3,9,5),h.addMany(i(32,48),5,9,5),h.addMany(i(48,64),5,0,6),h.addMany(i(64,127),5,7,0),h.addMany(i(32,48),4,9,5),h.addMany(i(32,48),1,9,2),h.addMany(i(32,48),2,9,2),h.addMany(i(48,127),2,10,0),h.addMany(i(48,80),1,10,0),h.addMany(i(81,88),1,10,0),h.addMany([89,90,92],1,10,0),h.addMany(i(96,127),1,10,0),h.add(80,1,11,9),h.addMany(c,9,0,9),h.add(127,9,0,9),h.addMany(i(28,32),9,0,9),h.addMany(i(32,48),9,9,12),h.add(58,9,0,11),h.addMany(i(48,58),9,8,10),h.add(59,9,8,10),h.addMany([60,61,62,63],9,9,10),h.addMany(c,11,0,11),h.addMany(i(32,128),11,0,11),h.addMany(i(28,32),11,0,11),h.addMany(c,10,0,10),h.add(127,10,0,10),h.addMany(i(28,32),10,0,10),h.addMany(i(48,58),10,8,10),h.add(59,10,8,10),h.addMany([58,60,61,62,63],10,0,11),h.addMany(i(32,48),10,9,12),h.addMany(c,12,0,12),h.add(127,12,0,12),h.addMany(i(28,32),12,0,12),h.addMany(i(32,48),12,9,12),h.addMany(i(48,64),12,0,11),h.addMany(i(64,127),12,12,13),h.addMany(i(64,127),10,12,13),h.addMany(i(64,127),9,12,13),h.addMany(c,13,13,13),h.addMany(a,13,13,13),h.add(127,13,0,13),h.addMany([27,156],13,14,0),h.add(o,8,5,8),h}();var l=function(){function h(){}return h.prototype.hook=function(f,_,d){},h.prototype.put=function(f,_,d){},h.prototype.unhook=function(){},h}(),u=function(h){t(f,h);function f(_){_===void 0&&(_=n.VT500_TRANSITION_TABLE);var d=h.call(this)||this;return d.TRANSITIONS=_,d.initialState=0,d.currentState=d.initialState,d._osc="",d._params=[0],d._collect="",d._printHandlerFb=function(p,m,x){},d._executeHandlerFb=function(p){},d._csiHandlerFb=function(p,m,x){},d._escHandlerFb=function(p,m){},d._oscHandlerFb=function(p,m){},d._dcsHandlerFb=new l,d._errorHandlerFb=function(p){return p},d._printHandler=d._printHandlerFb,d._executeHandlers=Object.create(null),d._csiHandlers=Object.create(null),d._escHandlers=Object.create(null),d._oscHandlers=Object.create(null),d._dcsHandlers=Object.create(null),d._activeDcsHandler=null,d._errorHandler=d._errorHandlerFb,d.setEscHandler("\\",function(){}),d}return f.prototype.dispose=function(){this._printHandlerFb=null,this._executeHandlerFb=null,this._csiHandlerFb=null,this._escHandlerFb=null,this._oscHandlerFb=null,this._dcsHandlerFb=null,this._errorHandlerFb=null,this._printHandler=null,this._executeHandlers=null,this._escHandlers=null,this._csiHandlers=null,this._oscHandlers=null,this._dcsHandlers=null,this._activeDcsHandler=null,this._errorHandler=null},f.prototype.setPrintHandler=function(_){this._printHandler=_},f.prototype.clearPrintHandler=function(){this._printHandler=this._printHandlerFb},f.prototype.setExecuteHandler=function(_,d){this._executeHandlers[_.charCodeAt(0)]=d},f.prototype.clearExecuteHandler=function(_){this._executeHandlers[_.charCodeAt(0)]&&delete this._executeHandlers[_.charCodeAt(0)]},f.prototype.setExecuteHandlerFallback=function(_){this._executeHandlerFb=_},f.prototype.addCsiHandler=function(_,d){var p=_.charCodeAt(0);this._csiHandlers[p]===void 0&&(this._csiHandlers[p]=[]);var m=this._csiHandlers[p];return m.push(d),{dispose:function(){var x=m.indexOf(d);x!==-1&&m.splice(x,1)}}},f.prototype.setCsiHandler=function(_,d){this._csiHandlers[_.charCodeAt(0)]=[d]},f.prototype.clearCsiHandler=function(_){this._csiHandlers[_.charCodeAt(0)]&&delete this._csiHandlers[_.charCodeAt(0)]},f.prototype.setCsiHandlerFallback=function(_){this._csiHandlerFb=_},f.prototype.setEscHandler=function(_,d){this._escHandlers[_]=d},f.prototype.clearEscHandler=function(_){this._escHandlers[_]&&delete this._escHandlers[_]},f.prototype.setEscHandlerFallback=function(_){this._escHandlerFb=_},f.prototype.addOscHandler=function(_,d){this._oscHandlers[_]===void 0&&(this._oscHandlers[_]=[]);var p=this._oscHandlers[_];return p.push(d),{dispose:function(){var m=p.indexOf(d);m!==-1&&p.splice(m,1)}}},f.prototype.setOscHandler=function(_,d){this._oscHandlers[_]=[d]},f.prototype.clearOscHandler=function(_){this._oscHandlers[_]&&delete this._oscHandlers[_]},f.prototype.setOscHandlerFallback=function(_){this._oscHandlerFb=_},f.prototype.setDcsHandler=function(_,d){this._dcsHandlers[_]=d},f.prototype.clearDcsHandler=function(_){this._dcsHandlers[_]&&delete this._dcsHandlers[_]},f.prototype.setDcsHandlerFallback=function(_){this._dcsHandlerFb=_},f.prototype.setErrorHandler=function(_){this._errorHandler=_},f.prototype.clearErrorHandler=function(){this._errorHandler=this._errorHandlerFb},f.prototype.reset=function(){this.currentState=this.initialState,this._osc="",this._params=[0],this._collect="",this._activeDcsHandler=null},f.prototype.parse=function(_,d){for(var p=0,m=0,x=!1,g=this.currentState,v=-1,A=-1,k=this._osc,b=this._collect,T=this._params,P=this.TRANSITIONS.table,L=this._activeDcsHandler,j=null,E=0;E<d;++E){if(p=_[E],g===0&&p>31&&p<128){v=~v?v:E;do E++;while(E<d&&_[E]>31&&_[E]<128);E--;continue}if(g===4&&p>47&&p<57){T[T.length-1]=T[T.length-1]*10+p-48;continue}switch(m=P[g<<8|(p<160?p:o)],m>>4){case 2:v=~v?v:E;break;case 3:~v&&(this._printHandler(_,v,E),v=-1),j=this._executeHandlers[p],j?j():this._executeHandlerFb(p);break;case 0:~v?(this._printHandler(_,v,E),v=-1):~A&&(L.put(_,A,E),A=-1);break;case 1:if(p>159)switch(g){case 0:v=~v?v:E;break;case 6:m|=6;break;case 11:m|=11;break;case 13:A=~A?A:E,m|=13;break;default:x=!0}else x=!0;if(x){var te=this._errorHandler({position:E,code:p,currentState:g,print:v,dcs:A,osc:k,collect:b,params:T,abort:!1});if(te.abort)return;x=!1}break;case 7:for(var be=this._csiHandlers[p],le=be?be.length-1:-1;le>=0&&be[le](T,b)===!1;le--);le<0&&this._csiHandlerFb(b,T,p);break;case 8:p===59?T.push(0):T[T.length-1]=T[T.length-1]*10+p-48;break;case 9:b+=String.fromCharCode(p);break;case 10:j=this._escHandlers[b+String.fromCharCode(p)],j?j(b,p):this._escHandlerFb(b,p);break;case 11:~v&&(this._printHandler(_,v,E),v=-1),k="",T=[0],b="",A=-1;break;case 12:L=this._dcsHandlers[b+String.fromCharCode(p)],L||(L=this._dcsHandlerFb),L.hook(b,T,p);break;case 13:A=~A?A:E;break;case 14:L&&(~A&&L.put(_,A,E),L.unhook(),L=null),p===27&&(m|=1),k="",T=[0],b="",A=-1;break;case 4:~v&&(this._printHandler(_,v,E),v=-1),k="";break;case 5:for(var $=E+1;;$++)if($>=d||(p=_[$])<32||p>127&&p<=159){k+=r.utf32ToString(_,E,$),E=$-1;break}break;case 6:if(k&&p!==24&&p!==26){var he=k.indexOf(";");if(he===-1)this._oscHandlerFb(-1,k);else{for(var ce=parseInt(k.substring(0,he)),ue=k.substring(he+1),fe=this._oscHandlers[ce],I=fe?fe.length-1:-1;I>=0&&fe[I](ue)===!1;I--);I<0&&this._oscHandlerFb(ce,ue)}}p===27&&(m|=1),k="",T=[0],b="",A=-1;break}g=m&15}g===0&&~v?this._printHandler(_,v,d):g===13&&~A&&L&&L.put(_,A,d),this._osc=k,this._collect=b,this._params=T,this._activeDcsHandler=L,this.currentState=g},f}(e.Disposable);n.EscapeSequenceParser=u})(ai);var qn=C&&C.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(t,e)};return function(t,e){n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(It,"__esModule",{value:!0});var S=Re,J=si,Vn=Nt,Gn=ai,Yn=F,Xn=ve,Xe=Q,M=q,Ie=z,Jn={"(":0,")":1,"*":2,"+":3,"-":1,".":2},Zn=function(){function n(t){this._terminal=t,this._data=new Uint32Array(0)}return n.prototype.hook=function(t,e,r){this._data=new Uint32Array(0)},n.prototype.put=function(t,e,r){this._data=Xn.concat(this._data,t.subarray(e,r))},n.prototype.unhook=function(){var t=Xe.utf32ToString(this._data);switch(this._data=new Uint32Array(0),t){case'"q':return this._terminal.handler(S.C0.ESC+'P1$r0"q'+S.C0.ESC+"\\");case'"p':return this._terminal.handler(S.C0.ESC+'P1$r61"p'+S.C0.ESC+"\\");case"r":var e=""+(this._terminal.buffer.scrollTop+1)+";"+(this._terminal.buffer.scrollBottom+1)+"r";return this._terminal.handler(S.C0.ESC+"P1$r"+e+S.C0.ESC+"\\");case"m":return this._terminal.handler(S.C0.ESC+"P1$r0m"+S.C0.ESC+"\\");case" q":var r={block:2,underline:4,bar:6},i=r[this._terminal.getOption("cursorStyle")];return i-=this._terminal.getOption("cursorBlink"),this._terminal.handler(S.C0.ESC+"P1$r"+i+" q"+S.C0.ESC+"\\");default:this._terminal.error("Unknown DCS $q %s",t),this._terminal.handler(S.C0.ESC+"P0$r"+S.C0.ESC+"\\")}},n}(),Qn=function(n){qn(t,n);function t(e,r){r===void 0&&(r=new Gn.EscapeSequenceParser);var i=n.call(this)||this;i._terminal=e,i._parser=r,i._parseBuffer=new Uint32Array(4096),i._stringDecoder=new Xe.StringToUtf32,i._utf8Decoder=new Xe.Utf8ToUtf32,i._workCell=new M.CellData,i._onCursorMove=new Ie.EventEmitter2,i._onData=new Ie.EventEmitter2,i._onLineFeed=new Ie.EventEmitter2,i._onScroll=new Ie.EventEmitter2,i.register(i._parser),i._parser.setCsiHandlerFallback(function(o,l,u){i._terminal.error("Unknown CSI code: ",{collect:o,params:l,flag:String.fromCharCode(u)})}),i._parser.setEscHandlerFallback(function(o,l){i._terminal.error("Unknown ESC code: ",{collect:o,flag:String.fromCharCode(l)})}),i._parser.setExecuteHandlerFallback(function(o){i._terminal.error("Unknown EXECUTE code: ",{code:o})}),i._parser.setOscHandlerFallback(function(o,l){i._terminal.error("Unknown OSC code: ",{identifier:o,data:l})}),i._parser.setPrintHandler(function(o,l,u){return i.print(o,l,u)}),i._parser.setCsiHandler("@",function(o,l){return i.insertChars(o)}),i._parser.setCsiHandler("A",function(o,l){return i.cursorUp(o)}),i._parser.setCsiHandler("B",function(o,l){return i.cursorDown(o)}),i._parser.setCsiHandler("C",function(o,l){return i.cursorForward(o)}),i._parser.setCsiHandler("D",function(o,l){return i.cursorBackward(o)}),i._parser.setCsiHandler("E",function(o,l){return i.cursorNextLine(o)}),i._parser.setCsiHandler("F",function(o,l){return i.cursorPrecedingLine(o)}),i._parser.setCsiHandler("G",function(o,l){return i.cursorCharAbsolute(o)}),i._parser.setCsiHandler("H",function(o,l){return i.cursorPosition(o)}),i._parser.setCsiHandler("I",function(o,l){return i.cursorForwardTab(o)}),i._parser.setCsiHandler("J",function(o,l){return i.eraseInDisplay(o)}),i._parser.setCsiHandler("K",function(o,l){return i.eraseInLine(o)}),i._parser.setCsiHandler("L",function(o,l){return i.insertLines(o)}),i._parser.setCsiHandler("M",function(o,l){return i.deleteLines(o)}),i._parser.setCsiHandler("P",function(o,l){return i.deleteChars(o)}),i._parser.setCsiHandler("S",function(o,l){return i.scrollUp(o)}),i._parser.setCsiHandler("T",function(o,l){return i.scrollDown(o,l)}),i._parser.setCsiHandler("X",function(o,l){return i.eraseChars(o)}),i._parser.setCsiHandler("Z",function(o,l){return i.cursorBackwardTab(o)}),i._parser.setCsiHandler("`",function(o,l){return i.charPosAbsolute(o)}),i._parser.setCsiHandler("a",function(o,l){return i.hPositionRelative(o)}),i._parser.setCsiHandler("b",function(o,l){return i.repeatPrecedingCharacter(o)}),i._parser.setCsiHandler("c",function(o,l){return i.sendDeviceAttributes(o,l)}),i._parser.setCsiHandler("d",function(o,l){return i.linePosAbsolute(o)}),i._parser.setCsiHandler("e",function(o,l){return i.vPositionRelative(o)}),i._parser.setCsiHandler("f",function(o,l){return i.hVPosition(o)}),i._parser.setCsiHandler("g",function(o,l){return i.tabClear(o)}),i._parser.setCsiHandler("h",function(o,l){return i.setMode(o,l)}),i._parser.setCsiHandler("l",function(o,l){return i.resetMode(o,l)}),i._parser.setCsiHandler("m",function(o,l){return i.charAttributes(o)}),i._parser.setCsiHandler("n",function(o,l){return i.deviceStatus(o,l)}),i._parser.setCsiHandler("p",function(o,l){return i.softReset(o,l)}),i._parser.setCsiHandler("q",function(o,l){return i.setCursorStyle(o,l)}),i._parser.setCsiHandler("r",function(o,l){return i.setScrollRegion(o,l)}),i._parser.setCsiHandler("s",function(o,l){return i.saveCursor(o)}),i._parser.setCsiHandler("u",function(o,l){return i.restoreCursor(o)}),i._parser.setExecuteHandler(S.C0.BEL,function(){return i.bell()}),i._parser.setExecuteHandler(S.C0.LF,function(){return i.lineFeed()}),i._parser.setExecuteHandler(S.C0.VT,function(){return i.lineFeed()}),i._parser.setExecuteHandler(S.C0.FF,function(){return i.lineFeed()}),i._parser.setExecuteHandler(S.C0.CR,function(){return i.carriageReturn()}),i._parser.setExecuteHandler(S.C0.BS,function(){return i.backspace()}),i._parser.setExecuteHandler(S.C0.HT,function(){return i.tab()}),i._parser.setExecuteHandler(S.C0.SO,function(){return i.shiftOut()}),i._parser.setExecuteHandler(S.C0.SI,function(){return i.shiftIn()}),i._parser.setExecuteHandler(S.C1.IND,function(){return i.index()}),i._parser.setExecuteHandler(S.C1.NEL,function(){return i.nextLine()}),i._parser.setExecuteHandler(S.C1.HTS,function(){return i.tabSet()}),i._parser.setOscHandler(0,function(o){return i.setTitle(o)}),i._parser.setOscHandler(2,function(o){return i.setTitle(o)}),i._parser.setEscHandler("7",function(){return i.saveCursor([])}),i._parser.setEscHandler("8",function(){return i.restoreCursor([])}),i._parser.setEscHandler("D",function(){return i.index()}),i._parser.setEscHandler("E",function(){return i.nextLine()}),i._parser.setEscHandler("H",function(){return i.tabSet()}),i._parser.setEscHandler("M",function(){return i.reverseIndex()}),i._parser.setEscHandler("=",function(){return i.keypadApplicationMode()}),i._parser.setEscHandler(">",function(){return i.keypadNumericMode()}),i._parser.setEscHandler("c",function(){return i.reset()}),i._parser.setEscHandler("n",function(){return i.setgLevel(2)}),i._parser.setEscHandler("o",function(){return i.setgLevel(3)}),i._parser.setEscHandler("|",function(){return i.setgLevel(3)}),i._parser.setEscHandler("}",function(){return i.setgLevel(2)}),i._parser.setEscHandler("~",function(){return i.setgLevel(1)}),i._parser.setEscHandler("%@",function(){return i.selectDefaultCharset()}),i._parser.setEscHandler("%G",function(){return i.selectDefaultCharset()});var s=function(o){a._parser.setEscHandler("("+o,function(){return i.selectCharset("("+o)}),a._parser.setEscHandler(")"+o,function(){return i.selectCharset(")"+o)}),a._parser.setEscHandler("*"+o,function(){return i.selectCharset("*"+o)}),a._parser.setEscHandler("+"+o,function(){return i.selectCharset("+"+o)}),a._parser.setEscHandler("-"+o,function(){return i.selectCharset("-"+o)}),a._parser.setEscHandler("."+o,function(){return i.selectCharset("."+o)}),a._parser.setEscHandler("/"+o,function(){return i.selectCharset("/"+o)})},a=this;for(var c in J.CHARSETS)s(c);return i._parser.setErrorHandler(function(o){return i._terminal.error("Parsing error: ",o),o}),i._parser.setDcsHandler("$q",new Zn(i._terminal)),i}return Object.defineProperty(t.prototype,"onCursorMove",{get:function(){return this._onCursorMove.event},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onData",{get:function(){return this._onData.event},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onLineFeed",{get:function(){return this._onLineFeed.event},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onScroll",{get:function(){return this._onScroll.event},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){n.prototype.dispose.call(this),this._terminal=null},t.prototype.parse=function(e){if(this._terminal){var r=this._terminal.buffer,i=r.x,s=r.y;this._terminal.debug&&this._terminal.log("data: "+e),this._parseBuffer.length<e.length&&(this._parseBuffer=new Uint32Array(e.length)),this._parser.parse(this._parseBuffer,this._stringDecoder.decode(e,this._parseBuffer)),r=this._terminal.buffer,(r.x!==i||r.y!==s)&&this._onCursorMove.fire()}},t.prototype.parseUtf8=function(e){if(this._terminal){var r=this._terminal.buffer,i=r.x,s=r.y;this._terminal.debug&&this._terminal.log("data: "+e),this._parseBuffer.length<e.length&&(this._parseBuffer=new Uint32Array(e.length)),this._parser.parse(this._parseBuffer,this._utf8Decoder.decode(e,this._parseBuffer)),r=this._terminal.buffer,(r.x!==i||r.y!==s)&&this._terminal.emit("cursormove")}},t.prototype.print=function(e,r,i){var s,a,c=this._terminal.buffer,o=this._terminal.charset,l=this._terminal.options.screenReaderMode,u=this._terminal.cols,h=this._terminal.wraparoundMode,f=this._terminal.insertMode,_=this._terminal.curAttrData,d=c.lines.get(c.y+c.ybase);this._terminal.updateRange(c.y);for(var p=r;p<i;++p){if(s=e[p],a=Vn.wcwidth(s),s<127&&o){var m=o[String.fromCharCode(s)];m&&(s=m.charCodeAt(0))}if(l&&this._terminal.emit("a11y.char",Xe.stringFromCodePoint(s)),!a&&c.x){d.getWidth(c.x-1)?d.addCodepointToCell(c.x-1,s):d.addCodepointToCell(c.x-2,s);continue}if(c.x+a-1>=u){if(h)c.x=0,c.y++,c.y>c.scrollBottom?(c.y--,this._terminal.scroll(!0)):c.lines.get(c.y).isWrapped=!0,d=c.lines.get(c.y+c.ybase);else if(a===2)continue}if(f&&(d.insertCells(c.x,a,c.getNullCell(_)),d.getWidth(u-1)===2&&d.setCellFromCodePoint(u-1,M.NULL_CELL_CODE,M.NULL_CELL_WIDTH,_.fg,_.bg)),d.setCellFromCodePoint(c.x++,s,a,_.fg,_.bg),a>0)for(;--a;)d.setCellFromCodePoint(c.x++,0,0,_.fg,_.bg)}this._terminal.updateRange(c.y)},t.prototype.addCsiHandler=function(e,r){return this._parser.addCsiHandler(e,r)},t.prototype.addOscHandler=function(e,r){return this._parser.addOscHandler(e,r)},t.prototype.bell=function(){this._terminal.bell()},t.prototype.lineFeed=function(){var e=this._terminal.buffer;this._terminal.options.convertEol&&(e.x=0),e.y++,e.y>e.scrollBottom&&(e.y--,this._terminal.scroll()),e.x>=this._terminal.cols&&e.x--,this._onLineFeed.fire()},t.prototype.carriageReturn=function(){this._terminal.buffer.x=0},t.prototype.backspace=function(){this._terminal.buffer.x>0&&this._terminal.buffer.x--},t.prototype.tab=function(){var e=this._terminal.buffer.x;this._terminal.buffer.x=this._terminal.buffer.nextStop(),this._terminal.options.screenReaderMode&&this._terminal.emit("a11y.tab",this._terminal.buffer.x-e)},t.prototype.shiftOut=function(){this._terminal.setgLevel(1)},t.prototype.shiftIn=function(){this._terminal.setgLevel(0)},t.prototype.insertChars=function(e){this._terminal.buffer.lines.get(this._terminal.buffer.y+this._terminal.buffer.ybase).insertCells(this._terminal.buffer.x,e[0]||1,this._terminal.buffer.getNullCell(this._terminal.eraseAttrData())),this._terminal.updateRange(this._terminal.buffer.y)},t.prototype.cursorUp=function(e){var r=e[0];r<1&&(r=1),this._terminal.buffer.y-=r,this._terminal.buffer.y<0&&(this._terminal.buffer.y=0)},t.prototype.cursorDown=function(e){var r=e[0];r<1&&(r=1),this._terminal.buffer.y+=r,this._terminal.buffer.y>=this._terminal.rows&&(this._terminal.buffer.y=this._terminal.rows-1),this._terminal.buffer.x>=this._terminal.cols&&this._terminal.buffer.x--},t.prototype.cursorForward=function(e){var r=e[0];r<1&&(r=1),this._terminal.buffer.x+=r,this._terminal.buffer.x>=this._terminal.cols&&(this._terminal.buffer.x=this._terminal.cols-1)},t.prototype.cursorBackward=function(e){var r=e[0];r<1&&(r=1),this._terminal.buffer.x>=this._terminal.cols&&this._terminal.buffer.x--,this._terminal.buffer.x-=r,this._terminal.buffer.x<0&&(this._terminal.buffer.x=0)},t.prototype.cursorNextLine=function(e){var r=e[0];r<1&&(r=1),this._terminal.buffer.y+=r,this._terminal.buffer.y>=this._terminal.rows&&(this._terminal.buffer.y=this._terminal.rows-1),this._terminal.buffer.x=0},t.prototype.cursorPrecedingLine=function(e){var r=e[0];r<1&&(r=1),this._terminal.buffer.y-=r,this._terminal.buffer.y<0&&(this._terminal.buffer.y=0),this._terminal.buffer.x=0},t.prototype.cursorCharAbsolute=function(e){var r=e[0];r<1&&(r=1),this._terminal.buffer.x=r-1},t.prototype.cursorPosition=function(e){var r,i=e[0]-1;e.length>=2?r=e[1]-1:r=0,i<0?i=0:i>=this._terminal.rows&&(i=this._terminal.rows-1),r<0?r=0:r>=this._terminal.cols&&(r=this._terminal.cols-1),this._terminal.buffer.x=r,this._terminal.buffer.y=i},t.prototype.cursorForwardTab=function(e){for(var r=e[0]||1;r--;)this._terminal.buffer.x=this._terminal.buffer.nextStop()},t.prototype._eraseInBufferLine=function(e,r,i,s){s===void 0&&(s=!1);var a=this._terminal.buffer.lines.get(this._terminal.buffer.ybase+e);a.replaceCells(r,i,this._terminal.buffer.getNullCell(this._terminal.eraseAttrData())),s&&(a.isWrapped=!1)},t.prototype._resetBufferLine=function(e){this._eraseInBufferLine(e,0,this._terminal.cols,!0)},t.prototype.eraseInDisplay=function(e){var r;switch(e[0]){case 0:for(r=this._terminal.buffer.y,this._terminal.updateRange(r),this._eraseInBufferLine(r++,this._terminal.buffer.x,this._terminal.cols,this._terminal.buffer.x===0);r<this._terminal.rows;r++)this._resetBufferLine(r);this._terminal.updateRange(r);break;case 1:for(r=this._terminal.buffer.y,this._terminal.updateRange(r),this._eraseInBufferLine(r,0,this._terminal.buffer.x+1,!0),this._terminal.buffer.x+1>=this._terminal.cols&&(this._terminal.buffer.lines.get(r+1).isWrapped=!1);r--;)this._resetBufferLine(r);this._terminal.updateRange(0);break;case 2:for(r=this._terminal.rows,this._terminal.updateRange(r-1);r--;)this._resetBufferLine(r);this._terminal.updateRange(0);break;case 3:var i=this._terminal.buffer.lines.length-this._terminal.rows;i>0&&(this._terminal.buffer.lines.trimStart(i),this._terminal.buffer.ybase=Math.max(this._terminal.buffer.ybase-i,0),this._terminal.buffer.ydisp=Math.max(this._terminal.buffer.ydisp-i,0),this._onScroll.fire(0));break}},t.prototype.eraseInLine=function(e){switch(e[0]){case 0:this._eraseInBufferLine(this._terminal.buffer.y,this._terminal.buffer.x,this._terminal.cols);break;case 1:this._eraseInBufferLine(this._terminal.buffer.y,0,this._terminal.buffer.x+1);break;case 2:this._eraseInBufferLine(this._terminal.buffer.y,0,this._terminal.cols);break}this._terminal.updateRange(this._terminal.buffer.y)},t.prototype.insertLines=function(e){var r=e[0];r<1&&(r=1);for(var i=this._terminal.buffer,s=i.y+i.ybase,a=this._terminal.rows-1-i.scrollBottom,c=this._terminal.rows-1+i.ybase-a+1;r--;)i.lines.splice(c-1,1),i.lines.splice(s,0,i.getBlankLine(this._terminal.eraseAttrData()));this._terminal.updateRange(i.y),this._terminal.updateRange(i.scrollBottom)},t.prototype.deleteLines=function(e){var r=e[0];r<1&&(r=1);var i=this._terminal.buffer,s=i.y+i.ybase,a;for(a=this._terminal.rows-1-i.scrollBottom,a=this._terminal.rows-1+i.ybase-a;r--;)i.lines.splice(s,1),i.lines.splice(a,0,i.getBlankLine(this._terminal.eraseAttrData()));this._terminal.updateRange(i.y),this._terminal.updateRange(i.scrollBottom)},t.prototype.deleteChars=function(e){this._terminal.buffer.lines.get(this._terminal.buffer.y+this._terminal.buffer.ybase).deleteCells(this._terminal.buffer.x,e[0]||1,this._terminal.buffer.getNullCell(this._terminal.eraseAttrData())),this._terminal.updateRange(this._terminal.buffer.y)},t.prototype.scrollUp=function(e){for(var r=e[0]||1,i=this._terminal.buffer;r--;)i.lines.splice(i.ybase+i.scrollTop,1),i.lines.splice(i.ybase+i.scrollBottom,0,i.getBlankLine(M.DEFAULT_ATTR_DATA));this._terminal.updateRange(i.scrollTop),this._terminal.updateRange(i.scrollBottom)},t.prototype.scrollDown=function(e,r){if(e.length<2&&!r){for(var i=e[0]||1,s=this._terminal.buffer;i--;)s.lines.splice(s.ybase+s.scrollBottom,1),s.lines.splice(s.ybase+s.scrollTop,0,s.getBlankLine(M.DEFAULT_ATTR_DATA));this._terminal.updateRange(s.scrollTop),this._terminal.updateRange(s.scrollBottom)}},t.prototype.eraseChars=function(e){this._terminal.buffer.lines.get(this._terminal.buffer.y+this._terminal.buffer.ybase).replaceCells(this._terminal.buffer.x,this._terminal.buffer.x+(e[0]||1),this._terminal.buffer.getNullCell(this._terminal.eraseAttrData()))},t.prototype.cursorBackwardTab=function(e){for(var r=e[0]||1,i=this._terminal.buffer;r--;)i.x=i.prevStop()},t.prototype.charPosAbsolute=function(e){var r=e[0];r<1&&(r=1),this._terminal.buffer.x=r-1,this._terminal.buffer.x>=this._terminal.cols&&(this._terminal.buffer.x=this._terminal.cols-1)},t.prototype.hPositionRelative=function(e){var r=e[0];r<1&&(r=1),this._terminal.buffer.x+=r,this._terminal.buffer.x>=this._terminal.cols&&(this._terminal.buffer.x=this._terminal.cols-1)},t.prototype.repeatPrecedingCharacter=function(e){var r=this._terminal.buffer,i=r.lines.get(r.ybase+r.y);i.loadCell(r.x-1,this._workCell),i.replaceCells(r.x,r.x+(e[0]||1),this._workCell.content!==void 0?this._workCell:r.getNullCell(M.DEFAULT_ATTR_DATA))},t.prototype.sendDeviceAttributes=function(e,r){e[0]>0||(r?r===">"&&(this._terminal.is("xterm")?this._terminal.handler(S.C0.ESC+"[>0;276;0c"):this._terminal.is("rxvt-unicode")?this._terminal.handler(S.C0.ESC+"[>85;95;0c"):this._terminal.is("linux")?this._terminal.handler(e[0]+"c"):this._terminal.is("screen")&&this._terminal.handler(S.C0.ESC+"[>83;40003;0c")):this._terminal.is("xterm")||this._terminal.is("rxvt-unicode")||this._terminal.is("screen")?this._terminal.handler(S.C0.ESC+"[?1;2c"):this._terminal.is("linux")&&this._terminal.handler(S.C0.ESC+"[?6c"))},t.prototype.linePosAbsolute=function(e){var r=e[0];r<1&&(r=1),this._terminal.buffer.y=r-1,this._terminal.buffer.y>=this._terminal.rows&&(this._terminal.buffer.y=this._terminal.rows-1)},t.prototype.vPositionRelative=function(e){var r=e[0];r<1&&(r=1),this._terminal.buffer.y+=r,this._terminal.buffer.y>=this._terminal.rows&&(this._terminal.buffer.y=this._terminal.rows-1),this._terminal.buffer.x>=this._terminal.cols&&this._terminal.buffer.x--},t.prototype.hVPosition=function(e){e[0]<1&&(e[0]=1),e[1]<1&&(e[1]=1),this._terminal.buffer.y=e[0]-1,this._terminal.buffer.y>=this._terminal.rows&&(this._terminal.buffer.y=this._terminal.rows-1),this._terminal.buffer.x=e[1]-1,this._terminal.buffer.x>=this._terminal.cols&&(this._terminal.buffer.x=this._terminal.cols-1)},t.prototype.tabClear=function(e){var r=e[0];r<=0?delete this._terminal.buffer.tabs[this._terminal.buffer.x]:r===3&&(this._terminal.buffer.tabs={})},t.prototype.setMode=function(e,r){if(e.length>1){for(var i=0;i<e.length;i++)this.setMode([e[i]]);return}if(r){if(r==="?")switch(e[0]){case 1:this._terminal.applicationCursor=!0;break;case 2:this._terminal.setgCharset(0,J.DEFAULT_CHARSET),this._terminal.setgCharset(1,J.DEFAULT_CHARSET),this._terminal.setgCharset(2,J.DEFAULT_CHARSET),this._terminal.setgCharset(3,J.DEFAULT_CHARSET);break;case 3:this._terminal.savedCols=this._terminal.cols,this._terminal.resize(132,this._terminal.rows);break;case 6:this._terminal.originMode=!0;break;case 7:this._terminal.wraparoundMode=!0;break;case 12:break;case 66:this._terminal.log("Serial port requested application keypad."),this._terminal.applicationKeypad=!0,this._terminal.viewport&&this._terminal.viewport.syncScrollArea();break;case 9:case 1e3:case 1002:case 1003:this._terminal.x10Mouse=e[0]===9,this._terminal.vt200Mouse=e[0]===1e3,this._terminal.normalMouse=e[0]>1e3,this._terminal.mouseEvents=!0,this._terminal.element&&this._terminal.element.classList.add("enable-mouse-events"),this._terminal.selectionManager&&this._terminal.selectionManager.disable(),this._terminal.log("Binding to mouse events.");break;case 1004:this._terminal.sendFocus=!0;break;case 1005:this._terminal.utfMouse=!0;break;case 1006:this._terminal.sgrMouse=!0;break;case 1015:this._terminal.urxvtMouse=!0;break;case 25:this._terminal.cursorHidden=!1;break;case 1048:this.saveCursor(e);break;case 1049:this.saveCursor(e);case 47:case 1047:this._terminal.buffers.activateAltBuffer(this._terminal.eraseAttrData()),this._terminal.refresh(0,this._terminal.rows-1),this._terminal.viewport&&this._terminal.viewport.syncScrollArea(),this._terminal.showCursor();break;case 2004:this._terminal.bracketedPasteMode=!0;break}}else switch(e[0]){case 4:this._terminal.insertMode=!0;break}},t.prototype.resetMode=function(e,r){if(e.length>1){for(var i=0;i<e.length;i++)this.resetMode([e[i]]);return}if(r){if(r==="?")switch(e[0]){case 1:this._terminal.applicationCursor=!1;break;case 3:this._terminal.cols===132&&this._terminal.savedCols&&this._terminal.resize(this._terminal.savedCols,this._terminal.rows),delete this._terminal.savedCols;break;case 6:this._terminal.originMode=!1;break;case 7:this._terminal.wraparoundMode=!1;break;case 12:break;case 66:this._terminal.log("Switching back to normal keypad."),this._terminal.applicationKeypad=!1,this._terminal.viewport&&this._terminal.viewport.syncScrollArea();break;case 9:case 1e3:case 1002:case 1003:this._terminal.x10Mouse=!1,this._terminal.vt200Mouse=!1,this._terminal.normalMouse=!1,this._terminal.mouseEvents=!1,this._terminal.element&&this._terminal.element.classList.remove("enable-mouse-events"),this._terminal.selectionManager&&this._terminal.selectionManager.enable();break;case 1004:this._terminal.sendFocus=!1;break;case 1005:this._terminal.utfMouse=!1;break;case 1006:this._terminal.sgrMouse=!1;break;case 1015:this._terminal.urxvtMouse=!1;break;case 25:this._terminal.cursorHidden=!0;break;case 1048:this.restoreCursor(e);break;case 1049:case 47:case 1047:this._terminal.buffers.activateNormalBuffer(),e[0]===1049&&this.restoreCursor(e),this._terminal.refresh(0,this._terminal.rows-1),this._terminal.viewport&&this._terminal.viewport.syncScrollArea(),this._terminal.showCursor();break;case 2004:this._terminal.bracketedPasteMode=!1;break}}else switch(e[0]){case 4:this._terminal.insertMode=!1;break}},t.prototype.charAttributes=function(e){if(e.length===1&&e[0]===0){this._terminal.curAttrData.fg=M.DEFAULT_ATTR_DATA.fg,this._terminal.curAttrData.bg=M.DEFAULT_ATTR_DATA.bg;return}for(var r=e.length,i,s=this._terminal.curAttrData,a=0;a<r;a++)i=e[a],i>=30&&i<=37?(s.fg&=-50331904,s.fg|=16777216|i-30):i>=40&&i<=47?(s.bg&=-50331904,s.bg|=16777216|i-40):i>=90&&i<=97?(s.fg&=-50331904,s.fg|=16777216|i-90|8):i>=100&&i<=107?(s.bg&=-50331904,s.bg|=16777216|i-100|8):i===0?(s.fg=M.DEFAULT_ATTR_DATA.fg,s.bg=M.DEFAULT_ATTR_DATA.bg):i===1?s.fg|=134217728:i===3?s.bg|=67108864:i===4?s.fg|=268435456:i===5?s.fg|=536870912:i===7?s.fg|=67108864:i===8?s.fg|=1073741824:i===2?s.bg|=134217728:i===22?(s.fg&=-134217729,s.bg&=-134217729):i===23?s.bg&=-67108865:i===24?s.fg&=-268435457:i===25?s.fg&=-536870913:i===27?s.fg&=-67108865:i===28?s.fg&=-1073741825:i===39?(s.fg&=-67108864,s.fg|=M.DEFAULT_ATTR_DATA.fg&16777215):i===49?(s.bg&=-67108864,s.bg|=M.DEFAULT_ATTR_DATA.bg&16777215):i===38?e[a+1]===2?(a+=2,s.fg|=50331648,s.fg&=-16777216,s.fg|=M.AttributeData.fromColorRGB([e[a],e[a+1],e[a+2]]),a+=2):e[a+1]===5&&(a+=2,i=e[a]&255,s.fg&=-50331904,s.fg|=33554432|i):i===48?e[a+1]===2?(a+=2,s.bg|=50331648,s.bg&=-16777216,s.bg|=M.AttributeData.fromColorRGB([e[a],e[a+1],e[a+2]]),a+=2):e[a+1]===5&&(a+=2,i=e[a]&255,s.bg&=-50331904,s.bg|=33554432|i):i===100?(s.fg&=-67108864,s.fg|=M.DEFAULT_ATTR_DATA.fg&16777215,s.bg&=-67108864,s.bg|=M.DEFAULT_ATTR_DATA.bg&16777215):this._terminal.error("Unknown SGR attribute: %d.",i)},t.prototype.deviceStatus=function(e,r){if(r){if(r==="?")switch(e[0]){case 6:var i=this._terminal.buffer.y+1,s=this._terminal.buffer.x+1;this._onData.fire(S.C0.ESC+"[?"+i+";"+s+"R");break}}else switch(e[0]){case 5:this._onData.fire(S.C0.ESC+"[0n");break;case 6:var i=this._terminal.buffer.y+1,s=this._terminal.buffer.x+1;this._onData.fire(S.C0.ESC+"["+i+";"+s+"R");break}},t.prototype.softReset=function(e,r){r==="!"&&(this._terminal.cursorHidden=!1,this._terminal.insertMode=!1,this._terminal.originMode=!1,this._terminal.wraparoundMode=!0,this._terminal.applicationKeypad=!1,this._terminal.viewport&&this._terminal.viewport.syncScrollArea(),this._terminal.applicationCursor=!1,this._terminal.buffer.scrollTop=0,this._terminal.buffer.scrollBottom=this._terminal.rows-1,this._terminal.curAttrData=M.DEFAULT_ATTR_DATA.clone(),this._terminal.buffer.x=this._terminal.buffer.y=0,this._terminal.charset=null,this._terminal.glevel=0,this._terminal.charsets=[null])},t.prototype.setCursorStyle=function(e,r){if(r===" "){var i=e[0]<1?1:e[0];switch(i){case 1:case 2:this._terminal.setOption("cursorStyle","block");break;case 3:case 4:this._terminal.setOption("cursorStyle","underline");break;case 5:case 6:this._terminal.setOption("cursorStyle","bar");break}var s=i%2===1;this._terminal.setOption("cursorBlink",s)}},t.prototype.setScrollRegion=function(e,r){r||(this._terminal.buffer.scrollTop=(e[0]||1)-1,this._terminal.buffer.scrollBottom=(e[1]&&e[1]<=this._terminal.rows?e[1]:this._terminal.rows)-1,this._terminal.buffer.x=0,this._terminal.buffer.y=0)},t.prototype.saveCursor=function(e){this._terminal.buffer.savedX=this._terminal.buffer.x,this._terminal.buffer.savedY=this._terminal.buffer.y,this._terminal.buffer.savedCurAttrData.fg=this._terminal.curAttrData.fg,this._terminal.buffer.savedCurAttrData.bg=this._terminal.curAttrData.bg},t.prototype.restoreCursor=function(e){this._terminal.buffer.x=this._terminal.buffer.savedX||0,this._terminal.buffer.y=this._terminal.buffer.savedY||0,this._terminal.curAttrData.fg=this._terminal.buffer.savedCurAttrData.fg,this._terminal.curAttrData.bg=this._terminal.buffer.savedCurAttrData.bg},t.prototype.setTitle=function(e){this._terminal.handleTitle(e)},t.prototype.nextLine=function(){this._terminal.buffer.x=0,this.index()},t.prototype.keypadApplicationMode=function(){this._terminal.log("Serial port requested application keypad."),this._terminal.applicationKeypad=!0,this._terminal.viewport&&this._terminal.viewport.syncScrollArea()},t.prototype.keypadNumericMode=function(){this._terminal.log("Switching back to normal keypad."),this._terminal.applicationKeypad=!1,this._terminal.viewport&&this._terminal.viewport.syncScrollArea()},t.prototype.selectDefaultCharset=function(){this._terminal.setgLevel(0),this._terminal.setgCharset(0,J.DEFAULT_CHARSET)},t.prototype.selectCharset=function(e){if(e.length!==2){this.selectDefaultCharset();return}e[0]!=="/"&&this._terminal.setgCharset(Jn[e[0]],J.CHARSETS[e[1]]||J.DEFAULT_CHARSET)},t.prototype.index=function(){this._terminal.index()},t.prototype.tabSet=function(){this._terminal.tabSet()},t.prototype.reverseIndex=function(){this._terminal.reverseIndex()},t.prototype.reset=function(){this._parser.reset(),this._terminal.reset()},t.prototype.setgLevel=function(e){this._terminal.setgLevel(e)},t}(Yn.Disposable);It.InputHandler=Qn;var Wt={},Ut={},jt={};Object.defineProperty(jt,"__esModule",{value:!0});var es=function(){function n(){this.cache=[]}return n.prototype.resize=function(t,e){for(var r=0;r<t;r++){this.cache.length<=r&&this.cache.push([]);for(var i=this.cache[r].length;i<e;i++)this.cache[r].push(null);this.cache[r].length=e}this.cache.length=t},n.prototype.clear=function(){for(var t=0;t<this.cache.length;t++)for(var e=0;e<this.cache[t].length;e++)this.cache[t][e]=null},n}();jt.GridCache=es;var Ce={},V={};Object.defineProperty(V,"__esModule",{value:!0});V.INVERTED_DEFAULT_COLOR=257;V.DIM_OPACITY=.5;V.CHAR_ATLAS_CELL_SPACING=1;var Te={},oe={};Object.defineProperty(oe,"__esModule",{value:!0});var ts=ge;function rs(n,t,e,r){var i={foreground:r.foreground,background:r.background,cursor:null,cursorAccent:null,selection:null,ansi:r.ansi.slice(0,16)};return{type:e.options.experimentalCharAtlas,devicePixelRatio:window.devicePixelRatio,scaledCharWidth:n,scaledCharHeight:t,fontFamily:e.options.fontFamily,fontSize:e.options.fontSize,fontWeight:e.options.fontWeight,fontWeightBold:e.options.fontWeightBold,allowTransparency:e.options.allowTransparency,colors:i}}oe.generateConfig=rs;function is(n,t){for(var e=0;e<n.colors.ansi.length;e++)if(n.colors.ansi[e].rgba!==t.colors.ansi[e].rgba)return!1;return n.type===t.type&&n.devicePixelRatio===t.devicePixelRatio&&n.fontFamily===t.fontFamily&&n.fontSize===t.fontSize&&n.fontWeight===t.fontWeight&&n.fontWeightBold===t.fontWeightBold&&n.allowTransparency===t.allowTransparency&&n.scaledCharWidth===t.scaledCharWidth&&n.scaledCharHeight===t.scaledCharHeight&&n.colors.foreground===t.colors.foreground&&n.colors.background===t.colors.background}oe.configEquals=is;function ns(n){return n<ts.DEFAULT_COLOR}oe.is256Color=ns;var rt={},ke={};Object.defineProperty(ke,"__esModule",{value:!0});var ss=function(){function n(){this._didWarmUp=!1}return n.prototype.dispose=function(){},n.prototype.warmUp=function(){this._didWarmUp||(this._doWarmUp(),this._didWarmUp=!0)},n.prototype._doWarmUp=function(){},n.prototype.beginFrame=function(){},n}();ke.default=ss;var $t={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=a("#ffffff"),e=a("#000000"),r=a("#ffffff"),i=a("#000000"),s={css:"rgba(255, 255, 255, 0.3)",rgba:4294967159};n.DEFAULT_ANSI_COLORS=function(){for(var l=[a("#2e3436"),a("#cc0000"),a("#4e9a06"),a("#c4a000"),a("#3465a4"),a("#75507b"),a("#06989a"),a("#d3d7cf"),a("#555753"),a("#ef2929"),a("#8ae234"),a("#fce94f"),a("#729fcf"),a("#ad7fa8"),a("#34e2e2"),a("#eeeeec")],u=[0,95,135,175,215,255],h=0;h<216;h++){var f=u[h/36%6|0],_=u[h/6%6|0],d=u[h%6];l.push({css:"#"+c(f)+c(_)+c(d),rgba:(f<<24|_<<16|d<<8|255)>>>0})}for(var h=0;h<24;h++){var p=8+h*10,m=c(p);l.push({css:"#"+m+m+m,rgba:(p<<24|p<<16|p<<8|255)>>>0})}return l}();function a(l){return{css:l,rgba:parseInt(l.slice(1),16)<<8|255}}function c(l){var u=l.toString(16);return u.length<2?"0"+u:u}var o=function(){function l(u,h){this.allowTransparency=h;var f=u.createElement("canvas");f.width=1,f.height=1;var _=f.getContext("2d");if(!_)throw new Error("Could not get rendering context");this._ctx=_,this._ctx.globalCompositeOperation="copy",this._litmusColor=this._ctx.createLinearGradient(0,0,1,1),this.colors={foreground:t,background:e,cursor:r,cursorAccent:i,selection:s,ansi:n.DEFAULT_ANSI_COLORS.slice()}}return l.prototype.setTheme=function(u){u===void 0&&(u={}),this.colors.foreground=this._parseColor(u.foreground,t),this.colors.background=this._parseColor(u.background,e),this.colors.cursor=this._parseColor(u.cursor,r,!0),this.colors.cursorAccent=this._parseColor(u.cursorAccent,i,!0),this.colors.selection=this._parseColor(u.selection,s,!0),this.colors.ansi[0]=this._parseColor(u.black,n.DEFAULT_ANSI_COLORS[0]),this.colors.ansi[1]=this._parseColor(u.red,n.DEFAULT_ANSI_COLORS[1]),this.colors.ansi[2]=this._parseColor(u.green,n.DEFAULT_ANSI_COLORS[2]),this.colors.ansi[3]=this._parseColor(u.yellow,n.DEFAULT_ANSI_COLORS[3]),this.colors.ansi[4]=this._parseColor(u.blue,n.DEFAULT_ANSI_COLORS[4]),this.colors.ansi[5]=this._parseColor(u.magenta,n.DEFAULT_ANSI_COLORS[5]),this.colors.ansi[6]=this._parseColor(u.cyan,n.DEFAULT_ANSI_COLORS[6]),this.colors.ansi[7]=this._parseColor(u.white,n.DEFAULT_ANSI_COLORS[7]),this.colors.ansi[8]=this._parseColor(u.brightBlack,n.DEFAULT_ANSI_COLORS[8]),this.colors.ansi[9]=this._parseColor(u.brightRed,n.DEFAULT_ANSI_COLORS[9]),this.colors.ansi[10]=this._parseColor(u.brightGreen,n.DEFAULT_ANSI_COLORS[10]),this.colors.ansi[11]=this._parseColor(u.brightYellow,n.DEFAULT_ANSI_COLORS[11]),this.colors.ansi[12]=this._parseColor(u.brightBlue,n.DEFAULT_ANSI_COLORS[12]),this.colors.ansi[13]=this._parseColor(u.brightMagenta,n.DEFAULT_ANSI_COLORS[13]),this.colors.ansi[14]=this._parseColor(u.brightCyan,n.DEFAULT_ANSI_COLORS[14]),this.colors.ansi[15]=this._parseColor(u.brightWhite,n.DEFAULT_ANSI_COLORS[15])},l.prototype._parseColor=function(u,h,f){if(f===void 0&&(f=this.allowTransparency),u===void 0)return h;if(this._ctx.fillStyle=this._litmusColor,this._ctx.fillStyle=u,typeof this._ctx.fillStyle!="string")return console.warn("Color: "+u+" is invalid using fallback "+h.css),h;this._ctx.fillRect(0,0,1,1);var _=this._ctx.getImageData(0,0,1,1).data;return!f&&_[3]!==255?(console.warn("Color: "+u+" is using transparency, but allowTransparency is false. "+("Using fallback "+h.css+".")),h):{css:u,rgba:(_[0]<<24|_[1]<<16|_[2]<<8|_[3])>>>0}},l}();n.ColorManager=o})($t);var De={},O={};Object.defineProperty(O,"__esModule",{value:!0});var li=typeof navigator>"u",Ze=li?"node":navigator.userAgent,Me=li?"node":navigator.platform;O.isFirefox=!!~Ze.indexOf("Firefox");O.isSafari=/^((?!chrome|android).)*safari/i.test(Ze);O.isMSIE=!!~Ze.indexOf("MSIE")||!!~Ze.indexOf("Trident");O.isMac=hi(["Macintosh","MacIntel","MacPPC","Mac68K"],Me);O.isIpad=Me==="iPad";O.isIphone=Me==="iPhone";O.isMSWindows=hi(["Windows","Win16","Win32","WinCE"],Me);O.isLinux=Me.indexOf("Linux")>=0;function hi(n,t){return n.indexOf(t)>=0}Object.defineProperty(De,"__esModule",{value:!0});var wr=O,xr=V;function os(n,t,e){var r=e.scaledCharWidth+xr.CHAR_ATLAS_CELL_SPACING,i=e.scaledCharHeight+xr.CHAR_ATLAS_CELL_SPACING,s=t(255*r,(2+16+16)*i),a=s.getContext("2d",{alpha:e.allowTransparency});a.fillStyle=e.colors.background.css,a.fillRect(0,0,s.width,s.height),a.save(),a.fillStyle=e.colors.foreground.css,a.font=Ne(e.fontWeight,e),a.textBaseline="middle";for(var c=0;c<256;c++)a.save(),a.beginPath(),a.rect(c*r,0,r,i),a.clip(),a.fillText(String.fromCharCode(c),c*r,i/2),a.restore();a.save(),a.font=Ne(e.fontWeightBold,e);for(var c=0;c<256;c++)a.save(),a.beginPath(),a.rect(c*r,i,r,i),a.clip(),a.fillText(String.fromCharCode(c),c*r,i*1.5),a.restore();a.restore(),a.font=Ne(e.fontWeight,e);for(var o=0;o<16;o++)for(var l=(o+2)*i,c=0;c<256;c++)a.save(),a.beginPath(),a.rect(c*r,l,r,i),a.clip(),a.fillStyle=e.colors.ansi[o].css,a.fillText(String.fromCharCode(c),c*r,l+i/2),a.restore();a.font=Ne(e.fontWeightBold,e);for(var o=0;o<16;o++)for(var l=(o+2+16)*i,c=0;c<256;c++)a.save(),a.beginPath(),a.rect(c*r,l,r,i),a.clip(),a.fillStyle=e.colors.ansi[o].css,a.fillText(String.fromCharCode(c),c*r,l+i/2),a.restore();if(a.restore(),!("createImageBitmap"in n)||wr.isFirefox||wr.isSafari)return s;var u=a.getImageData(0,0,s.width,s.height);return ci(u,e.colors.background),n.createImageBitmap(u)}De.generateStaticCharAtlasTexture=os;function ci(n,t){for(var e=!0,r=t.rgba>>>24,i=t.rgba>>>16&255,s=t.rgba>>>8&255,a=0;a<n.data.length;a+=4)n.data[a]===r&&n.data[a+1]===i&&n.data[a+2]===s?n.data[a+3]=0:e=!1;return e}De.clearColor=ci;function Ne(n,t){return n+" "+t.fontSize*t.devicePixelRatio+"px "+t.fontFamily}var Kt={};Object.defineProperty(Kt,"__esModule",{value:!0});var as=function(){function n(t){this.capacity=t,this._map={},this._head=null,this._tail=null,this._nodePool=[],this.size=0}return n.prototype._unlinkNode=function(t){var e=t.prev,r=t.next;t===this._head&&(this._head=r),t===this._tail&&(this._tail=e),e!==null&&(e.next=r),r!==null&&(r.prev=e)},n.prototype._appendNode=function(t){var e=this._tail;e!==null&&(e.next=t),t.prev=e,t.next=null,this._tail=t,this._head===null&&(this._head=t)},n.prototype.prealloc=function(t){for(var e=this._nodePool,r=0;r<t;r++)e.push({prev:null,next:null,key:null,value:null})},n.prototype.get=function(t){var e=this._map[t];return e!==void 0?(this._unlinkNode(e),this._appendNode(e),e.value):null},n.prototype.peekValue=function(t){var e=this._map[t];return e!==void 0?e.value:null},n.prototype.peek=function(){var t=this._head;return t===null?null:t.value},n.prototype.set=function(t,e){var r=this._map[t];if(r!==void 0)r=this._map[t],this._unlinkNode(r),r.value=e;else if(this.size>=this.capacity)r=this._head,this._unlinkNode(r),delete this._map[r.key],r.key=t,r.value=e,this._map[t]=r;else{var i=this._nodePool;i.length>0?(r=i.pop(),r.key=t,r.value=e):r={prev:null,next:null,key:t,value:e},this._map[t]=r,this.size++}this._appendNode(r)},n}();Kt.default=as;var ls=C&&C.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(t,e)};return function(t,e){n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(rt,"__esModule",{value:!0});var ht=V,hs=ke,cs=$t,us=De,fs=Kt,Sr=O,Er=1024,Ar=1024,_s={css:"rgba(0, 0, 0, 0)",rgba:0},ds=100,ps=100;function ui(n){return n.code<<21|n.bg<<12|n.fg<<3|(n.bold?0:4)+(n.dim?0:2)+(n.italic?0:1)}rt.getGlyphCacheKey=ui;var ms=function(n){ls(t,n);function t(e,r){var i=n.call(this)||this;i._config=r,i._drawToCacheCount=0,i._glyphsWaitingOnBitmap=[],i._bitmapCommitTimeout=null,i._bitmap=null,i._cacheCanvas=e.createElement("canvas"),i._cacheCanvas.width=Er,i._cacheCanvas.height=Ar,i._cacheCtx=i._cacheCanvas.getContext("2d",{alpha:!0});var s=e.createElement("canvas");s.width=i._config.scaledCharWidth,s.height=i._config.scaledCharHeight,i._tmpCtx=s.getContext("2d",{alpha:i._config.allowTransparency}),i._width=Math.floor(Er/i._config.scaledCharWidth),i._height=Math.floor(Ar/i._config.scaledCharHeight);var a=i._width*i._height;return i._cacheMap=new fs.default(a),i._cacheMap.prealloc(a),i}return t.prototype.dispose=function(){this._bitmapCommitTimeout!==null&&(window.clearTimeout(this._bitmapCommitTimeout),this._bitmapCommitTimeout=null)},t.prototype.beginFrame=function(){this._drawToCacheCount=0},t.prototype.draw=function(e,r,i,s){if(r.code===32)return!0;if(!this._canCache(r))return!1;var a=ui(r),c=this._cacheMap.get(a);if(c!=null)return this._drawFromCache(e,c,i,s),!0;if(this._drawToCacheCount<ds){var o=void 0;this._cacheMap.size<this._cacheMap.capacity?o=this._cacheMap.size:o=this._cacheMap.peek().index;var l=this._drawToCache(r,o);return this._cacheMap.set(a,l),this._drawFromCache(e,l,i,s),!0}return!1},t.prototype._canCache=function(e){return e.code<256},t.prototype._toCoordinateX=function(e){return e%this._width*this._config.scaledCharWidth},t.prototype._toCoordinateY=function(e){return Math.floor(e/this._width)*this._config.scaledCharHeight},t.prototype._drawFromCache=function(e,r,i,s){if(!r.isEmpty){var a=this._toCoordinateX(r.index),c=this._toCoordinateY(r.index);e.drawImage(r.inBitmap?this._bitmap:this._cacheCanvas,a,c,this._config.scaledCharWidth,this._config.scaledCharHeight,i,s,this._config.scaledCharWidth,this._config.scaledCharHeight)}},t.prototype._getColorFromAnsiIndex=function(e){return e<this._config.colors.ansi.length?this._config.colors.ansi[e]:cs.DEFAULT_ANSI_COLORS[e]},t.prototype._getBackgroundColor=function(e){return this._config.allowTransparency?_s:e.bg===ht.INVERTED_DEFAULT_COLOR?this._config.colors.foreground:e.bg<256?this._getColorFromAnsiIndex(e.bg):this._config.colors.background},t.prototype._getForegroundColor=function(e){return e.fg===ht.INVERTED_DEFAULT_COLOR?this._config.colors.background:e.fg<256?this._getColorFromAnsiIndex(e.fg):this._config.colors.foreground},t.prototype._drawToCache=function(e,r){this._drawToCacheCount++,this._tmpCtx.save();var i=this._getBackgroundColor(e);this._tmpCtx.globalCompositeOperation="copy",this._tmpCtx.fillStyle=i.css,this._tmpCtx.fillRect(0,0,this._config.scaledCharWidth,this._config.scaledCharHeight),this._tmpCtx.globalCompositeOperation="source-over";var s=e.bold?this._config.fontWeightBold:this._config.fontWeight,a=e.italic?"italic":"";this._tmpCtx.font=a+" "+s+" "+this._config.fontSize*this._config.devicePixelRatio+"px "+this._config.fontFamily,this._tmpCtx.textBaseline="middle",this._tmpCtx.fillStyle=this._getForegroundColor(e).css,e.dim&&(this._tmpCtx.globalAlpha=ht.DIM_OPACITY),this._tmpCtx.fillText(e.chars,0,this._config.scaledCharHeight/2),this._tmpCtx.restore();var c=this._tmpCtx.getImageData(0,0,this._config.scaledCharWidth,this._config.scaledCharHeight),o=!1;this._config.allowTransparency||(o=us.clearColor(c,i));var l=this._toCoordinateX(r),u=this._toCoordinateY(r);this._cacheCtx.putImageData(c,l,u);var h={index:r,isEmpty:o,inBitmap:!1};return this._addGlyphToBitmap(h),h},t.prototype._addGlyphToBitmap=function(e){var r=this;!("createImageBitmap"in window)||Sr.isFirefox||Sr.isSafari||(this._glyphsWaitingOnBitmap.push(e),this._bitmapCommitTimeout===null&&(this._bitmapCommitTimeout=window.setTimeout(function(){return r._generateBitmap()},ps)))},t.prototype._generateBitmap=function(){var e=this,r=this._glyphsWaitingOnBitmap;this._glyphsWaitingOnBitmap=[],window.createImageBitmap(this._cacheCanvas).then(function(i){e._bitmap=i;for(var s=0;s<r.length;s++){var a=r[s];a.inBitmap=!0}}),this._bitmapCommitTimeout=null},t}(hs.default);rt.default=ms;var zt={},ys=C&&C.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(t,e)};return function(t,e){n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(zt,"__esModule",{value:!0});var gs=ke,vs=function(n){ys(t,n);function t(e,r){return n.call(this)||this}return t.prototype.draw=function(e,r,i,s){return!1},t}(gs.default);zt.default=vs;var qt={},Cs=C&&C.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(t,e)};return function(t,e){n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(qt,"__esModule",{value:!0});var ct=V,bs=De,ws=ke,xs=oe,ut=ge,Ss=function(n){Cs(t,n);function t(e,r){var i=n.call(this)||this;return i._document=e,i._config=r,i._canvasFactory=function(s,a){var c=i._document.createElement("canvas");return c.width=s,c.height=a,c},i}return t.prototype._doWarmUp=function(){var e=this,r=bs.generateStaticCharAtlasTexture(window,this._canvasFactory,this._config);r instanceof HTMLCanvasElement?this._texture=r:r.then(function(i){e._texture=i})},t.prototype._isCached=function(e,r){var i=e.code<256,s=e.fg<16,a=e.fg===ut.DEFAULT_COLOR,c=e.bg===ut.DEFAULT_COLOR;return i&&(s||a)&&c&&!e.italic},t.prototype.draw=function(e,r,i,s){if(this._texture===null||this._texture===void 0)return!1;var a=0;if(xs.is256Color(r.fg)?a=2+r.fg+(r.bold?16:0):r.fg===ut.DEFAULT_COLOR&&r.bold&&(a=1),!this._isCached(r,a))return!1;e.save();var c=this._config.scaledCharWidth+ct.CHAR_ATLAS_CELL_SPACING,o=this._config.scaledCharHeight+ct.CHAR_ATLAS_CELL_SPACING;return r.dim&&(e.globalAlpha=ct.DIM_OPACITY),e.drawImage(this._texture,r.code*c,a*o,c,this._config.scaledCharHeight,i,s,c,this._config.scaledCharHeight),e.restore(),!0},t}(ws.default);qt.default=Ss;Object.defineProperty(Te,"__esModule",{value:!0});var ft=oe,Es=rt,As=zt,Ls=qt,Rs={none:As.default,static:Ls.default,dynamic:Es.default},U=[];function Ts(n,t,e,r){for(var i=ft.generateConfig(e,r,n,t),s=0;s<U.length;s++){var a=U[s],c=a.ownedBy.indexOf(n);if(c>=0){if(ft.configEquals(a.config,i))return a.atlas;a.ownedBy.length===1?(a.atlas.dispose(),U.splice(s,1)):a.ownedBy.splice(c,1);break}}for(var s=0;s<U.length;s++){var a=U[s];if(ft.configEquals(a.config,i))return a.ownedBy.push(n),a.atlas}var o={atlas:new Rs[n.options.experimentalCharAtlas](document,i),config:i,ownedBy:[n]};return U.push(o),o.atlas}Te.acquireCharAtlas=Ts;function ks(n){for(var t=0;t<U.length;t++){var e=U[t].ownedBy.indexOf(n);if(e!==-1){U[t].ownedBy.length===1?(U[t].atlas.dispose(),U.splice(t,1)):U[t].ownedBy.splice(e,1);break}}}Te.removeTerminalFromCache=ks;Object.defineProperty(Ce,"__esModule",{value:!0});var Lr=ge,We=V,Ds=Te,Ue=q,Ms=function(){function n(t,e,r,i,s){this._container=t,this._alpha=i,this._colors=s,this._scaledCharWidth=0,this._scaledCharHeight=0,this._scaledCellWidth=0,this._scaledCellHeight=0,this._scaledCharLeft=0,this._scaledCharTop=0,this._currentGlyphIdentifier={chars:"",code:0,bg:0,fg:0,bold:!1,dim:!1,italic:!1},this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-"+e+"-layer"),this._canvas.style.zIndex=r.toString(),this._initCanvas(),this._container.appendChild(this._canvas)}return n.prototype.dispose=function(){this._container.removeChild(this._canvas),this._charAtlas&&this._charAtlas.dispose()},n.prototype._initCanvas=function(){this._ctx=this._canvas.getContext("2d",{alpha:this._alpha}),this._alpha||this.clearAll()},n.prototype.onOptionsChanged=function(t){},n.prototype.onBlur=function(t){},n.prototype.onFocus=function(t){},n.prototype.onCursorMove=function(t){},n.prototype.onGridChanged=function(t,e,r){},n.prototype.onSelectionChanged=function(t,e,r,i){},n.prototype.setColors=function(t,e){this._refreshCharAtlas(t,e)},n.prototype.setTransparency=function(t,e){if(e!==this._alpha){var r=this._canvas;this._alpha=e,this._canvas=this._canvas.cloneNode(),this._initCanvas(),this._container.replaceChild(this._canvas,r),this._refreshCharAtlas(t,this._colors),this.onGridChanged(t,0,t.rows-1)}},n.prototype._refreshCharAtlas=function(t,e){this._scaledCharWidth<=0&&this._scaledCharHeight<=0||(this._charAtlas=Ds.acquireCharAtlas(t,e,this._scaledCharWidth,this._scaledCharHeight),this._charAtlas.warmUp())},n.prototype.resize=function(t,e){this._scaledCellWidth=e.scaledCellWidth,this._scaledCellHeight=e.scaledCellHeight,this._scaledCharWidth=e.scaledCharWidth,this._scaledCharHeight=e.scaledCharHeight,this._scaledCharLeft=e.scaledCharLeft,this._scaledCharTop=e.scaledCharTop,this._canvas.width=e.scaledCanvasWidth,this._canvas.height=e.scaledCanvasHeight,this._canvas.style.width=e.canvasWidth+"px",this._canvas.style.height=e.canvasHeight+"px",this._alpha||this.clearAll(),this._refreshCharAtlas(t,this._colors)},n.prototype.fillCells=function(t,e,r,i){this._ctx.fillRect(t*this._scaledCellWidth,e*this._scaledCellHeight,r*this._scaledCellWidth,i*this._scaledCellHeight)},n.prototype.fillBottomLineAtCells=function(t,e,r){r===void 0&&(r=1),this._ctx.fillRect(t*this._scaledCellWidth,(e+1)*this._scaledCellHeight-window.devicePixelRatio-1,r*this._scaledCellWidth,window.devicePixelRatio)},n.prototype.fillLeftLineAtCell=function(t,e){this._ctx.fillRect(t*this._scaledCellWidth,e*this._scaledCellHeight,window.devicePixelRatio,this._scaledCellHeight)},n.prototype.strokeRectAtCell=function(t,e,r,i){this._ctx.lineWidth=window.devicePixelRatio,this._ctx.strokeRect(t*this._scaledCellWidth+window.devicePixelRatio/2,e*this._scaledCellHeight+window.devicePixelRatio/2,r*this._scaledCellWidth-window.devicePixelRatio,i*this._scaledCellHeight-window.devicePixelRatio)},n.prototype.clearAll=function(){this._alpha?this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height):(this._ctx.fillStyle=this._colors.background.css,this._ctx.fillRect(0,0,this._canvas.width,this._canvas.height))},n.prototype.clearCells=function(t,e,r,i){this._alpha?this._ctx.clearRect(t*this._scaledCellWidth,e*this._scaledCellHeight,r*this._scaledCellWidth,i*this._scaledCellHeight):(this._ctx.fillStyle=this._colors.background.css,this._ctx.fillRect(t*this._scaledCellWidth,e*this._scaledCellHeight,r*this._scaledCellWidth,i*this._scaledCellHeight))},n.prototype.fillCharTrueColor=function(t,e,r,i){this._ctx.font=this._getFont(t,!1,!1),this._ctx.textBaseline="middle",this._clipRow(t,i),this._ctx.fillText(e.getChars(),r*this._scaledCellWidth+this._scaledCharLeft,i*this._scaledCellHeight+this._scaledCharTop+this._scaledCharHeight/2)},n.prototype.drawChars=function(t,e,r,i){if(e.isFgRGB()||e.isBgRGB()){this._drawUncachedChars(t,e,r,i);return}var s,a;e.isInverse()?(s=e.isBgDefault()?We.INVERTED_DEFAULT_COLOR:e.getBgColor(),a=e.isFgDefault()?We.INVERTED_DEFAULT_COLOR:e.getFgColor()):(a=e.isBgDefault()?Lr.DEFAULT_COLOR:e.getBgColor(),s=e.isFgDefault()?Lr.DEFAULT_COLOR:e.getFgColor());var c=t.options.drawBoldTextInBrightColors&&e.isBold()&&s<8&&s!==We.INVERTED_DEFAULT_COLOR;s+=c?8:0,this._currentGlyphIdentifier.chars=e.getChars()||Ue.WHITESPACE_CELL_CHAR,this._currentGlyphIdentifier.code=e.getCode()||Ue.WHITESPACE_CELL_CODE,this._currentGlyphIdentifier.bg=a,this._currentGlyphIdentifier.fg=s,this._currentGlyphIdentifier.bold=e.isBold()&&t.options.enableBold,this._currentGlyphIdentifier.dim=!!e.isDim(),this._currentGlyphIdentifier.italic=!!e.isItalic();var o=this._charAtlas&&this._charAtlas.draw(this._ctx,this._currentGlyphIdentifier,r*this._scaledCellWidth+this._scaledCharLeft,i*this._scaledCellHeight+this._scaledCharTop);o||this._drawUncachedChars(t,e,r,i)},n.prototype._drawUncachedChars=function(t,e,r,i){if(this._ctx.save(),this._ctx.font=this._getFont(t,e.isBold()&&t.options.enableBold,!!e.isItalic()),this._ctx.textBaseline="middle",e.isInverse())e.isBgDefault()?this._ctx.fillStyle=this._colors.background.css:e.isBgRGB()?this._ctx.fillStyle="rgb("+Ue.AttributeData.toColorRGB(e.getBgColor()).join(",")+")":this._ctx.fillStyle=this._colors.ansi[e.getBgColor()].css;else if(e.isFgDefault())this._ctx.fillStyle=this._colors.foreground.css;else if(e.isFgRGB())this._ctx.fillStyle="rgb("+Ue.AttributeData.toColorRGB(e.getFgColor()).join(",")+")";else{var s=e.getFgColor();t.options.drawBoldTextInBrightColors&&e.isBold()&&s<8&&(s+=8),this._ctx.fillStyle=this._colors.ansi[s].css}this._clipRow(t,i),e.isDim()&&(this._ctx.globalAlpha=We.DIM_OPACITY),this._ctx.fillText(e.getChars(),r*this._scaledCellWidth+this._scaledCharLeft,i*this._scaledCellHeight+this._scaledCharTop+this._scaledCharHeight/2),this._ctx.restore()},n.prototype._clipRow=function(t,e){this._ctx.beginPath(),this._ctx.rect(0,e*this._scaledCellHeight,t.cols*this._scaledCellWidth,this._scaledCellHeight),this._ctx.clip()},n.prototype._getFont=function(t,e,r){var i=e?t.options.fontWeightBold:t.options.fontWeight,s=r?"italic":"";return s+" "+i+" "+t.options.fontSize*window.devicePixelRatio+"px "+t.options.fontFamily},n}();Ce.BaseRenderLayer=Ms;var Be={},Bs=C&&C.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(t,e)};return function(t,e){n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Be,"__esModule",{value:!0});var Je=q,Os=function(n){Bs(t,n);function t(e,r,i){var s=n.call(this)||this;return s.content=0,s.combinedData="",s.fg=e.fg,s.bg=e.bg,s.combinedData=r,s._width=i,s}return t.prototype.isCombined=function(){return 2097152},t.prototype.getWidth=function(){return this._width},t.prototype.getChars=function(){return this.combinedData},t.prototype.getCode=function(){return 2097151},t.prototype.setFromCharData=function(e){throw new Error("not implemented")},t.prototype.getAsCharData=function(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]},t}(Je.AttributeData);Be.JoinedCellData=Os;var Hs=function(){function n(t){this._terminal=t,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new Je.CellData}return n.prototype.registerCharacterJoiner=function(t){var e={id:this._nextCharacterJoinerId++,handler:t};return this._characterJoiners.push(e),e.id},n.prototype.deregisterCharacterJoiner=function(t){for(var e=0;e<this._characterJoiners.length;e++)if(this._characterJoiners[e].id===t)return this._characterJoiners.splice(e,1),!0;return!1},n.prototype.getJoinedCharacters=function(t){if(this._characterJoiners.length===0)return[];var e=this._terminal.buffer.lines.get(t);if(e.length===0)return[];for(var r=[],i=e.translateToString(!0),s=0,a=0,c=0,o=e.getFg(0),l=e.getBg(0),u=0;u<e.getTrimmedLength();u++)if(e.loadCell(u,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==o||this._workCell.bg!==l){if(u-s>1)for(var h=this._getJoinedRanges(i,c,a,e,s),f=0;f<h.length;f++)r.push(h[f]);s=u,c=a,o=this._workCell.fg,l=this._workCell.bg}a+=this._workCell.getChars().length||Je.WHITESPACE_CELL_CHAR.length}if(this._terminal.cols-s>1)for(var h=this._getJoinedRanges(i,c,a,e,s),f=0;f<h.length;f++)r.push(h[f]);return r},n.prototype._getJoinedRanges=function(t,e,r,i,s){for(var a=t.substring(e,r),c=this._characterJoiners[0].handler(a),o=1;o<this._characterJoiners.length;o++)for(var l=this._characterJoiners[o].handler(a),u=0;u<l.length;u++)n._mergeRanges(c,l[u]);return this._stringRangesToCellRanges(c,i,s),c},n.prototype._stringRangesToCellRanges=function(t,e,r){var i=0,s=!1,a=0,c=t[i];if(c){for(var o=r;o<this._terminal.cols;o++){var l=e.getWidth(o),u=e.getString(o).length||Je.WHITESPACE_CELL_CHAR.length;if(l!==0){if(!s&&c[0]<=a&&(c[0]=o,s=!0),c[1]<=a){if(c[1]=o,c=t[++i],!c)break;c[0]<=a?(c[0]=o,s=!0):s=!1}a+=u}}c&&(c[1]=this._terminal.cols)}},n._mergeRanges=function(t,e){for(var r=!1,i=0;i<t.length;i++){var s=t[i];if(r){if(e[1]<=s[0])return t[i-1][1]=e[1],t;if(e[1]<=s[1])return t[i-1][1]=Math.max(e[1],s[1]),t.splice(i,1),r=!1,t;t.splice(i,1),i--}else{if(e[1]<=s[0])return t.splice(i,0,e),t;if(e[1]<=s[1])return s[0]=Math.min(e[0],s[0]),t;e[0]<s[1]&&(s[0]=Math.min(e[0],s[0]),r=!0);continue}}return r?t[t.length-1][1]=e[1]:t.push(e),t},n}();Be.CharacterJoinerRegistry=Hs;var Fs=C&&C.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(t,e)};return function(t,e){n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Ut,"__esModule",{value:!0});var Ps=jt,Is=Ce,_e=q,Ns=Be,Ws=function(n){Fs(t,n);function t(e,r,i,s,a){var c=n.call(this,e,"text",r,a,i)||this;return c._characterOverlapCache={},c._workCell=new _e.CellData,c._state=new Ps.GridCache,c._characterJoinerRegistry=s,c}return t.prototype.resize=function(e,r){n.prototype.resize.call(this,e,r);var i=this._getFont(e,!1,!1);(this._characterWidth!==r.scaledCharWidth||this._characterFont!==i)&&(this._characterWidth=r.scaledCharWidth,this._characterFont=i,this._characterOverlapCache={}),this._state.clear(),this._state.resize(e.cols,e.rows)},t.prototype.reset=function(e){this._state.clear(),this.clearAll()},t.prototype._forEachCell=function(e,r,i,s,a){for(var c=r;c<=i;c++)for(var o=c+e.buffer.ydisp,l=e.buffer.lines.get(o),u=s?s.getJoinedCharacters(o):[],h=0;h<e.cols;h++){l.loadCell(h,this._workCell);var f=this._workCell,_=!1,d=h;if(f.getWidth()!==0){if(u.length>0&&h===u[0][0]){_=!0;var p=u.shift();f=new Ns.JoinedCellData(this._workCell,l.translateToString(!0,p[0],p[1]),p[1]-p[0]),d=p[1]-1}!_&&this._isOverlapping(f)&&d<l.length-1&&l.getCodePoint(d+1)===_e.NULL_CELL_CODE&&(f.content&=-12582913,f.content|=2<<22),a(f,h,c),h=d}}},t.prototype._drawBackground=function(e,r,i){var s=this,a=this._ctx,c=e.cols,o=0,l=0,u=null;a.save(),this._forEachCell(e,r,i,null,function(h,f,_){var d=null;h.isInverse()?h.isFgDefault()?d=s._colors.foreground.css:h.isFgRGB()?d="rgb("+_e.AttributeData.toColorRGB(h.getFgColor()).join(",")+")":d=s._colors.ansi[h.getFgColor()].css:h.isBgRGB()?d="rgb("+_e.AttributeData.toColorRGB(h.getBgColor()).join(",")+")":h.isBgPalette()&&(d=s._colors.ansi[h.getBgColor()].css),u===null&&(o=f,l=_),_!==l?(a.fillStyle=u,s.fillCells(o,l,c-o,1),o=f,l=_):u!==d&&(a.fillStyle=u,s.fillCells(o,l,f-o,1),o=f,l=_),u=d}),u!==null&&(a.fillStyle=u,this.fillCells(o,l,c-o,1)),a.restore()},t.prototype._drawForeground=function(e,r,i){var s=this;this._forEachCell(e,r,i,this._characterJoinerRegistry,function(a,c,o){if(!a.isInvisible()&&(s.drawChars(e,a,c,o),a.isUnderline())){if(s._ctx.save(),a.isInverse())a.isBgDefault()?s._ctx.fillStyle=s._colors.background.css:a.isBgRGB()?s._ctx.fillStyle="rgb("+_e.AttributeData.toColorRGB(a.getBgColor()).join(",")+")":s._ctx.fillStyle=s._colors.ansi[a.getBgColor()].css;else if(a.isFgDefault())s._ctx.fillStyle=s._colors.foreground.css;else if(a.isFgRGB())s._ctx.fillStyle="rgb("+_e.AttributeData.toColorRGB(a.getFgColor()).join(",")+")";else{var l=a.getFgColor();e.options.drawBoldTextInBrightColors&&a.isBold()&&l<8&&(l+=8),s._ctx.fillStyle=s._colors.ansi[l].css}s.fillBottomLineAtCells(c,o,a.getWidth()),s._ctx.restore()}})},t.prototype.onGridChanged=function(e,r,i){this._state.cache.length!==0&&(this._charAtlas&&this._charAtlas.beginFrame(),this.clearCells(0,r,e.cols,i-r+1),this._drawBackground(e,r,i),this._drawForeground(e,r,i))},t.prototype.onOptionsChanged=function(e){this.setTransparency(e,e.options.allowTransparency)},t.prototype._isOverlapping=function(e){if(e.getWidth()!==1||e.getCode()<256)return!1;var r=e.getChars();if(this._characterOverlapCache.hasOwnProperty(r))return this._characterOverlapCache[r];this._ctx.save(),this._ctx.font=this._characterFont;var i=Math.floor(this._ctx.measureText(r).width)>this._characterWidth;return this._ctx.restore(),this._characterOverlapCache[r]=i,i},t}(Is.BaseRenderLayer);Ut.TextRenderLayer=Ws;var Vt={},Us=C&&C.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(t,e)};return function(t,e){n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Vt,"__esModule",{value:!0});var js=Ce,$s=function(n){Us(t,n);function t(e,r,i){var s=n.call(this,e,"selection",r,!0,i)||this;return s._clearState(),s}return t.prototype._clearState=function(){this._state={start:null,end:null,columnSelectMode:null,ydisp:null}},t.prototype.resize=function(e,r){n.prototype.resize.call(this,e,r),this._clearState()},t.prototype.reset=function(e){this._state.start&&this._state.end&&(this._clearState(),this.clearAll())},t.prototype.onSelectionChanged=function(e,r,i,s){if(this._didStateChange(r,i,s,e.buffer.ydisp)){if(this.clearAll(),!r||!i){this._clearState();return}var a=r[1]-e.buffer.ydisp,c=i[1]-e.buffer.ydisp,o=Math.max(a,0),l=Math.min(c,e.rows-1);if(!(o>=e.rows||l<0)){if(this._ctx.fillStyle=this._colors.selection.css,s){var u=r[0],h=i[0]-u,f=l-o+1;this.fillCells(u,o,h,f)}else{var u=a===o?r[0]:0,_=o===l?i[0]:e.cols;this.fillCells(u,o,_-u,1);var d=Math.max(l-o-1,0);if(this.fillCells(0,o+1,e.cols,d),o!==l){var p=c===l?i[0]:e.cols;this.fillCells(0,l,p,1)}}this._state.start=[r[0],r[1]],this._state.end=[i[0],i[1]],this._state.columnSelectMode=s,this._state.ydisp=e.buffer.ydisp}}},t.prototype._didStateChange=function(e,r,i,s){return!this._areCoordinatesEqual(e,this._state.start)||!this._areCoordinatesEqual(r,this._state.end)||i!==this._state.columnSelectMode||s!==this._state.ydisp},t.prototype._areCoordinatesEqual=function(e,r){return!e||!r?!1:e[0]===r[0]&&e[1]===r[1]},t}(js.BaseRenderLayer);Vt.SelectionRenderLayer=$s;var Gt={},Ks=C&&C.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(t,e)};return function(t,e){n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Gt,"__esModule",{value:!0});var zs=Ce,qs=q,je=600,Vs=function(n){Ks(t,n);function t(e,r,i){var s=n.call(this,e,"cursor",r,!0,i)||this;return s._cell=new qs.CellData,s._state={x:null,y:null,isFocused:null,style:null,width:null},s._cursorRenderers={bar:s._renderBarCursor.bind(s),block:s._renderBlockCursor.bind(s),underline:s._renderUnderlineCursor.bind(s)},s}return t.prototype.resize=function(e,r){n.prototype.resize.call(this,e,r),this._state={x:null,y:null,isFocused:null,style:null,width:null}},t.prototype.reset=function(e){this._clearCursor(),this._cursorBlinkStateManager&&(this._cursorBlinkStateManager.dispose(),this._cursorBlinkStateManager=null,this.onOptionsChanged(e))},t.prototype.onBlur=function(e){this._cursorBlinkStateManager&&this._cursorBlinkStateManager.pause(),e.refresh(e.buffer.y,e.buffer.y)},t.prototype.onFocus=function(e){this._cursorBlinkStateManager?this._cursorBlinkStateManager.resume(e):e.refresh(e.buffer.y,e.buffer.y)},t.prototype.onOptionsChanged=function(e){var r=this;e.options.cursorBlink?this._cursorBlinkStateManager||(this._cursorBlinkStateManager=new Gs(e,function(){r._render(e,!0)})):(this._cursorBlinkStateManager&&(this._cursorBlinkStateManager.dispose(),this._cursorBlinkStateManager=null),e.refresh(e.buffer.y,e.buffer.y))},t.prototype.onCursorMove=function(e){this._cursorBlinkStateManager&&this._cursorBlinkStateManager.restartBlinkAnimation(e)},t.prototype.onGridChanged=function(e,r,i){!this._cursorBlinkStateManager||this._cursorBlinkStateManager.isPaused?this._render(e,!1):this._cursorBlinkStateManager.restartBlinkAnimation(e)},t.prototype._render=function(e,r){if(!e.cursorState||e.cursorHidden){this._clearCursor();return}var i=e.buffer.ybase+e.buffer.y,s=i-e.buffer.ydisp;if(s<0||s>=e.rows){this._clearCursor();return}if(e.buffer.lines.get(i).loadCell(e.buffer.x,this._cell),this._cell.content!==void 0){if(!e.isFocused){this._clearCursor(),this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this._renderBlurCursor(e,e.buffer.x,s,this._cell),this._ctx.restore(),this._state.x=e.buffer.x,this._state.y=s,this._state.isFocused=!1,this._state.style=e.options.cursorStyle,this._state.width=this._cell.getWidth();return}if(this._cursorBlinkStateManager&&!this._cursorBlinkStateManager.isCursorVisible){this._clearCursor();return}if(this._state){if(this._state.x===e.buffer.x&&this._state.y===s&&this._state.isFocused===e.isFocused&&this._state.style===e.options.cursorStyle&&this._state.width===this._cell.getWidth())return;this._clearCursor()}this._ctx.save(),this._cursorRenderers[e.options.cursorStyle||"block"](e,e.buffer.x,s,this._cell),this._ctx.restore(),this._state.x=e.buffer.x,this._state.y=s,this._state.isFocused=!1,this._state.style=e.options.cursorStyle,this._state.width=this._cell.getWidth()}},t.prototype._clearCursor=function(){this._state&&(this.clearCells(this._state.x,this._state.y,this._state.width,1),this._state={x:null,y:null,isFocused:null,style:null,width:null})},t.prototype._renderBarCursor=function(e,r,i,s){this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this.fillLeftLineAtCell(r,i),this._ctx.restore()},t.prototype._renderBlockCursor=function(e,r,i,s){this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this.fillCells(r,i,s.getWidth(),1),this._ctx.fillStyle=this._colors.cursorAccent.css,this.fillCharTrueColor(e,s,r,i),this._ctx.restore()},t.prototype._renderUnderlineCursor=function(e,r,i,s){this._ctx.save(),this._ctx.fillStyle=this._colors.cursor.css,this.fillBottomLineAtCells(r,i),this._ctx.restore()},t.prototype._renderBlurCursor=function(e,r,i,s){this._ctx.save(),this._ctx.strokeStyle=this._colors.cursor.css,this.strokeRectAtCell(r,i,s.getWidth(),1),this._ctx.restore()},t}(zs.BaseRenderLayer);Gt.CursorRenderLayer=Vs;var Gs=function(){function n(t,e){this._renderCallback=e,this.isCursorVisible=!0,t.isFocused&&this._restartInterval()}return Object.defineProperty(n.prototype,"isPaused",{get:function(){return!(this._blinkStartTimeout||this._blinkInterval)},enumerable:!0,configurable:!0}),n.prototype.dispose=function(){this._blinkInterval&&(window.clearInterval(this._blinkInterval),this._blinkInterval=null),this._blinkStartTimeout&&(window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=null),this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=null)},n.prototype.restartBlinkAnimation=function(t){var e=this;this.isPaused||(this._animationTimeRestarted=Date.now(),this.isCursorVisible=!0,this._animationFrame||(this._animationFrame=window.requestAnimationFrame(function(){e._renderCallback(),e._animationFrame=null})))},n.prototype._restartInterval=function(t){var e=this;t===void 0&&(t=je),this._blinkInterval&&window.clearInterval(this._blinkInterval),this._blinkStartTimeout=setTimeout(function(){if(e._animationTimeRestarted){var r=je-(Date.now()-e._animationTimeRestarted);if(e._animationTimeRestarted=null,r>0){e._restartInterval(r);return}}e.isCursorVisible=!1,e._animationFrame=window.requestAnimationFrame(function(){e._renderCallback(),e._animationFrame=null}),e._blinkInterval=setInterval(function(){if(e._animationTimeRestarted){var i=je-(Date.now()-e._animationTimeRestarted);e._animationTimeRestarted=null,e._restartInterval(i);return}e.isCursorVisible=!e.isCursorVisible,e._animationFrame=window.requestAnimationFrame(function(){e._renderCallback(),e._animationFrame=null})},je)},t)},n.prototype.pause=function(){this.isCursorVisible=!0,this._blinkInterval&&(window.clearInterval(this._blinkInterval),this._blinkInterval=null),this._blinkStartTimeout&&(window.clearTimeout(this._blinkStartTimeout),this._blinkStartTimeout=null),this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=null)},n.prototype.resume=function(t){this._animationTimeRestarted=null,this._restartInterval(),this.restartBlinkAnimation(t)},n}(),Yt={},Ys=C&&C.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(t,e)};return function(t,e){n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Yt,"__esModule",{value:!0});var Xs=Ce,Js=V,Zs=oe,Qs=function(n){Ys(t,n);function t(e,r,i,s){var a=n.call(this,e,"link",r,!0,i)||this;return a._state=null,s.linkifier.onLinkHover(function(c){return a._onLinkHover(c)}),s.linkifier.onLinkLeave(function(c){return a._onLinkLeave(c)}),a}return t.prototype.resize=function(e,r){n.prototype.resize.call(this,e,r),this._state=null},t.prototype.reset=function(e){this._clearCurrentLink()},t.prototype._clearCurrentLink=function(){if(this._state){this.clearCells(this._state.x1,this._state.y1,this._state.cols-this._state.x1,1);var e=this._state.y2-this._state.y1-1;e>0&&this.clearCells(0,this._state.y1+1,this._state.cols,e),this.clearCells(0,this._state.y2,this._state.x2,1),this._state=null}},t.prototype._onLinkHover=function(e){if(e.fg===Js.INVERTED_DEFAULT_COLOR?this._ctx.fillStyle=this._colors.background.css:Zs.is256Color(e.fg)?this._ctx.fillStyle=this._colors.ansi[e.fg].css:this._ctx.fillStyle=this._colors.foreground.css,e.y1===e.y2)this.fillBottomLineAtCells(e.x1,e.y1,e.x2-e.x1);else{this.fillBottomLineAtCells(e.x1,e.y1,e.cols-e.x1);for(var r=e.y1+1;r<e.y2;r++)this.fillBottomLineAtCells(0,r,e.cols);this.fillBottomLineAtCells(0,e.y2,e.x2)}this._state=e},t.prototype._onLinkLeave=function(e){this._clearCurrentLink()},t}(Xs.BaseRenderLayer);Yt.LinkRenderLayer=Qs;var eo=C&&C.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(t,e)};return function(t,e){n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Wt,"__esModule",{value:!0});var to=Ut,ro=Vt,io=Gt,no=Yt,so=Be,oo=F,ao=function(n){eo(t,n);function t(e,r){var i=n.call(this)||this;i._terminal=e,i._colors=r;var s=i._terminal.options.allowTransparency;return i._characterJoinerRegistry=new so.CharacterJoinerRegistry(e),i._renderLayers=[new to.TextRenderLayer(i._terminal.screenElement,0,i._colors,i._characterJoinerRegistry,s),new ro.SelectionRenderLayer(i._terminal.screenElement,1,i._colors),new no.LinkRenderLayer(i._terminal.screenElement,2,i._colors,i._terminal),new io.CursorRenderLayer(i._terminal.screenElement,3,i._colors)],i.dimensions={scaledCharWidth:null,scaledCharHeight:null,scaledCellWidth:null,scaledCellHeight:null,scaledCharLeft:null,scaledCharTop:null,scaledCanvasWidth:null,scaledCanvasHeight:null,canvasWidth:null,canvasHeight:null,actualCellWidth:null,actualCellHeight:null},i._devicePixelRatio=window.devicePixelRatio,i._updateDimensions(),i.onOptionsChanged(),i}return t.prototype.dispose=function(){n.prototype.dispose.call(this),this._renderLayers.forEach(function(e){return e.dispose()})},t.prototype.onDevicePixelRatioChange=function(){this._devicePixelRatio!==window.devicePixelRatio&&(this._devicePixelRatio=window.devicePixelRatio,this.onResize(this._terminal.cols,this._terminal.rows))},t.prototype.setColors=function(e){var r=this;this._colors=e,this._renderLayers.forEach(function(i){i.setColors(r._terminal,r._colors),i.reset(r._terminal)})},t.prototype.onResize=function(e,r){var i=this;this._updateDimensions(),this._renderLayers.forEach(function(s){return s.resize(i._terminal,i.dimensions)}),this._terminal.screenElement.style.width=this.dimensions.canvasWidth+"px",this._terminal.screenElement.style.height=this.dimensions.canvasHeight+"px"},t.prototype.onCharSizeChanged=function(){this.onResize(this._terminal.cols,this._terminal.rows)},t.prototype.onBlur=function(){var e=this;this._runOperation(function(r){return r.onBlur(e._terminal)})},t.prototype.onFocus=function(){var e=this;this._runOperation(function(r){return r.onFocus(e._terminal)})},t.prototype.onSelectionChanged=function(e,r,i){var s=this;i===void 0&&(i=!1),this._runOperation(function(a){return a.onSelectionChanged(s._terminal,e,r,i)})},t.prototype.onCursorMove=function(){var e=this;this._runOperation(function(r){return r.onCursorMove(e._terminal)})},t.prototype.onOptionsChanged=function(){var e=this;this._runOperation(function(r){return r.onOptionsChanged(e._terminal)})},t.prototype.clear=function(){var e=this;this._runOperation(function(r){return r.reset(e._terminal)})},t.prototype._runOperation=function(e){this._renderLayers.forEach(function(r){return e(r)})},t.prototype.renderRows=function(e,r){var i=this;this._renderLayers.forEach(function(s){return s.onGridChanged(i._terminal,e,r)})},t.prototype._updateDimensions=function(){!this._terminal.charMeasure.width||!this._terminal.charMeasure.height||(this.dimensions.scaledCharWidth=Math.floor(this._terminal.charMeasure.width*window.devicePixelRatio),this.dimensions.scaledCharHeight=Math.ceil(this._terminal.charMeasure.height*window.devicePixelRatio),this.dimensions.scaledCellHeight=Math.floor(this.dimensions.scaledCharHeight*this._terminal.options.lineHeight),this.dimensions.scaledCharTop=this._terminal.options.lineHeight===1?0:Math.round((this.dimensions.scaledCellHeight-this.dimensions.scaledCharHeight)/2),this.dimensions.scaledCellWidth=this.dimensions.scaledCharWidth+Math.round(this._terminal.options.letterSpacing),this.dimensions.scaledCharLeft=Math.floor(this._terminal.options.letterSpacing/2),this.dimensions.scaledCanvasHeight=this._terminal.rows*this.dimensions.scaledCellHeight,this.dimensions.scaledCanvasWidth=this._terminal.cols*this.dimensions.scaledCellWidth,this.dimensions.canvasHeight=Math.round(this.dimensions.scaledCanvasHeight/window.devicePixelRatio),this.dimensions.canvasWidth=Math.round(this.dimensions.scaledCanvasWidth/window.devicePixelRatio),this.dimensions.actualCellHeight=this.dimensions.canvasHeight/this._terminal.rows,this.dimensions.actualCellWidth=this.dimensions.canvasWidth/this._terminal.cols)},t.prototype.registerCharacterJoiner=function(e){return this._characterJoinerRegistry.registerCharacterJoiner(e)},t.prototype.deregisterCharacterJoiner=function(e){return this._characterJoinerRegistry.deregisterCharacterJoiner(e)},t}(oo.Disposable);Wt.Renderer=ao;var Xt={},Oe={},lo=C&&C.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(t,e)};return function(t,e){n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(Oe,"__esModule",{value:!0});var ho=F,co=se,uo=500,fo=function(n){lo(t,n);function t(e){var r=n.call(this)||this;return r._terminal=e,r._zones=[],r._areZonesActive=!1,r._tooltipTimeout=null,r._currentZone=null,r._lastHoverCoords=[null,null],r.register(co.addDisposableDomListener(r._terminal.element,"mousedown",function(i){return r._onMouseDown(i)})),r._mouseMoveListener=function(i){return r._onMouseMove(i)},r._mouseLeaveListener=function(i){return r._onMouseLeave(i)},r._clickListener=function(i){return r._onClick(i)},r}return t.prototype.dispose=function(){n.prototype.dispose.call(this),this._deactivate()},t.prototype.add=function(e){this._zones.push(e),this._zones.length===1&&this._activate()},t.prototype.clearAll=function(e,r){if(this._zones.length!==0){r||(e=0,r=this._terminal.rows-1);for(var i=0;i<this._zones.length;i++){var s=this._zones[i];(s.y1>e&&s.y1<=r+1||s.y2>e&&s.y2<=r+1||s.y1<e&&s.y2>r+1)&&(this._currentZone&&this._currentZone===s&&(this._currentZone.leaveCallback(),this._currentZone=null),this._zones.splice(i--,1))}this._zones.length===0&&this._deactivate()}},t.prototype._activate=function(){this._areZonesActive||(this._areZonesActive=!0,this._terminal.element.addEventListener("mousemove",this._mouseMoveListener),this._terminal.element.addEventListener("mouseleave",this._mouseLeaveListener),this._terminal.element.addEventListener("click",this._clickListener))},t.prototype._deactivate=function(){this._areZonesActive&&(this._areZonesActive=!1,this._terminal.element.removeEventListener("mousemove",this._mouseMoveListener),this._terminal.element.removeEventListener("mouseleave",this._mouseLeaveListener),this._terminal.element.removeEventListener("click",this._clickListener))},t.prototype._onMouseMove=function(e){(this._lastHoverCoords[0]!==e.pageX||this._lastHoverCoords[1]!==e.pageY)&&(this._onHover(e),this._lastHoverCoords=[e.pageX,e.pageY])},t.prototype._onHover=function(e){var r=this,i=this._findZoneEventAt(e);i!==this._currentZone&&(this._currentZone&&(this._currentZone.leaveCallback(),this._currentZone=null,this._tooltipTimeout&&clearTimeout(this._tooltipTimeout)),i&&(this._currentZone=i,i.hoverCallback&&i.hoverCallback(e),this._tooltipTimeout=setTimeout(function(){return r._onTooltip(e)},uo)))},t.prototype._onTooltip=function(e){this._tooltipTimeout=null;var r=this._findZoneEventAt(e);r&&r.tooltipCallback&&r.tooltipCallback(e)},t.prototype._onMouseDown=function(e){if(this._initialSelectionLength=this._terminal.getSelection().length,!!this._areZonesActive){var r=this._findZoneEventAt(e);r&&r.willLinkActivate(e)&&(e.preventDefault(),e.stopImmediatePropagation())}},t.prototype._onMouseLeave=function(e){this._currentZone&&(this._currentZone.leaveCallback(),this._currentZone=null,this._tooltipTimeout&&clearTimeout(this._tooltipTimeout))},t.prototype._onClick=function(e){var r=this._findZoneEventAt(e),i=this._terminal.getSelection().length;r&&i===this._initialSelectionLength&&(r.clickCallback(e),e.preventDefault(),e.stopImmediatePropagation())},t.prototype._findZoneEventAt=function(e){var r=this._terminal.mouseHelper.getCoords(e,this._terminal.screenElement,this._terminal.charMeasure,this._terminal.cols,this._terminal.rows);if(!r)return null;for(var i=r[0],s=r[1],a=0;a<this._zones.length;a++){var c=this._zones[a];if(c.y1===c.y2){if(s===c.y1&&i>=c.x1&&i<c.x2)return c}else if(s===c.y1&&i>=c.x1||s===c.y2&&i<c.x2||s>c.y1&&s<c.y2)return c}return null},t}(ho.Disposable);Oe.MouseZoneManager=fo;var _o=function(){function n(t,e,r,i,s,a,c,o,l){this.x1=t,this.y1=e,this.x2=r,this.y2=i,this.clickCallback=s,this.hoverCallback=a,this.tooltipCallback=c,this.leaveCallback=o,this.willLinkActivate=l}return n}();Oe.MouseZone=_o;Object.defineProperty(Xt,"__esModule",{value:!0});var po=Oe,mo=Nt,_t=z,yo=function(){function n(t){this._terminal=t,this._linkMatchers=[],this._nextLinkMatcherId=0,this._onLinkHover=new _t.EventEmitter2,this._onLinkLeave=new _t.EventEmitter2,this._onLinkTooltip=new _t.EventEmitter2,this._rowsToLinkify={start:null,end:null}}return Object.defineProperty(n.prototype,"onLinkHover",{get:function(){return this._onLinkHover.event},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"onLinkLeave",{get:function(){return this._onLinkLeave.event},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"onLinkTooltip",{get:function(){return this._onLinkTooltip.event},enumerable:!0,configurable:!0}),n.prototype.attachToDom=function(t){this._mouseZoneManager=t},n.prototype.linkifyRows=function(t,e){var r=this;this._mouseZoneManager&&(this._rowsToLinkify.start===null?(this._rowsToLinkify.start=t,this._rowsToLinkify.end=e):(this._rowsToLinkify.start=Math.min(this._rowsToLinkify.start,t),this._rowsToLinkify.end=Math.max(this._rowsToLinkify.end,e)),this._mouseZoneManager.clearAll(t,e),this._rowsTimeoutId&&clearTimeout(this._rowsTimeoutId),this._rowsTimeoutId=setTimeout(function(){return r._linkifyRows()},n.TIME_BEFORE_LINKIFY))},n.prototype._linkifyRows=function(){this._rowsTimeoutId=null;var t=this._terminal.buffer,e=t.ydisp+this._rowsToLinkify.start;if(!(e>=t.lines.length)){for(var r=t.ydisp+Math.min(this._rowsToLinkify.end,this._terminal.rows)+1,i=Math.ceil(n.OVERSCAN_CHAR_LIMIT/this._terminal.cols),s=this._terminal.buffer.iterator(!1,e,r,i,i);s.hasNext();)for(var a=s.next(),c=0;c<this._linkMatchers.length;c++)this._doLinkifyRow(a.range.first,a.content,this._linkMatchers[c]);this._rowsToLinkify.start=null,this._rowsToLinkify.end=null}},n.prototype.registerLinkMatcher=function(t,e,r){if(r===void 0&&(r={}),!e)throw new Error("handler must be defined");var i={id:this._nextLinkMatcherId++,regex:t,handler:e,matchIndex:r.matchIndex,validationCallback:r.validationCallback,hoverTooltipCallback:r.tooltipCallback,hoverLeaveCallback:r.leaveCallback,willLinkActivate:r.willLinkActivate,priority:r.priority||0};return this._addLinkMatcherToList(i),i.id},n.prototype._addLinkMatcherToList=function(t){if(this._linkMatchers.length===0){this._linkMatchers.push(t);return}for(var e=this._linkMatchers.length-1;e>=0;e--)if(t.priority<=this._linkMatchers[e].priority){this._linkMatchers.splice(e+1,0,t);return}this._linkMatchers.splice(0,0,t)},n.prototype.deregisterLinkMatcher=function(t){for(var e=0;e<this._linkMatchers.length;e++)if(this._linkMatchers[e].id===t)return this._linkMatchers.splice(e,1),!0;return!1},n.prototype._doLinkifyRow=function(t,e,r){for(var i=this,s=new RegExp(r.regex.source,r.regex.flags+"g"),a,c=-1,o=function(){var h=a[typeof r.matchIndex!="number"?0:r.matchIndex];if(!h){if(l._terminal.debug)throw console.log({match:a,matcher:r}),new Error("match found without corresponding matchIndex");return"break"}if(c=e.indexOf(h,c+1),s.lastIndex=c+h.length,c<0)return"break";var f=l._terminal.buffer.stringIndexToBufferIndex(t,c);if(f[0]<0)return"break";var _=l._terminal.buffer.lines.get(f[0]),d=_.getFg(f[1]),p;d&&(p=d>>9&511),r.validationCallback?r.validationCallback(h,function(m){i._rowsTimeoutId||m&&i._addLink(f[1],f[0]-i._terminal.buffer.ydisp,h,r,p)}):l._addLink(f[1],f[0]-l._terminal.buffer.ydisp,h,r,p)},l=this;(a=s.exec(e))!==null;){var u=o();if(u==="break")break}},n.prototype._addLink=function(t,e,r,i,s){var a=this,c=mo.getStringCellWidth(r),o=t%this._terminal.cols,l=e+Math.floor(t/this._terminal.cols),u=(o+c)%this._terminal.cols,h=l+Math.floor((o+c)/this._terminal.cols);u===0&&(u=this._terminal.cols,h--),this._mouseZoneManager.add(new po.MouseZone(o+1,l+1,u+1,h+1,function(f){if(i.handler)return i.handler(f,r);window.open(r,"_blank")},function(){a._onLinkHover.fire(a._createLinkHoverEvent(o,l,u,h,s)),a._terminal.element.classList.add("xterm-cursor-pointer")},function(f){a._onLinkTooltip.fire(a._createLinkHoverEvent(o,l,u,h,s)),i.hoverTooltipCallback&&i.hoverTooltipCallback(f,r)},function(){a._onLinkLeave.fire(a._createLinkHoverEvent(o,l,u,h,s)),a._terminal.element.classList.remove("xterm-cursor-pointer"),i.hoverLeaveCallback&&i.hoverLeaveCallback()},function(f){return i.willLinkActivate?i.willLinkActivate(f,r):!0}))},n.prototype._createLinkHoverEvent=function(t,e,r,i,s){return{x1:t,y1:e,x2:r,y2:i,cols:this._terminal.cols,fg:s}},n.TIME_BEFORE_LINKIFY=200,n.OVERSCAN_CHAR_LIMIT=2e3,n}();Xt.Linkifier=yo;var Jt={},it={};Object.defineProperty(it,"__esModule",{value:!0});var go=function(){function n(t){this._renderCoordinator=t}return n.getCoordsRelativeToElement=function(t,e){var r=e.getBoundingClientRect();return[t.clientX-r.left,t.clientY-r.top]},n.prototype.getCoords=function(t,e,r,i,s,a){if(!r.width||!r.height)return null;var c=n.getCoordsRelativeToElement(t,e);return c?(c[0]=Math.ceil((c[0]+(a?this._renderCoordinator.dimensions.actualCellWidth/2:0))/this._renderCoordinator.dimensions.actualCellWidth),c[1]=Math.ceil(c[1]/this._renderCoordinator.dimensions.actualCellHeight),c[0]=Math.min(Math.max(c[0],1),i+(a?1:0)),c[1]=Math.min(Math.max(c[1],1),s),c):null},n.prototype.getRawByteCoords=function(t,e,r,i,s){var a=this.getCoords(t,e,r,i,s),c=a[0],o=a[1];return c+=32,o+=32,{x:c,y:o}},n}();it.MouseHelper=go;var Zt={};Object.defineProperty(Zt,"__esModule",{value:!0});var vo=function(){function n(t){this._terminal=t,this.clearSelection()}return n.prototype.clearSelection=function(){this.selectionStart=null,this.selectionEnd=null,this.isSelectAllActive=!1,this.selectionStartLength=0},Object.defineProperty(n.prototype,"finalSelectionStart",{get:function(){return this.isSelectAllActive?[0,0]:!this.selectionEnd||!this.selectionStart?this.selectionStart:this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"finalSelectionEnd",{get:function(){if(this.isSelectAllActive)return[this._terminal.cols,this._terminal.buffer.ybase+this._terminal.rows-1];if(!this.selectionStart)return null;if(!this.selectionEnd||this.areSelectionValuesReversed()){var t=this.selectionStart[0]+this.selectionStartLength;return t>this._terminal.cols?[t%this._terminal.cols,this.selectionStart[1]+Math.floor(t/this._terminal.cols)]:[t,this.selectionStart[1]]}return this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]?[Math.max(this.selectionStart[0]+this.selectionStartLength,this.selectionEnd[0]),this.selectionEnd[1]]:this.selectionEnd},enumerable:!0,configurable:!0}),n.prototype.areSelectionValuesReversed=function(){var t=this.selectionStart,e=this.selectionEnd;return!t||!e?!1:t[1]>e[1]||t[1]===e[1]&&t[0]>e[0]},n.prototype.onTrim=function(t){return this.selectionStart&&(this.selectionStart[1]-=t),this.selectionEnd&&(this.selectionEnd[1]-=t),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)},n}();Zt.SelectionModel=vo;var Qt={};Object.defineProperty(Qt,"__esModule",{value:!0});var Co=Re,bo=function(){function n(t,e){var r;this._mouseEvent=t,this._terminal=e,this._lines=this._terminal.buffer.lines,this._startCol=this._terminal.buffer.x,this._startRow=this._terminal.buffer.y;var i=this._terminal.mouseHelper.getCoords(this._mouseEvent,this._terminal.element,this._terminal.charMeasure,this._terminal.cols,this._terminal.rows,!1);i&&(r=i.map(function(s){return s-1}),this._endCol=r[0],this._endRow=r[1])}return n.prototype.move=function(){this._mouseEvent.altKey&&this._endCol!==void 0&&this._endRow!==void 0&&this._terminal.handler(this._arrowSequences())},n.prototype._arrowSequences=function(){return this._terminal.buffer.hasScrollback?this._moveHorizontallyOnly():this._resetStartingRow()+this._moveToRequestedRow()+this._moveToRequestedCol()},n.prototype._resetStartingRow=function(){return this._moveToRequestedRow().length===0?"":$e(this._bufferLine(this._startCol,this._startRow,this._startCol,this._startRow-this._wrappedRowsForRow(this._startRow),!1).length,this._sequence("D"))},n.prototype._moveToRequestedRow=function(){var t=this._startRow-this._wrappedRowsForRow(this._startRow),e=this._endRow-this._wrappedRowsForRow(this._endRow),r=Math.abs(t-e)-this._wrappedRowsCount();return $e(r,this._sequence(this._verticalDirection()))},n.prototype._moveToRequestedCol=function(){var t;this._moveToRequestedRow().length>0?t=this._endRow-this._wrappedRowsForRow(this._endRow):t=this._startRow;var e=this._endRow,r=this._horizontalDirection();return $e(this._bufferLine(this._startCol,t,this._endCol,e,r==="C").length,this._sequence(r))},n.prototype._moveHorizontallyOnly=function(){var t=this._horizontalDirection();return $e(Math.abs(this._startCol-this._endCol),this._sequence(t))},n.prototype._wrappedRowsCount=function(){for(var t=0,e=this._startRow-this._wrappedRowsForRow(this._startRow),r=this._endRow-this._wrappedRowsForRow(this._endRow),i=0;i<Math.abs(e-r);i++){var s=this._verticalDirection()==="A"?-1:1;this._lines.get(e+s*i).isWrapped&&t++}return t},n.prototype._wrappedRowsForRow=function(t){for(var e=0,r=this._lines.get(t).isWrapped;r&&t>=0&&t<this._terminal.rows;)e++,t--,r=this._lines.get(t).isWrapped;return e},n.prototype._horizontalDirection=function(){var t;return this._moveToRequestedRow().length>0?t=this._endRow-this._wrappedRowsForRow(this._endRow):t=this._startRow,this._startCol<this._endCol&&t<=this._endRow||this._startCol>=this._endCol&&t<this._endRow?"C":"D"},n.prototype._verticalDirection=function(){return this._startRow>this._endRow?"A":"B"},n.prototype._bufferLine=function(t,e,r,i,s){for(var a=t,c=e,o="";a!==r||c!==i;)a+=s?1:-1,s&&a>this._terminal.cols-1?(o+=this._terminal.buffer.translateBufferLineToString(c,!1,t,a),a=0,t=0,c++):!s&&a<0&&(o+=this._terminal.buffer.translateBufferLineToString(c,!1,0,t+1),a=this._terminal.cols-1,t=a,c--);return o+this._terminal.buffer.translateBufferLineToString(c,!1,t,a)},n.prototype._sequence=function(t){var e=this._terminal.applicationCursor?"O":"[";return Co.C0.ESC+e+t},n}();Qt.AltClickHandler=bo;function $e(n,t){n=Math.floor(n);for(var e="",r=0;r<n;r++)e+=t;return e}Object.defineProperty(Jt,"__esModule",{value:!0});var wo=it,Ke=O,xo=Zt,So=Qt,Eo=q,dt=z,pt=50,Ao=15,Lo=50,Ro=500,To=` ()[]{}'"`,ko=String.fromCharCode(160),Do=new RegExp(ko,"g"),Mo=function(){function n(t,e){this._terminal=t,this._charMeasure=e,this._enabled=!0,this._workCell=new Eo.CellData,this._onLinuxMouseSelection=new dt.EventEmitter2,this._onRedrawRequest=new dt.EventEmitter2,this._onSelectionChange=new dt.EventEmitter2,this._initListeners(),this.enable(),this._model=new xo.SelectionModel(t),this._activeSelectionMode=0}return Object.defineProperty(n.prototype,"onLinuxMouseSelection",{get:function(){return this._onLinuxMouseSelection.event},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"onRedrawRequest",{get:function(){return this._onRedrawRequest.event},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"onSelectionChange",{get:function(){return this._onSelectionChange.event},enumerable:!0,configurable:!0}),n.prototype.dispose=function(){this._removeMouseDownListeners()},Object.defineProperty(n.prototype,"_buffer",{get:function(){return this._terminal.buffers.active},enumerable:!0,configurable:!0}),n.prototype._initListeners=function(){var t=this;this._mouseMoveListener=function(e){return t._onMouseMove(e)},this._mouseUpListener=function(e){return t._onMouseUp(e)},this.initBuffersListeners()},n.prototype.initBuffersListeners=function(){var t=this;this._trimListener=this._terminal.buffer.lines.onTrim(function(e){return t._onTrim(e)}),this._terminal.buffers.onBufferActivate(function(e){return t._onBufferActivate(e)})},n.prototype.disable=function(){this.clearSelection(),this._enabled=!1},n.prototype.enable=function(){this._enabled=!0},Object.defineProperty(n.prototype,"selectionStart",{get:function(){return this._model.finalSelectionStart},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionEnd",{get:function(){return this._model.finalSelectionEnd},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hasSelection",{get:function(){var t=this._model.finalSelectionStart,e=this._model.finalSelectionEnd;return!t||!e?!1:t[0]!==e[0]||t[1]!==e[1]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionText",{get:function(){var t=this._model.finalSelectionStart,e=this._model.finalSelectionEnd;if(!t||!e)return"";var r=[];if(this._activeSelectionMode===3){if(t[0]===e[0])return"";for(var i=t[1];i<=e[1];i++){var s=this._buffer.translateBufferLineToString(i,!0,t[0],e[0]);r.push(s)}}else{var a=t[1]===e[1]?e[0]:void 0;r.push(this._buffer.translateBufferLineToString(t[1],!0,t[0],a));for(var i=t[1]+1;i<=e[1]-1;i++){var c=this._buffer.lines.get(i),s=this._buffer.translateBufferLineToString(i,!0);c.isWrapped?r[r.length-1]+=s:r.push(s)}if(t[1]!==e[1]){var c=this._buffer.lines.get(e[1]),s=this._buffer.translateBufferLineToString(e[1],!0,0,e[0]);c.isWrapped?r[r.length-1]+=s:r.push(s)}}var o=r.map(function(l){return l.replace(Do," ")}).join(Ke.isMSWindows?`\r
`:`
`);return o},enumerable:!0,configurable:!0}),n.prototype.clearSelection=function(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()},n.prototype.refresh=function(t){var e=this;if(this._refreshAnimationFrame||(this._refreshAnimationFrame=window.requestAnimationFrame(function(){return e._refresh()})),Ke.isLinux&&t){var r=this.selectionText;r.length&&this._onLinuxMouseSelection.fire(this.selectionText)}},n.prototype._refresh=function(){this._refreshAnimationFrame=null,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})},n.prototype.isClickInSelection=function(t){var e=this._getMouseBufferCoords(t),r=this._model.finalSelectionStart,i=this._model.finalSelectionEnd;return!r||!i?!1:this._areCoordsInSelection(e,r,i)},n.prototype._areCoordsInSelection=function(t,e,r){return t[1]>e[1]&&t[1]<r[1]||e[1]===r[1]&&t[1]===e[1]&&t[0]>=e[0]&&t[0]<r[0]||e[1]<r[1]&&t[1]===r[1]&&t[0]<r[0]||e[1]<r[1]&&t[1]===e[1]&&t[0]>=e[0]},n.prototype.selectWordAtCursor=function(t){var e=this._getMouseBufferCoords(t);e&&(this._selectWordAt(e,!1),this._model.selectionEnd=null,this.refresh(!0))},n.prototype.selectAll=function(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()},n.prototype.selectLines=function(t,e){this._model.clearSelection(),t=Math.max(t,0),e=Math.min(e,this._terminal.buffer.lines.length-1),this._model.selectionStart=[0,t],this._model.selectionEnd=[this._terminal.cols,e],this.refresh(),this._onSelectionChange.fire()},n.prototype._onTrim=function(t){var e=this._model.onTrim(t);e&&this.refresh()},n.prototype._getMouseBufferCoords=function(t){var e=this._terminal.mouseHelper.getCoords(t,this._terminal.screenElement,this._charMeasure,this._terminal.cols,this._terminal.rows,!0);return e?(e[0]--,e[1]--,e[1]+=this._terminal.buffer.ydisp,e):null},n.prototype._getMouseEventScrollAmount=function(t){var e=wo.MouseHelper.getCoordsRelativeToElement(t,this._terminal.screenElement)[1],r=this._terminal.rows*Math.ceil(this._charMeasure.height*this._terminal.options.lineHeight);return e>=0&&e<=r?0:(e>r&&(e-=r),e=Math.min(Math.max(e,-pt),pt),e/=pt,e/Math.abs(e)+Math.round(e*(Ao-1)))},n.prototype.shouldForceSelection=function(t){return Ke.isMac?t.altKey&&this._terminal.options.macOptionClickForcesSelection:t.shiftKey},n.prototype.onMouseDown=function(t){if(this._mouseDownTimeStamp=t.timeStamp,!(t.button===2&&this.hasSelection)&&t.button===0){if(!this._enabled){if(!this.shouldForceSelection(t))return;t.stopPropagation()}t.preventDefault(),this._dragScrollAmount=0,this._enabled&&t.shiftKey?this._onIncrementalClick(t):t.detail===1?this._onSingleClick(t):t.detail===2?this._onDoubleClick(t):t.detail===3&&this._onTripleClick(t),this._addMouseDownListeners(),this.refresh(!0)}},n.prototype._addMouseDownListeners=function(){var t=this;this._terminal.element.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._terminal.element.ownerDocument.addEventListener("mouseup",this._mouseUpListener),this._dragScrollIntervalTimer=setInterval(function(){return t._dragScroll()},Lo)},n.prototype._removeMouseDownListeners=function(){this._terminal.element.ownerDocument&&(this._terminal.element.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._terminal.element.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=null},n.prototype._onIncrementalClick=function(t){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(t))},n.prototype._onSingleClick=function(t){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(t)?3:0,this._model.selectionStart=this._getMouseBufferCoords(t),!!this._model.selectionStart){this._model.selectionEnd=null;var e=this._buffer.lines.get(this._model.selectionStart[1]);e&&(e.length>=this._model.selectionStart[0]||e.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++)}},n.prototype._onDoubleClick=function(t){var e=this._getMouseBufferCoords(t);e&&(this._activeSelectionMode=1,this._selectWordAt(e,!0))},n.prototype._onTripleClick=function(t){var e=this._getMouseBufferCoords(t);e&&(this._activeSelectionMode=2,this._selectLineAt(e[1]))},n.prototype.shouldColumnSelect=function(t){return t.altKey&&!(Ke.isMac&&this._terminal.options.macOptionClickForcesSelection)},n.prototype._onMouseMove=function(t){t.stopImmediatePropagation();var e=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(t),!this._model.selectionEnd){this.refresh(!0);return}this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._terminal.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(t),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._terminal.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0)),this._model.selectionEnd[1]<this._buffer.lines.length&&this._buffer.lines.get(this._model.selectionEnd[1]).hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++,(!e||e[0]!==this._model.selectionEnd[0]||e[1]!==this._model.selectionEnd[1])&&this.refresh(!0)},n.prototype._dragScroll=function(){this._dragScrollAmount&&(this._terminal.scrollLines(this._dragScrollAmount,!1),this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._terminal.cols),this._model.selectionEnd[1]=Math.min(this._terminal.buffer.ydisp+this._terminal.rows,this._terminal.buffer.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=this._terminal.buffer.ydisp),this.refresh())},n.prototype._onMouseUp=function(t){var e=t.timeStamp-this._mouseDownTimeStamp;this._removeMouseDownListeners(),this.selectionText.length<=1&&e<Ro?new So.AltClickHandler(t,this._terminal).move():this.hasSelection&&this._onSelectionChange.fire()},n.prototype._onBufferActivate=function(t){var e=this;this.clearSelection(),this._trimListener&&this._trimListener.dispose(),this._trimListener=t.activeBuffer.lines.onTrim(function(r){return e._onTrim(r)})},n.prototype._convertViewportColToCharacterIndex=function(t,e){for(var r=e[0],i=0;e[0]>=i;i++){var s=t.loadCell(i,this._workCell).getChars().length;this._workCell.getWidth()===0?r--:s>1&&e[0]!==i&&(r+=s-1)}return r},n.prototype.setSelection=function(t,e,r){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[t,e],this._model.selectionStartLength=r,this.refresh()},n.prototype._getWordAt=function(t,e,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=!0),t[0]>=this._terminal.cols)return null;var s=this._buffer.lines.get(t[1]);if(!s)return null;var a=this._buffer.translateBufferLineToString(t[1],!1),c=this._convertViewportColToCharacterIndex(s,t),o=c,l=t[0]-c,u=0,h=0,f=0,_=0;if(a.charAt(c)===" "){for(;c>0&&a.charAt(c-1)===" ";)c--;for(;o<a.length&&a.charAt(o+1)===" ";)o++}else{var d=t[0],p=t[0];s.getWidth(d)===0&&(u++,d--),s.getWidth(p)===2&&(h++,p++);var m=s.getString(p).length;for(m>1&&(_+=m-1,o+=m-1);d>0&&c>0&&!this._isCharWordSeparator(s.loadCell(d-1,this._workCell));){s.loadCell(d-1,this._workCell);var x=this._workCell.getChars().length;this._workCell.getWidth()===0?(u++,d--):x>1&&(f+=x-1,c-=x-1),c--,d--}for(;p<s.length&&o+1<a.length&&!this._isCharWordSeparator(s.loadCell(p+1,this._workCell));){s.loadCell(p+1,this._workCell);var g=this._workCell.getChars().length;this._workCell.getWidth()===2?(h++,p++):g>1&&(_+=g-1,o+=g-1),o++,p++}}o++;var v=c+l-u+f,A=Math.min(this._terminal.cols,o-c+u+h-f-_);if(!e&&a.slice(c,o).trim()==="")return null;if(r&&v===0&&s.getCodePoint(0)!==32){var k=this._buffer.lines.get(t[1]-1);if(k&&s.isWrapped&&k.getCodePoint(this._terminal.cols-1)!==32){var b=this._getWordAt([this._terminal.cols-1,t[1]-1],!1,!0,!1);if(b){var T=this._terminal.cols-b.start;v-=T,A+=T}}}if(i&&v+A===this._terminal.cols&&s.getCodePoint(this._terminal.cols-1)!==32){var P=this._buffer.lines.get(t[1]+1);if(P&&P.isWrapped&&P.getCodePoint(0)!==32){var L=this._getWordAt([0,t[1]+1],!1,!1,!0);L&&(A+=L.length)}}return{start:v,length:A}},n.prototype._selectWordAt=function(t,e){var r=this._getWordAt(t,e);if(r){for(;r.start<0;)r.start+=this._terminal.cols,t[1]--;this._model.selectionStart=[r.start,t[1]],this._model.selectionStartLength=r.length}},n.prototype._selectToWordAt=function(t){var e=this._getWordAt(t,!0);if(e){for(var r=t[1];e.start<0;)e.start+=this._terminal.cols,r--;if(!this._model.areSelectionValuesReversed())for(;e.start+e.length>this._terminal.cols;)e.length-=this._terminal.cols,r++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?e.start:e.start+e.length,r]}},n.prototype._isCharWordSeparator=function(t){return t.getWidth()===0?!1:To.indexOf(t.getChars())>=0},n.prototype._selectLineAt=function(t){var e=this._buffer.getWrappedRangeForLine(t);this._model.selectionStart=[0,e.first],this._model.selectionEnd=[this._terminal.cols,e.last],this._model.selectionStartLength=0},n}();Jt.SelectionManager=Mo;var er={};Object.defineProperty(er,"__esModule",{value:!0});var Bo=z,Oo=function(){function n(t,e){this._onCharSizeChanged=new Bo.EventEmitter2,this._document=t,this._parentElement=e,this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W",this._measureElement.setAttribute("aria-hidden","true"),this._parentElement.appendChild(this._measureElement)}return Object.defineProperty(n.prototype,"onCharSizeChanged",{get:function(){return this._onCharSizeChanged.event},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),n.prototype.measure=function(t){this._measureElement.style.fontFamily=t.fontFamily,this._measureElement.style.fontSize=t.fontSize+"px";var e=this._measureElement.getBoundingClientRect();if(!(e.width===0||e.height===0)){var r=Math.ceil(e.height);(this._width!==e.width||this._height!==r)&&(this._width=e.width,this._height=r,this._onCharSizeChanged.fire())}},n}();er.CharMeasure=Oo;var ae={};Object.defineProperty(ae,"__esModule",{value:!0});ae.blankLine="Blank line";ae.promptLabel="Terminal input";ae.tooMuchOutput="Too much output to announce, navigate to rows manually to read";var nt={};Object.defineProperty(nt,"__esModule",{value:!0});nt.DEFAULT_BELL_SOUND="data:audio/wav;base64,UklGRigBAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQQBAADpAFgCwAMlBZoG/wdmCcoKRAypDQ8PbRDBEQQTOxRtFYcWlBePGIUZXhoiG88bcBz7HHIdzh0WHlMeZx51HmkeUx4WHs8dah0AHXwc3hs9G4saxRnyGBIYGBcQFv8U4RPAEoYRQBACD70NWwwHC6gJOwjWBloF7gOBAhABkf8b/qv8R/ve+Xf4Ife79W/0JfPZ8Z/wde9N7ijtE+wU6xvqM+lb6H7nw+YX5mrlxuQz5Mzje+Ma49fioeKD4nXiYeJy4pHitOL04j/jn+MN5IPkFOWs5U3mDefM55/ogOl36m7rdOyE7abuyu8D8Unyj/Pg9D/2qfcb+Yn6/vuK/Qj/lAAlAg==";var Ho=function(){function n(t){this._terminal=t}return Object.defineProperty(n,"audioContext",{get:function(){if(!n._audioContext){var t=window.AudioContext||window.webkitAudioContext;if(!t)return console.warn("Web Audio API is not supported by this browser. Consider upgrading to the latest version"),null;n._audioContext=new t}return n._audioContext},enumerable:!0,configurable:!0}),n.prototype.playBellSound=function(){var t=n.audioContext;if(t){var e=t.createBufferSource();t.decodeAudioData(this._base64ToArrayBuffer(this._removeMimeType(this._terminal.options.bellSound)),function(r){e.buffer=r,e.connect(t.destination),e.start(0)})}},n.prototype._base64ToArrayBuffer=function(t){for(var e=window.atob(t),r=e.length,i=new Uint8Array(r),s=0;s<r;s++)i[s]=e.charCodeAt(s);return i.buffer},n.prototype._removeMimeType=function(t){var e=t.split(",");return e[1]},n}();nt.SoundManager=Ho;var tr={},st={};Object.defineProperty(st,"__esModule",{value:!0});var Fo=function(){function n(t){this._renderCallback=t}return n.prototype.dispose=function(){this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)},n.prototype.refresh=function(t,e,r){var i=this;this._rowCount=r,t=t!==void 0?t:0,e=e!==void 0?e:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,t):t,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,e):e,!this._animationFrame&&(this._animationFrame=window.requestAnimationFrame(function(){return i._innerRefresh()}))},n.prototype._innerRefresh=function(){this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0||(this._rowStart=Math.max(this._rowStart,0),this._rowEnd=Math.min(this._rowEnd,this._rowCount-1),this._renderCallback(this._rowStart,this._rowEnd),this._rowStart=void 0,this._rowEnd=void 0,this._animationFrame=void 0)},n}();st.RenderDebouncer=Fo;var ot={},Po=C&&C.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(t,e)};return function(t,e){n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(ot,"__esModule",{value:!0});var Io=F,No=function(n){Po(t,n);function t(){var e=n!==null&&n.apply(this,arguments)||this;return e._currentDevicePixelRatio=window.devicePixelRatio,e}return t.prototype.setListener=function(e){var r=this;this._listener&&this.clearListener(),this._listener=e,this._outerListener=function(){r._listener&&(r._listener(window.devicePixelRatio,r._currentDevicePixelRatio),r._updateDpr())},this._updateDpr()},t.prototype.dispose=function(){n.prototype.dispose.call(this),this.clearListener()},t.prototype._updateDpr=function(){!this._resolutionMediaMatchList||!this._outerListener||(this._resolutionMediaMatchList.removeListener(this._outerListener),this._currentDevicePixelRatio=window.devicePixelRatio,this._resolutionMediaMatchList=window.matchMedia("screen and (resolution: "+window.devicePixelRatio+"dppx)"),this._resolutionMediaMatchList.addListener(this._outerListener))},t.prototype.clearListener=function(){!this._resolutionMediaMatchList||!this._listener||!this._outerListener||(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)},t}(Io.Disposable);ot.ScreenDprMonitor=No;var Wo=C&&C.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(t,e)};return function(t,e){n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(tr,"__esModule",{value:!0});var Rr=ae,Tr=O,Uo=st,jo=se,$o=F,Ko=ot,kr=20,zo=function(n){Wo(t,n);function t(e,r){var i=n.call(this)||this;i._terminal=e,i._dimensions=r,i._liveRegionLineCount=0,i._charsToConsume=[],i._charsToAnnounce="",i._accessibilityTreeRoot=document.createElement("div"),i._accessibilityTreeRoot.classList.add("xterm-accessibility"),i._rowContainer=document.createElement("div"),i._rowContainer.classList.add("xterm-accessibility-tree"),i._rowElements=[];for(var s=0;s<i._terminal.rows;s++)i._rowElements[s]=i._createAccessibilityTreeNode(),i._rowContainer.appendChild(i._rowElements[s]);return i._topBoundaryFocusListener=function(a){return i._onBoundaryFocus(a,0)},i._bottomBoundaryFocusListener=function(a){return i._onBoundaryFocus(a,1)},i._rowElements[0].addEventListener("focus",i._topBoundaryFocusListener),i._rowElements[i._rowElements.length-1].addEventListener("focus",i._bottomBoundaryFocusListener),i._refreshRowsDimensions(),i._accessibilityTreeRoot.appendChild(i._rowContainer),i._renderRowsDebouncer=new Uo.RenderDebouncer(i._renderRows.bind(i)),i._refreshRows(),i._liveRegion=document.createElement("div"),i._liveRegion.classList.add("live-region"),i._liveRegion.setAttribute("aria-live","assertive"),i._accessibilityTreeRoot.appendChild(i._liveRegion),i._terminal.element.insertAdjacentElement("afterbegin",i._accessibilityTreeRoot),i.register(i._renderRowsDebouncer),i.register(i._terminal.onResize(function(a){return i._onResize(a.rows)})),i.register(i._terminal.onRender(function(a){return i._refreshRows(a.start,a.end)})),i.register(i._terminal.onScroll(function(){return i._refreshRows()})),i.register(i._terminal.addDisposableListener("a11y.char",function(a){return i._onChar(a)})),i.register(i._terminal.onLineFeed(function(){return i._onChar(`
`)})),i.register(i._terminal.addDisposableListener("a11y.tab",function(a){return i._onTab(a)})),i.register(i._terminal.onKey(function(a){return i._onKey(a.key)})),i.register(i._terminal.addDisposableListener("blur",function(){return i._clearLiveRegion()})),i._screenDprMonitor=new Ko.ScreenDprMonitor,i.register(i._screenDprMonitor),i._screenDprMonitor.setListener(function(){return i._refreshRowsDimensions()}),i.register(jo.addDisposableDomListener(window,"resize",function(){return i._refreshRowsDimensions()})),i}return t.prototype.dispose=function(){n.prototype.dispose.call(this),this._terminal.element.removeChild(this._accessibilityTreeRoot),this._rowElements.length=0},t.prototype._onBoundaryFocus=function(e,r){var i=e.target,s=this._rowElements[r===0?1:this._rowElements.length-2],a=i.getAttribute("aria-posinset"),c=r===0?"1":""+this._terminal.buffer.lines.length;if(a!==c&&e.relatedTarget===s){var o,l;if(r===0?(o=i,l=this._rowElements.pop(),this._rowContainer.removeChild(l)):(o=this._rowElements.shift(),l=i,this._rowContainer.removeChild(o)),o.removeEventListener("focus",this._topBoundaryFocusListener),l.removeEventListener("focus",this._bottomBoundaryFocusListener),r===0){var u=this._createAccessibilityTreeNode();this._rowElements.unshift(u),this._rowContainer.insertAdjacentElement("afterbegin",u)}else{var u=this._createAccessibilityTreeNode();this._rowElements.push(u),this._rowContainer.appendChild(u)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(r===0?-1:1),this._rowElements[r===0?1:this._rowElements.length-2].focus(),e.preventDefault(),e.stopImmediatePropagation()}},t.prototype._onResize=function(e){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(var r=this._rowContainer.children.length;r<this._terminal.rows;r++)this._rowElements[r]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[r]);for(;this._rowElements.length>e;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()},t.prototype._createAccessibilityTreeNode=function(){var e=document.createElement("div");return e.setAttribute("role","listitem"),e.tabIndex=-1,this._refreshRowDimensions(e),e},t.prototype._onTab=function(e){for(var r=0;r<e;r++)this._onChar(" ")},t.prototype._onChar=function(e){var r=this;if(this._liveRegionLineCount<kr+1){if(this._charsToConsume.length>0){var i=this._charsToConsume.shift();i!==e&&(this._charsToAnnounce+=e)}else this._charsToAnnounce+=e;e===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===kr+1&&(this._liveRegion.textContent+=Rr.tooMuchOutput)),Tr.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(function(){r._accessibilityTreeRoot.appendChild(r._liveRegion)},0)}},t.prototype._clearLiveRegion=function(){this._liveRegion.textContent="",this._liveRegionLineCount=0,Tr.isMac&&this._liveRegion.parentNode&&this._accessibilityTreeRoot.removeChild(this._liveRegion)},t.prototype._onKey=function(e){this._clearLiveRegion(),this._charsToConsume.push(e)},t.prototype._refreshRows=function(e,r){this._renderRowsDebouncer.refresh(e,r,this._terminal.rows)},t.prototype._renderRows=function(e,r){for(var i=this._terminal.buffer,s=i.lines.length.toString(),a=e;a<=r;a++){var c=i.translateBufferLineToString(i.ydisp+a,!0),o=(i.ydisp+a+1).toString(),l=this._rowElements[a];l&&(l.textContent=c.length===0?Rr.blankLine:c,l.setAttribute("aria-posinset",o),l.setAttribute("aria-setsize",s))}this._announceCharacters()},t.prototype._refreshRowsDimensions=function(){if(this._dimensions.actualCellHeight){this._rowElements.length!==this._terminal.rows&&this._onResize(this._terminal.rows);for(var e=0;e<this._terminal.rows;e++)this._refreshRowDimensions(this._rowElements[e])}},t.prototype.setDimensions=function(e){this._dimensions=e,this._refreshRowsDimensions()},t.prototype._refreshRowDimensions=function(e){e.style.height=this._dimensions.actualCellHeight+"px"},t.prototype._announceCharacters=function(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")},t}($o.Disposable);tr.AccessibilityManager=zo;var rr={},fi={};(function(n){Object.defineProperty(n,"__esModule",{value:!0});var t=V,e=q;n.BOLD_CLASS="xterm-bold",n.DIM_CLASS="xterm-dim",n.ITALIC_CLASS="xterm-italic",n.UNDERLINE_CLASS="xterm-underline",n.CURSOR_CLASS="xterm-cursor",n.CURSOR_BLINK_CLASS="xterm-cursor-blink",n.CURSOR_STYLE_BLOCK_CLASS="xterm-cursor-block",n.CURSOR_STYLE_BAR_CLASS="xterm-cursor-bar",n.CURSOR_STYLE_UNDERLINE_CLASS="xterm-cursor-underline";var r=function(){function i(s,a){this._terminalOptions=s,this._document=a,this._workCell=new e.CellData}return i.prototype.createRow=function(s,a,c,o,l,u,h){for(var f=this._document.createDocumentFragment(),_=0,d=Math.min(s.length,h)-1;d>=0;d--)if(s.loadCell(d,this._workCell).getCode()!==e.NULL_CELL_CODE||a&&d===o){_=d+1;break}for(var d=0;d<_;d++){s.loadCell(d,this._workCell);var p=this._workCell.getWidth();if(p!==0){var m=this._document.createElement("span");if(p>1&&(m.style.width=u*p+"px"),a&&d===o)switch(m.classList.add(n.CURSOR_CLASS),l&&m.classList.add(n.CURSOR_BLINK_CLASS),c){case"bar":m.classList.add(n.CURSOR_STYLE_BAR_CLASS);break;case"underline":m.classList.add(n.CURSOR_STYLE_UNDERLINE_CLASS);break;default:m.classList.add(n.CURSOR_STYLE_BLOCK_CLASS);break}this._workCell.isBold()&&this._terminalOptions.enableBold&&m.classList.add(n.BOLD_CLASS),this._workCell.isItalic()&&m.classList.add(n.ITALIC_CLASS),this._workCell.isDim()&&m.classList.add(n.DIM_CLASS),this._workCell.isUnderline()&&m.classList.add(n.UNDERLINE_CLASS),m.textContent=this._workCell.getChars()||e.WHITESPACE_CELL_CHAR;var x=this._workCell.isInverse();if(this._workCell.isFgRGB()){var g=m.getAttribute("style")||"";g+=(x?"background-":"")+"color:rgb("+e.AttributeData.toColorRGB(this._workCell.getFgColor()).join(",")+");",m.setAttribute("style",g)}else if(this._workCell.isFgPalette()){var v=this._workCell.getFgColor();this._workCell.isBold()&&v<8&&!x&&this._terminalOptions.enableBold&&this._terminalOptions.drawBoldTextInBrightColors&&(v+=8),m.classList.add("xterm-"+(x?"b":"f")+"g-"+v)}else x&&m.classList.add("xterm-bg-"+t.INVERTED_DEFAULT_COLOR);if(this._workCell.isBgRGB()){var g=m.getAttribute("style")||"";g+=(x?"":"background-")+"color:rgb("+e.AttributeData.toColorRGB(this._workCell.getBgColor()).join(",")+");",m.setAttribute("style",g)}else this._workCell.isBgPalette()?m.classList.add("xterm-"+(x?"f":"b")+"g-"+this._workCell.getBgColor()):x&&m.classList.add("xterm-fg-"+t.INVERTED_DEFAULT_COLOR);f.appendChild(m)}}return f},i}();n.DomRendererRowFactory=r})(fi);var qo=C&&C.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(t,e)};return function(t,e){n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(rr,"__esModule",{value:!0});var H=fi,Dr=V,Vo=F,mt="xterm-dom-renderer-owner-",Z="xterm-rows",Mr="xterm-fg-",Br="xterm-bg-",re="xterm-focus",yt="xterm-selection",Go=1,Yo=function(n){qo(t,n);function t(e,r){var i=n.call(this)||this;return i._terminal=e,i._colors=r,i._terminalClass=Go++,i._rowElements=[],i._rowContainer=document.createElement("div"),i._rowContainer.classList.add(Z),i._rowContainer.style.lineHeight="normal",i._rowContainer.setAttribute("aria-hidden","true"),i._refreshRowElements(i._terminal.cols,i._terminal.rows),i._selectionContainer=document.createElement("div"),i._selectionContainer.classList.add(yt),i._selectionContainer.setAttribute("aria-hidden","true"),i.dimensions={scaledCharWidth:null,scaledCharHeight:null,scaledCellWidth:null,scaledCellHeight:null,scaledCharLeft:null,scaledCharTop:null,scaledCanvasWidth:null,scaledCanvasHeight:null,canvasWidth:null,canvasHeight:null,actualCellWidth:null,actualCellHeight:null},i._updateDimensions(),i._injectCss(),i._rowFactory=new H.DomRendererRowFactory(e.options,document),i._terminal.element.classList.add(mt+i._terminalClass),i._terminal.screenElement.appendChild(i._rowContainer),i._terminal.screenElement.appendChild(i._selectionContainer),i._terminal.linkifier.onLinkHover(function(s){return i._onLinkHover(s)}),i._terminal.linkifier.onLinkLeave(function(s){return i._onLinkLeave(s)}),i}return t.prototype.dispose=function(){this._terminal.element.classList.remove(mt+this._terminalClass),this._terminal.screenElement.removeChild(this._rowContainer),this._terminal.screenElement.removeChild(this._selectionContainer),this._terminal.screenElement.removeChild(this._themeStyleElement),this._terminal.screenElement.removeChild(this._dimensionsStyleElement),n.prototype.dispose.call(this)},t.prototype._updateDimensions=function(){var e=this;this.dimensions.scaledCharWidth=this._terminal.charMeasure.width*window.devicePixelRatio,this.dimensions.scaledCharHeight=Math.ceil(this._terminal.charMeasure.height*window.devicePixelRatio),this.dimensions.scaledCellWidth=this.dimensions.scaledCharWidth+Math.round(this._terminal.options.letterSpacing),this.dimensions.scaledCellHeight=Math.floor(this.dimensions.scaledCharHeight*this._terminal.options.lineHeight),this.dimensions.scaledCharLeft=0,this.dimensions.scaledCharTop=0,this.dimensions.scaledCanvasWidth=this.dimensions.scaledCellWidth*this._terminal.cols,this.dimensions.scaledCanvasHeight=this.dimensions.scaledCellHeight*this._terminal.rows,this.dimensions.canvasWidth=Math.round(this.dimensions.scaledCanvasWidth/window.devicePixelRatio),this.dimensions.canvasHeight=Math.round(this.dimensions.scaledCanvasHeight/window.devicePixelRatio),this.dimensions.actualCellWidth=this.dimensions.canvasWidth/this._terminal.cols,this.dimensions.actualCellHeight=this.dimensions.canvasHeight/this._terminal.rows,this._rowElements.forEach(function(i){i.style.width=e.dimensions.canvasWidth+"px",i.style.height=e.dimensions.actualCellHeight+"px",i.style.lineHeight=e.dimensions.actualCellHeight+"px",i.style.overflow="hidden"}),this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._terminal.screenElement.appendChild(this._dimensionsStyleElement));var r=this._terminalSelector+" ."+Z+" span { display: inline-block; height: 100%; vertical-align: top;"+(" width: "+this.dimensions.actualCellWidth+"px")+"}";this._dimensionsStyleElement.innerHTML=r,this._selectionContainer.style.height=this._terminal._viewportElement.style.height,this._terminal.screenElement.style.width=this.dimensions.canvasWidth+"px",this._terminal.screenElement.style.height=this.dimensions.canvasHeight+"px"},t.prototype.setColors=function(e){this._colors=e,this._injectCss()},t.prototype._injectCss=function(){var e=this;this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._terminal.screenElement.appendChild(this._themeStyleElement));var r=this._terminalSelector+" ."+Z+" {"+(" color: "+this._colors.foreground.css+";")+(" background-color: "+this._colors.background.css+";")+(" font-family: "+this._terminal.options.fontFamily+";")+(" font-size: "+this._terminal.options.fontSize+"px;")+"}";r+=this._terminalSelector+" span:not(."+H.BOLD_CLASS+") {"+(" font-weight: "+this._terminal.options.fontWeight+";")+"}"+(this._terminalSelector+" span."+H.BOLD_CLASS+" {")+(" font-weight: "+this._terminal.options.fontWeightBold+";")+"}"+(this._terminalSelector+" span."+H.ITALIC_CLASS+" {")+" font-style: italic;}",r+="@keyframes blink { 0% { opacity: 1.0; } 50% { opacity: 0.0; } 100% { opacity: 1.0; }}",r+=this._terminalSelector+" ."+Z+":not(."+re+") ."+H.CURSOR_CLASS+" {"+(" outline: 1px solid "+this._colors.cursor.css+";")+" outline-offset: -1px;}"+(this._terminalSelector+" ."+Z+"."+re+" ."+H.CURSOR_CLASS+"."+H.CURSOR_BLINK_CLASS+" {")+" animation: blink 1s step-end infinite;}"+(this._terminalSelector+" ."+Z+"."+re+" ."+H.CURSOR_CLASS+"."+H.CURSOR_STYLE_BLOCK_CLASS+" {")+(" background-color: "+this._colors.cursor.css+";")+(" color: "+this._colors.cursorAccent.css+";")+"}"+(this._terminalSelector+" ."+Z+"."+re+" ."+H.CURSOR_CLASS+"."+H.CURSOR_STYLE_BAR_CLASS+" {")+(" box-shadow: 1px 0 0 "+this._colors.cursor.css+" inset;")+"}"+(this._terminalSelector+" ."+Z+"."+re+" ."+H.CURSOR_CLASS+"."+H.CURSOR_STYLE_UNDERLINE_CLASS+" {")+(" box-shadow: 0 -1px 0 "+this._colors.cursor.css+" inset;")+"}",r+=this._terminalSelector+" ."+yt+" { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}"+(this._terminalSelector+" ."+yt+" div {")+" position: absolute;"+(" background-color: "+this._colors.selection.css+";")+"}",this._colors.ansi.forEach(function(i,s){r+=e._terminalSelector+" ."+Mr+s+" { color: "+i.css+"; }"+(e._terminalSelector+" ."+Br+s+" { background-color: "+i.css+"; }")}),r+=this._terminalSelector+" ."+Mr+Dr.INVERTED_DEFAULT_COLOR+" { color: "+this._colors.background.css+"; }"+(this._terminalSelector+" ."+Br+Dr.INVERTED_DEFAULT_COLOR+" { background-color: "+this._colors.foreground.css+"; }"),this._themeStyleElement.innerHTML=r},t.prototype.onDevicePixelRatioChange=function(){this._updateDimensions()},t.prototype._refreshRowElements=function(e,r){for(var i=this._rowElements.length;i<=r;i++){var s=document.createElement("div");this._rowContainer.appendChild(s),this._rowElements.push(s)}for(;this._rowElements.length>r;)this._rowContainer.removeChild(this._rowElements.pop())},t.prototype.onResize=function(e,r){this._refreshRowElements(e,r),this._updateDimensions()},t.prototype.onCharSizeChanged=function(){this._updateDimensions()},t.prototype.onBlur=function(){this._rowContainer.classList.remove(re)},t.prototype.onFocus=function(){this._rowContainer.classList.add(re)},t.prototype.onSelectionChanged=function(e,r,i){for(;this._selectionContainer.children.length;)this._selectionContainer.removeChild(this._selectionContainer.children[0]);if(!(!e||!r)){var s=e[1]-this._terminal.buffer.ydisp,a=r[1]-this._terminal.buffer.ydisp,c=Math.max(s,0),o=Math.min(a,this._terminal.rows-1);if(!(c>=this._terminal.rows||o<0)){var l=document.createDocumentFragment();if(i)l.appendChild(this._createSelectionElement(c,e[0],r[0],o-c+1));else{var u=s===c?e[0]:0,h=c===o?r[0]:this._terminal.cols;l.appendChild(this._createSelectionElement(c,u,h));var f=o-c-1;if(l.appendChild(this._createSelectionElement(c+1,0,this._terminal.cols,f)),c!==o){var _=a===o?r[0]:this._terminal.cols;l.appendChild(this._createSelectionElement(o,0,_))}}this._selectionContainer.appendChild(l)}}},t.prototype._createSelectionElement=function(e,r,i,s){s===void 0&&(s=1);var a=document.createElement("div");return a.style.height=s*this.dimensions.actualCellHeight+"px",a.style.top=e*this.dimensions.actualCellHeight+"px",a.style.left=r*this.dimensions.actualCellWidth+"px",a.style.width=this.dimensions.actualCellWidth*(i-r)+"px",a},t.prototype.onCursorMove=function(){},t.prototype.onOptionsChanged=function(){this._updateDimensions(),this._injectCss(),this._terminal.refresh(0,this._terminal.rows-1)},t.prototype.clear=function(){this._rowElements.forEach(function(e){return e.innerHTML=""})},t.prototype.renderRows=function(e,r){for(var i=this._terminal,s=i.buffer.ybase+i.buffer.y,a=this._terminal.buffer.x,c=this._terminal.options.cursorBlink,o=e;o<=r;o++){var l=this._rowElements[o];l.innerHTML="";var u=o+i.buffer.ydisp,h=i.buffer.lines.get(u),f=i.options.cursorStyle;l.appendChild(this._rowFactory.createRow(h,u===s,f,a,c,this.dimensions.actualCellWidth,i.cols))}},Object.defineProperty(t.prototype,"_terminalSelector",{get:function(){return"."+mt+this._terminalClass},enumerable:!0,configurable:!0}),t.prototype.registerCharacterJoiner=function(e){return-1},t.prototype.deregisterCharacterJoiner=function(e){return!1},t.prototype._onLinkHover=function(e){this._setCellUnderline(e.x1,e.x2,e.y1,e.y2,e.cols,!0)},t.prototype._onLinkLeave=function(e){this._setCellUnderline(e.x1,e.x2,e.y1,e.y2,e.cols,!1)},t.prototype._setCellUnderline=function(e,r,i,s,a,c){for(;e!==r||i!==s;){var o=this._rowElements[i];if(!o)return;var l=o.children[e];l&&(l.style.textDecoration=c?"underline":"none"),++e>=a&&(e=0,i++)}},t}(Vo.Disposable);rr.DomRenderer=Yo;var ir={};Object.defineProperty(ir,"__esModule",{value:!0});var y=Re,Xo={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};function Jo(n,t,e,r){var i={type:0,cancel:!1,key:void 0},s=(n.shiftKey?1:0)|(n.altKey?2:0)|(n.ctrlKey?4:0)|(n.metaKey?8:0);switch(n.keyCode){case 0:n.key==="UIKeyInputUpArrow"?t?i.key=y.C0.ESC+"OA":i.key=y.C0.ESC+"[A":n.key==="UIKeyInputLeftArrow"?t?i.key=y.C0.ESC+"OD":i.key=y.C0.ESC+"[D":n.key==="UIKeyInputRightArrow"?t?i.key=y.C0.ESC+"OC":i.key=y.C0.ESC+"[C":n.key==="UIKeyInputDownArrow"&&(t?i.key=y.C0.ESC+"OB":i.key=y.C0.ESC+"[B");break;case 8:if(n.shiftKey){i.key=y.C0.BS;break}else if(n.altKey){i.key=y.C0.ESC+y.C0.DEL;break}i.key=y.C0.DEL;break;case 9:if(n.shiftKey){i.key=y.C0.ESC+"[Z";break}i.key=y.C0.HT,i.cancel=!0;break;case 13:i.key=y.C0.CR,i.cancel=!0;break;case 27:i.key=y.C0.ESC,i.cancel=!0;break;case 37:s?(i.key=y.C0.ESC+"[1;"+(s+1)+"D",i.key===y.C0.ESC+"[1;3D"&&(i.key=e?y.C0.ESC+"b":y.C0.ESC+"[1;5D")):t?i.key=y.C0.ESC+"OD":i.key=y.C0.ESC+"[D";break;case 39:s?(i.key=y.C0.ESC+"[1;"+(s+1)+"C",i.key===y.C0.ESC+"[1;3C"&&(i.key=e?y.C0.ESC+"f":y.C0.ESC+"[1;5C")):t?i.key=y.C0.ESC+"OC":i.key=y.C0.ESC+"[C";break;case 38:s?(i.key=y.C0.ESC+"[1;"+(s+1)+"A",i.key===y.C0.ESC+"[1;3A"&&(i.key=y.C0.ESC+"[1;5A")):t?i.key=y.C0.ESC+"OA":i.key=y.C0.ESC+"[A";break;case 40:s?(i.key=y.C0.ESC+"[1;"+(s+1)+"B",i.key===y.C0.ESC+"[1;3B"&&(i.key=y.C0.ESC+"[1;5B")):t?i.key=y.C0.ESC+"OB":i.key=y.C0.ESC+"[B";break;case 45:!n.shiftKey&&!n.ctrlKey&&(i.key=y.C0.ESC+"[2~");break;case 46:s?i.key=y.C0.ESC+"[3;"+(s+1)+"~":i.key=y.C0.ESC+"[3~";break;case 36:s?i.key=y.C0.ESC+"[1;"+(s+1)+"H":t?i.key=y.C0.ESC+"OH":i.key=y.C0.ESC+"[H";break;case 35:s?i.key=y.C0.ESC+"[1;"+(s+1)+"F":t?i.key=y.C0.ESC+"OF":i.key=y.C0.ESC+"[F";break;case 33:n.shiftKey?i.type=2:i.key=y.C0.ESC+"[5~";break;case 34:n.shiftKey?i.type=3:i.key=y.C0.ESC+"[6~";break;case 112:s?i.key=y.C0.ESC+"[1;"+(s+1)+"P":i.key=y.C0.ESC+"OP";break;case 113:s?i.key=y.C0.ESC+"[1;"+(s+1)+"Q":i.key=y.C0.ESC+"OQ";break;case 114:s?i.key=y.C0.ESC+"[1;"+(s+1)+"R":i.key=y.C0.ESC+"OR";break;case 115:s?i.key=y.C0.ESC+"[1;"+(s+1)+"S":i.key=y.C0.ESC+"OS";break;case 116:s?i.key=y.C0.ESC+"[15;"+(s+1)+"~":i.key=y.C0.ESC+"[15~";break;case 117:s?i.key=y.C0.ESC+"[17;"+(s+1)+"~":i.key=y.C0.ESC+"[17~";break;case 118:s?i.key=y.C0.ESC+"[18;"+(s+1)+"~":i.key=y.C0.ESC+"[18~";break;case 119:s?i.key=y.C0.ESC+"[19;"+(s+1)+"~":i.key=y.C0.ESC+"[19~";break;case 120:s?i.key=y.C0.ESC+"[20;"+(s+1)+"~":i.key=y.C0.ESC+"[20~";break;case 121:s?i.key=y.C0.ESC+"[21;"+(s+1)+"~":i.key=y.C0.ESC+"[21~";break;case 122:s?i.key=y.C0.ESC+"[23;"+(s+1)+"~":i.key=y.C0.ESC+"[23~";break;case 123:s?i.key=y.C0.ESC+"[24;"+(s+1)+"~":i.key=y.C0.ESC+"[24~";break;default:if(n.ctrlKey&&!n.shiftKey&&!n.altKey&&!n.metaKey)n.keyCode>=65&&n.keyCode<=90?i.key=String.fromCharCode(n.keyCode-64):n.keyCode===32?i.key=String.fromCharCode(0):n.keyCode>=51&&n.keyCode<=55?i.key=String.fromCharCode(n.keyCode-51+27):n.keyCode===56?i.key=String.fromCharCode(127):n.keyCode===219?i.key=String.fromCharCode(27):n.keyCode===220?i.key=String.fromCharCode(28):n.keyCode===221&&(i.key=String.fromCharCode(29));else if((!e||r)&&n.altKey&&!n.metaKey){var a=Xo[n.keyCode],c=a&&a[n.shiftKey?1:0];if(c)i.key=y.C0.ESC+c;else if(n.keyCode>=65&&n.keyCode<=90){var o=n.ctrlKey?n.keyCode-64:n.keyCode+32;i.key=y.C0.ESC+String.fromCharCode(o)}}else e&&!n.altKey&&!n.ctrlKey&&n.metaKey?n.keyCode===65&&(i.type=1):n.key&&!n.ctrlKey&&!n.altKey&&!n.metaKey&&n.keyCode>=48&&n.key.length===1?i.key=n.key:n.key&&n.ctrlKey&&n.key==="_"&&(i.key=y.C0.US);break}return i}ir.evaluateKeyboardEvent=Jo;var nr={};Object.defineProperty(nr,"__esModule",{value:!0});function _i(n,t){if(t===void 0&&(t=5),typeof n!="object")return n;if(n===null)return null;var e=Array.isArray(n)?[]:{};for(var r in n)e[r]=t<=1?n[r]:_i(n[r],t-1);return e}nr.clone=_i;var sr={};Object.defineProperty(sr,"__esModule",{value:!0});var ze=q;function Zo(n){return n.onLineFeed(function(){var t=n.buffer.lines.get(n.buffer.ybase+n.buffer.y-1),e=t.get(n.cols-1),r=n.buffer.lines.get(n.buffer.ybase+n.buffer.y);r.isWrapped=e[ze.CHAR_DATA_CODE_INDEX]!==ze.NULL_CELL_CODE&&e[ze.CHAR_DATA_CODE_INDEX]!==ze.WHITESPACE_CELL_CODE})}sr.applyWindowsMode=Zo;var or={},Qo=C&&C.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(t,e)};return function(t,e){n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(or,"__esModule",{value:!0});var ea=st,gt=z,ta=F,ra=ot,ia=se,na=function(n){Qo(t,n);function t(e,r,i){var s=n.call(this)||this;if(s._renderer=e,s._rowCount=r,s._isPaused=!1,s._needsFullRefresh=!1,s._canvasWidth=0,s._canvasHeight=0,s._onDimensionsChange=new gt.EventEmitter2,s._onRender=new gt.EventEmitter2,s._onRefreshRequest=new gt.EventEmitter2,s._renderDebouncer=new ea.RenderDebouncer(function(c,o){return s._renderRows(c,o)}),s.register(s._renderDebouncer),s._screenDprMonitor=new ra.ScreenDprMonitor,s._screenDprMonitor.setListener(function(){return s._renderer.onDevicePixelRatioChange()}),s.register(s._screenDprMonitor),s.register(ia.addDisposableDomListener(window,"resize",function(){return s._renderer.onDevicePixelRatioChange()})),"IntersectionObserver"in window){var a=new IntersectionObserver(function(c){return s._onIntersectionChange(c[c.length-1])},{threshold:0});a.observe(i),s.register({dispose:function(){return a.disconnect()}})}return s}return Object.defineProperty(t.prototype,"onDimensionsChange",{get:function(){return this._onDimensionsChange.event},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onRender",{get:function(){return this._onRender.event},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onRefreshRequest",{get:function(){return this._onRefreshRequest.event},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dimensions",{get:function(){return this._renderer.dimensions},enumerable:!0,configurable:!0}),t.prototype._onIntersectionChange=function(e){this._isPaused=e.intersectionRatio===0,!this._isPaused&&this._needsFullRefresh&&(this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)},t.prototype.refreshRows=function(e,r){if(this._isPaused){this._needsFullRefresh=!0;return}this._renderDebouncer.refresh(e,r,this._rowCount)},t.prototype._renderRows=function(e,r){this._renderer.renderRows(e,r),this._onRender.fire({start:e,end:r})},t.prototype.resize=function(e,r){this._rowCount=r,this._fireOnCanvasResize()},t.prototype.changeOptions=function(){this._renderer.onOptionsChanged(),this._fireOnCanvasResize()},t.prototype._fireOnCanvasResize=function(){this._renderer.dimensions.canvasWidth===this._canvasWidth&&this._renderer.dimensions.canvasHeight===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.dimensions)},t.prototype.setRenderer=function(e){this._renderer.dispose(),this._renderer=e},t.prototype._fullRefresh=function(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount)},t.prototype.setColors=function(e){this._renderer.setColors(e),this._fullRefresh()},t.prototype.onDevicePixelRatioChange=function(){this._renderer.onDevicePixelRatioChange()},t.prototype.onResize=function(e,r){this._renderer.onResize(e,r),this._fullRefresh()},t.prototype.onCharSizeChanged=function(){this._renderer.onCharSizeChanged()},t.prototype.onBlur=function(){this._renderer.onBlur()},t.prototype.onFocus=function(){this._renderer.onFocus()},t.prototype.onSelectionChanged=function(e,r,i){this._renderer.onSelectionChanged(e,r,i)},t.prototype.onCursorMove=function(){this._renderer.onCursorMove()},t.prototype.onOptionsChanged=function(){this._renderer.onOptionsChanged()},t.prototype.clear=function(){this._renderer.clear()},t.prototype.registerCharacterJoiner=function(e){return this._renderer.registerCharacterJoiner(e)},t.prototype.deregisterCharacterJoiner=function(e){return this._renderer.deregisterCharacterJoiner(e)},t}(ta.Disposable);or.RenderCoordinator=na;var sa=C&&C.__extends||function(){var n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(t,e)};return function(t,e){n(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(kt,"__esModule",{value:!0});var oa=Dt,aa=Mt,la=Ht,ha=Ft,ca=Pt,xe=ee,N=Re,ua=It,fa=Wt,_a=Xt,da=Jt,pa=er,Ee=O,R=se,ma=ae,ya=it,di=nt,ga=Oe,Or=tr,va=Te,Ca=rr,ba=ir,wa=nr,X=z,vt=q,Hr=sr,xa=$t,Sa=or,B=typeof window<"u"?window.document:null,Fr=5,Pr=12,Ir=50,Ct=2,bt=1,Ea=["cols","rows"],qe={cols:80,rows:24,convertEol:!1,termName:"xterm",cursorBlink:!1,cursorStyle:"block",bellSound:di.DEFAULT_BELL_SOUND,bellStyle:"none",drawBoldTextInBrightColors:!0,enableBold:!0,experimentalCharAtlas:"static",fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",lineHeight:1,letterSpacing:0,scrollback:1e3,screenKeys:!1,screenReaderMode:!1,debug:!1,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,cancelEvents:!1,disableStdin:!1,useFlowControl:!1,allowTransparency:!1,tabStopWidth:8,theme:void 0,rightClickSelectsWord:Ee.isMac,rendererType:"canvas",windowsMode:!1},Aa=function(n){sa(t,n);function t(e){e===void 0&&(e={});var r=n.call(this)||this;return r.browser=Ee,r._blankLine=null,r._onCursorMove=new X.EventEmitter2,r._onData=new X.EventEmitter2,r._onKey=new X.EventEmitter2,r._onLineFeed=new X.EventEmitter2,r._onRender=new X.EventEmitter2,r._onResize=new X.EventEmitter2,r._onScroll=new X.EventEmitter2,r._onSelectionChange=new X.EventEmitter2,r._onTitleChange=new X.EventEmitter2,r.options=wa.clone(e),r._setup(),r.onCursorMove(function(){return r.emit("cursormove")}),r.onData(function(i){return r.emit("data",i)}),r.onKey(function(i){return r.emit("key",i.key,i.domEvent)}),r.onLineFeed(function(){return r.emit("linefeed")}),r.onRender(function(i){return r.emit("refresh",i)}),r.onResize(function(i){return r.emit("resize",i)}),r.onSelectionChange(function(){return r.emit("selection")}),r.onScroll(function(i){return r.emit("scroll",i)}),r.onTitleChange(function(i){return r.emit("title",i)}),r}return Object.defineProperty(t.prototype,"onCursorMove",{get:function(){return this._onCursorMove.event},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onData",{get:function(){return this._onData.event},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onKey",{get:function(){return this._onKey.event},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onLineFeed",{get:function(){return this._onLineFeed.event},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onRender",{get:function(){return this._onRender.event},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onResize",{get:function(){return this._onResize.event},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onScroll",{get:function(){return this._onScroll.event},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onSelectionChange",{get:function(){return this._onSelectionChange.event},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onTitleChange",{get:function(){return this._onTitleChange.event},enumerable:!0,configurable:!0}),t.prototype.dispose=function(){n.prototype.dispose.call(this),this._windowsMode&&(this._windowsMode.dispose(),this._windowsMode=void 0),this._customKeyEventHandler=null,va.removeTerminalFromCache(this),this.handler=function(){},this.write=function(){},this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element)},t.prototype.destroy=function(){this.dispose()},t.prototype._setup=function(){var e=this;Object.keys(qe).forEach(function(r){(e.options[r]===null||e.options[r]===void 0)&&(e.options[r]=qe[r])}),this._parent=B?B.body:null,this.cols=Math.max(this.options.cols,Ct),this.rows=Math.max(this.options.rows,bt),this.options.handler&&this.onData(this.options.handler),this.cursorState=0,this.cursorHidden=!1,this._customKeyEventHandler=null,this.applicationKeypad=!1,this.applicationCursor=!1,this.originMode=!1,this.insertMode=!1,this.wraparoundMode=!0,this.bracketedPasteMode=!1,this.charset=null,this.gcharset=null,this.glevel=0,this.charsets=[null],this.curAttrData=vt.DEFAULT_ATTR_DATA.clone(),this._eraseAttrData=vt.DEFAULT_ATTR_DATA.clone(),this.params=[],this.currentParam=0,this.writeBuffer=[],this.writeBufferUtf8=[],this._writeInProgress=!1,this._xoffSentToCatchUp=!1,this._userScrolling=!1,this._inputHandler=new ua.InputHandler(this),this._inputHandler.onCursorMove(function(){return e._onCursorMove.fire()}),this._inputHandler.onLineFeed(function(){return e._onLineFeed.fire()}),this._inputHandler.onData(function(r){return e._onData.fire(r)}),this.register(this._inputHandler),this.selectionManager=this.selectionManager||null,this.linkifier=this.linkifier||new _a.Linkifier(this),this._mouseZoneManager=this._mouseZoneManager||null,this.soundManager=this.soundManager||new di.SoundManager(this),this.buffers=new oa.BufferSet(this),this.selectionManager&&(this.selectionManager.clearSelection(),this.selectionManager.initBuffersListeners()),this.options.windowsMode&&(this._windowsMode=Hr.applyWindowsMode(this))},Object.defineProperty(t.prototype,"buffer",{get:function(){return this.buffers.active},enumerable:!0,configurable:!0}),t.prototype.eraseAttrData=function(){return this._eraseAttrData.bg&=-67108864,this._eraseAttrData.bg|=this.curAttrData.bg&67108863,this._eraseAttrData},t.prototype.focus=function(){this.textarea&&this.textarea.focus({preventScroll:!0})},Object.defineProperty(t.prototype,"isFocused",{get:function(){return B.activeElement===this.textarea&&B.hasFocus()},enumerable:!0,configurable:!0}),t.prototype.getOption=function(e){if(!(e in qe))throw new Error('No option with key "'+e+'"');return this.options[e]},t.prototype.setOption=function(e,r){if(!(e in qe))throw new Error('No option with key "'+e+'"');if(Ea.indexOf(e)!==-1&&console.error('Option "'+e+'" can only be set in the constructor'),this.options[e]!==r){switch(e){case"bellStyle":r||(r="none");break;case"cursorStyle":r||(r="block");break;case"fontWeight":r||(r="normal");break;case"fontWeightBold":r||(r="bold");break;case"lineHeight":if(r<1){console.warn(e+" cannot be less than 1, value: "+r);return}case"rendererType":r||(r="canvas");break;case"tabStopWidth":if(r<1){console.warn(e+" cannot be less than 1, value: "+r);return}break;case"theme":this._setTheme(r);break;case"scrollback":if(r=Math.min(r,aa.MAX_BUFFER_SIZE),r<0){console.warn(e+" cannot be less than 0, value: "+r);return}if(this.options[e]!==r){var i=this.rows+r;if(this.buffer.lines.length>i){var s=this.buffer.lines.length-i,a=this.buffer.ydisp-s<0;this.buffer.lines.trimStart(s),this.buffer.ybase=Math.max(this.buffer.ybase-s,0),this.buffer.ydisp=Math.max(this.buffer.ydisp-s,0),a&&this.refresh(0,this.rows-1)}}break}switch(this.options[e]=r,e){case"fontFamily":case"fontSize":this._renderCoordinator&&(this._renderCoordinator.clear(),this.charMeasure.measure(this.options));break;case"drawBoldTextInBrightColors":case"experimentalCharAtlas":case"enableBold":case"letterSpacing":case"lineHeight":case"fontWeight":case"fontWeightBold":this._renderCoordinator&&(this._renderCoordinator.clear(),this._renderCoordinator.onResize(this.cols,this.rows),this.refresh(0,this.rows-1));break;case"rendererType":this._renderCoordinator&&this._renderCoordinator.setRenderer(this._createRenderer());break;case"scrollback":this.buffers.resize(this.cols,this.rows),this.viewport&&this.viewport.syncScrollArea();break;case"screenReaderMode":r?!this._accessibilityManager&&this._renderCoordinator&&(this._accessibilityManager=new Or.AccessibilityManager(this,this._renderCoordinator.dimensions)):this._accessibilityManager&&(this._accessibilityManager.dispose(),this._accessibilityManager=null);break;case"tabStopWidth":this.buffers.setupTabStops();break;case"windowsMode":r?this._windowsMode||(this._windowsMode=Hr.applyWindowsMode(this)):this._windowsMode&&(this._windowsMode.dispose(),this._windowsMode=void 0);break}this._renderCoordinator&&this._renderCoordinator.onOptionsChanged()}},t.prototype._onTextAreaFocus=function(e){this.sendFocus&&this.handler(N.C0.ESC+"[I"),this.updateCursorStyle(e),this.element.classList.add("focus"),this.showCursor(),this.emit("focus")},t.prototype.blur=function(){return this.textarea.blur()},t.prototype._onTextAreaBlur=function(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.sendFocus&&this.handler(N.C0.ESC+"[O"),this.element.classList.remove("focus"),this.emit("blur")},t.prototype._initGlobal=function(){var e=this;this._bindKeys(),this.register(R.addDisposableDomListener(this.element,"copy",function(i){e.hasSelection()&&xe.copyHandler(i,e,e.selectionManager)}));var r=function(i){return xe.pasteHandler(i,e)};this.register(R.addDisposableDomListener(this.textarea,"paste",r)),this.register(R.addDisposableDomListener(this.element,"paste",r)),Ee.isFirefox?this.register(R.addDisposableDomListener(this.element,"mousedown",function(i){i.button===2&&xe.rightClickHandler(i,e,e.selectionManager,e.options.rightClickSelectsWord)})):this.register(R.addDisposableDomListener(this.element,"contextmenu",function(i){xe.rightClickHandler(i,e,e.selectionManager,e.options.rightClickSelectsWord)})),Ee.isLinux&&this.register(R.addDisposableDomListener(this.element,"auxclick",function(i){i.button===1&&xe.moveTextAreaUnderMouseCursor(i,e)}))},t.prototype._bindKeys=function(){var e=this,r=this;this.register(R.addDisposableDomListener(this.element,"keydown",function(i){B.activeElement===this&&r._keyDown(i)},!0)),this.register(R.addDisposableDomListener(this.element,"keypress",function(i){B.activeElement===this&&r._keyPress(i)},!0)),this.register(R.addDisposableDomListener(this.element,"keyup",function(i){La(i)||e.focus(),r._keyUp(i)},!0)),this.register(R.addDisposableDomListener(this.textarea,"keydown",function(i){return e._keyDown(i)},!0)),this.register(R.addDisposableDomListener(this.textarea,"keypress",function(i){return e._keyPress(i)},!0)),this.register(R.addDisposableDomListener(this.textarea,"compositionstart",function(){return e._compositionHelper.compositionstart()})),this.register(R.addDisposableDomListener(this.textarea,"compositionupdate",function(i){return e._compositionHelper.compositionupdate(i)})),this.register(R.addDisposableDomListener(this.textarea,"compositionend",function(){return e._compositionHelper.compositionend()})),this.register(this.onRender(function(){return e._compositionHelper.updateCompositionElements()})),this.register(this.onRender(function(i){return e._queueLinkification(i.start,i.end)}))},t.prototype.open=function(e){var r=this;if(this._parent=e||this._parent,!this._parent)throw new Error("Terminal requires a parent element.");this._context=this._parent.ownerDocument.defaultView,this._document=this._parent.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),this.element.setAttribute("tabindex","0"),this._parent.appendChild(this.element);var i=B.createDocumentFragment();this._viewportElement=B.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),i.appendChild(this._viewportElement),this._viewportScrollArea=B.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=B.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=B.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),i.appendChild(this.screenElement),this._mouseZoneManager=new ga.MouseZoneManager(this),this.register(this._mouseZoneManager),this.register(this.onScroll(function(){return r._mouseZoneManager.clearAll()})),this.linkifier.attachToDom(this._mouseZoneManager),this.textarea=B.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",ma.promptLabel),this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this.register(R.addDisposableDomListener(this.textarea,"focus",function(a){return r._onTextAreaFocus(a)})),this.register(R.addDisposableDomListener(this.textarea,"blur",function(){return r._onTextAreaBlur()})),this._helperContainer.appendChild(this.textarea),this._compositionView=B.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=new la.CompositionHelper(this.textarea,this._compositionView,this),this._helperContainer.appendChild(this._compositionView),this.charMeasure=new pa.CharMeasure(B,this._helperContainer),this.element.appendChild(i),this._theme=this.options.theme,this._colorManager=new xa.ColorManager(B,this.options.allowTransparency),this._colorManager.setTheme(this._theme);var s=this._createRenderer();this._renderCoordinator=new Sa.RenderCoordinator(s,this.rows,this.screenElement),this._renderCoordinator.onRender(function(a){return r._onRender.fire(a)}),this.onResize(function(a){return r._renderCoordinator.resize(a.cols,a.rows)}),this.viewport=new ca.Viewport(this,this._viewportElement,this._viewportScrollArea,this.charMeasure,this._renderCoordinator.dimensions),this.viewport.onThemeChange(this._colorManager.colors),this.register(this.viewport),this.register(this.onCursorMove(function(){return r._renderCoordinator.onCursorMove()})),this.register(this.onResize(function(){return r._renderCoordinator.onResize(r.cols,r.rows)})),this.register(this.addDisposableListener("blur",function(){return r._renderCoordinator.onBlur()})),this.register(this.addDisposableListener("focus",function(){return r._renderCoordinator.onFocus()})),this.register(this.charMeasure.onCharSizeChanged(function(){return r._renderCoordinator.onCharSizeChanged()})),this.register(this._renderCoordinator.onDimensionsChange(function(){return r.viewport.syncScrollArea()})),this.selectionManager=new da.SelectionManager(this,this.charMeasure),this.register(this.selectionManager.onSelectionChange(function(){return r._onSelectionChange.fire()})),this.register(R.addDisposableDomListener(this.element,"mousedown",function(a){return r.selectionManager.onMouseDown(a)})),this.register(this.selectionManager.onRedrawRequest(function(a){return r._renderCoordinator.onSelectionChanged(a.start,a.end,a.columnSelectMode)})),this.register(this.selectionManager.onLinuxMouseSelection(function(a){r.textarea.value=a,r.textarea.focus(),r.textarea.select()})),this.register(this.onScroll(function(){r.viewport.syncScrollArea(),r.selectionManager.refresh()})),this.register(R.addDisposableDomListener(this._viewportElement,"scroll",function(){return r.selectionManager.refresh()})),this.mouseHelper=new ya.MouseHelper(this._renderCoordinator),this.element.classList.toggle("enable-mouse-events",this.mouseEvents),this.mouseEvents?this.selectionManager.disable():this.selectionManager.enable(),this.options.screenReaderMode&&(this._accessibilityManager=new Or.AccessibilityManager(this,this._renderCoordinator.dimensions),this._accessibilityManager.register(this._renderCoordinator.onDimensionsChange(function(a){return r._accessibilityManager.setDimensions(a)}))),this.charMeasure.measure(this.options),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()},t.prototype._createRenderer=function(){switch(this.options.rendererType){case"canvas":return new fa.Renderer(this,this._colorManager.colors);case"dom":return new Ca.DomRenderer(this,this._colorManager.colors);default:throw new Error('Unrecognized rendererType "'+this.options.rendererType+'"')}},t.prototype._setTheme=function(e){this._theme=e,this._colorManager&&this._colorManager.setTheme(e),this._renderCoordinator&&this._renderCoordinator.setColors(this._colorManager.colors),this.viewport&&this.viewport.onThemeChange(this._colorManager.colors)},t.prototype.bindMouse=function(){var e=this,r=this.element,i=this,s=32;function a(h){var f,_;if(f=u(h),_=i.mouseHelper.getRawByteCoords(h,i.screenElement,i.charMeasure,i.cols,i.rows),!!_)switch(l(f,_),h.overrideType||h.type){case"mousedown":s=f;break;case"mouseup":s=32;break}}function c(h){var f=s,_=i.mouseHelper.getRawByteCoords(h,i.screenElement,i.charMeasure,i.cols,i.rows);_&&(f+=32,l(f,_))}function o(h,f){if(i.utfMouse){if(f>2047){h.push(2047);return}h.push(f)}else{if(f===255){h.push(0);return}f>127&&(f=127),h.push(f)}}function l(h,f){if(i._vt300Mouse){h&=3,f.x-=32,f.y-=32;var _=N.C0.ESC+"[24";if(h===0)_+="1";else if(h===1)_+="3";else if(h===2)_+="5";else{if(h===3)return;_+="0"}_+="~["+f.x+","+f.y+"]\r",i.handler(_);return}if(i._decLocator){h&=3,f.x-=32,f.y-=32,h===0?h=2:h===1?h=4:h===2?h=6:h===3&&(h=3),i.handler(N.C0.ESC+"["+h+";"+(h===3?4:0)+";"+f.y+";"+f.x+";"+f.page||0+"&w");return}if(i.urxvtMouse){f.x-=32,f.y-=32,f.x++,f.y++,i.handler(N.C0.ESC+"["+h+";"+f.x+";"+f.y+"M");return}if(i.sgrMouse){f.x-=32,f.y-=32,i.handler(N.C0.ESC+"[<"+(((h&3)===3?h&-4:h)-32)+";"+f.x+";"+f.y+((h&3)===3?"m":"M"));return}var d=[];o(d,h),o(d,f.x),o(d,f.y),i.handler(N.C0.ESC+"[M"+String.fromCharCode.apply(String,d))}function u(h){var f,_,d,p,m;switch(h.overrideType||h.type){case"mousedown":f=h.button!==null&&h.button!==void 0?+h.button:h.which!==null&&h.which!==void 0?h.which-1:null,Ee.isMSIE&&(f=f===1?0:f===4?1:f);break;case"mouseup":f=3;break;case"DOMMouseScroll":f=h.detail<0?64:65;break;case"wheel":f=h.deltaY<0?64:65;break}return _=h.shiftKey?4:0,d=h.metaKey?8:0,p=h.ctrlKey?16:0,m=_|d|p,i.vt200Mouse?m&=p:i.normalMouse||(m=0),f=32+(m<<2)+f,f}this.register(R.addDisposableDomListener(r,"mousedown",function(h){if(h.preventDefault(),e.focus(),!(!e.mouseEvents||e.selectionManager.shouldForceSelection(h))){if(a(h),e.vt200Mouse)return h.overrideType="mouseup",a(h),e.cancel(h);var f;e.normalMouse&&(f=function(d){e.normalMouse&&c(d)},e._document.addEventListener("mousemove",f));var _=function(d){return e.normalMouse&&!e.x10Mouse&&a(d),f&&(e._document.removeEventListener("mousemove",f),f=null),e._document.removeEventListener("mouseup",_),e.cancel(d)};return e._document.addEventListener("mouseup",_),e.cancel(h)}})),this.register(R.addDisposableDomListener(r,"wheel",function(h){if(!e.mouseEvents){if(!e.buffer.hasScrollback){var f=e.viewport.getLinesScrolled(h);if(f===0)return;for(var _=N.C0.ESC+(e.applicationCursor?"O":"[")+(h.deltaY<0?"A":"B"),d="",p=0;p<Math.abs(f);p++)d+=_;e.handler(d)}return}e.x10Mouse||e._vt300Mouse||e._decLocator||(a(h),h.preventDefault())})),this.register(R.addDisposableDomListener(r,"wheel",function(h){if(!e.mouseEvents)return e.viewport.onWheel(h),e.cancel(h)})),this.register(R.addDisposableDomListener(r,"touchstart",function(h){if(!e.mouseEvents)return e.viewport.onTouchStart(h),e.cancel(h)})),this.register(R.addDisposableDomListener(r,"touchmove",function(h){if(!e.mouseEvents)return e.viewport.onTouchMove(h),e.cancel(h)}))},t.prototype.refresh=function(e,r){this._renderCoordinator&&this._renderCoordinator.refreshRows(e,r)},t.prototype._queueLinkification=function(e,r){this.linkifier&&this.linkifier.linkifyRows(e,r)},t.prototype.updateCursorStyle=function(e){this.selectionManager&&this.selectionManager.shouldColumnSelect(e)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")},t.prototype.showCursor=function(){this.cursorState||(this.cursorState=1,this.refresh(this.buffer.y,this.buffer.y))},t.prototype.scroll=function(e){e===void 0&&(e=!1);var r;r=this._blankLine;var i=this.eraseAttrData();(!r||r.length!==this.cols||r.getFg(0)!==i.fg||r.getBg(0)!==i.bg)&&(r=this.buffer.getBlankLine(i,e),this._blankLine=r),r.isWrapped=e;var s=this.buffer.ybase+this.buffer.scrollTop,a=this.buffer.ybase+this.buffer.scrollBottom;if(this.buffer.scrollTop===0){var c=this.buffer.lines.isFull;a===this.buffer.lines.length-1?c?this.buffer.lines.recycle().copyFrom(r):this.buffer.lines.push(r.clone()):this.buffer.lines.splice(a+1,0,r.clone()),c?this._userScrolling&&(this.buffer.ydisp=Math.max(this.buffer.ydisp-1,0)):(this.buffer.ybase++,this._userScrolling||this.buffer.ydisp++)}else{var o=a-s+1;this.buffer.lines.shiftElements(s+1,o-1,-1),this.buffer.lines.set(a,r.clone())}this._userScrolling||(this.buffer.ydisp=this.buffer.ybase),this.updateRange(this.buffer.scrollTop),this.updateRange(this.buffer.scrollBottom),this._onScroll.fire(this.buffer.ydisp)},t.prototype.scrollLines=function(e,r){if(e<0){if(this.buffer.ydisp===0)return;this._userScrolling=!0}else e+this.buffer.ydisp>=this.buffer.ybase&&(this._userScrolling=!1);var i=this.buffer.ydisp;this.buffer.ydisp=Math.max(Math.min(this.buffer.ydisp+e,this.buffer.ybase),0),i!==this.buffer.ydisp&&(r||this._onScroll.fire(this.buffer.ydisp),this.refresh(0,this.rows-1))},t.prototype.scrollPages=function(e){this.scrollLines(e*(this.rows-1))},t.prototype.scrollToTop=function(){this.scrollLines(-this.buffer.ydisp)},t.prototype.scrollToBottom=function(){this.scrollLines(this.buffer.ybase-this.buffer.ydisp)},t.prototype.scrollToLine=function(e){var r=e-this.buffer.ydisp;r!==0&&this.scrollLines(r)},t.prototype.writeUtf8=function(e){var r=this;this._isDisposed||e&&(this.writeBufferUtf8.push(e),this.options.useFlowControl&&!this._xoffSentToCatchUp&&this.writeBufferUtf8.length>=Fr&&(this.handler(N.C0.DC3),this._xoffSentToCatchUp=!0),!this._writeInProgress&&this.writeBufferUtf8.length>0&&(this._writeInProgress=!0,setTimeout(function(){r._innerWriteUtf8()})))},t.prototype._innerWriteUtf8=function(e){var r=this;e===void 0&&(e=0),this._isDisposed&&(this.writeBufferUtf8=[]);for(var i=Date.now();this.writeBufferUtf8.length>e;){var s=this.writeBufferUtf8[e];if(e++,this._xoffSentToCatchUp&&this.writeBufferUtf8.length===e&&(this.handler(N.C0.DC1),this._xoffSentToCatchUp=!1),this._refreshStart=this.buffer.y,this._refreshEnd=this.buffer.y,this._inputHandler.parseUtf8(s),this.updateRange(this.buffer.y),this.refresh(this._refreshStart,this._refreshEnd),Date.now()-i>=Pr)break}this.writeBufferUtf8.length>e?(e>Ir&&(this.writeBufferUtf8=this.writeBufferUtf8.slice(e),e=0),setTimeout(function(){return r._innerWriteUtf8(e)},0)):(this._writeInProgress=!1,this.writeBufferUtf8=[])},t.prototype.write=function(e){var r=this;this._isDisposed||e&&(this.writeBuffer.push(e),this.options.useFlowControl&&!this._xoffSentToCatchUp&&this.writeBuffer.length>=Fr&&(this.handler(N.C0.DC3),this._xoffSentToCatchUp=!0),!this._writeInProgress&&this.writeBuffer.length>0&&(this._writeInProgress=!0,setTimeout(function(){r._innerWrite()})))},t.prototype._innerWrite=function(e){var r=this;e===void 0&&(e=0),this._isDisposed&&(this.writeBuffer=[]);for(var i=Date.now();this.writeBuffer.length>e;){var s=this.writeBuffer[e];if(e++,this._xoffSentToCatchUp&&this.writeBuffer.length===e&&(this.handler(N.C0.DC1),this._xoffSentToCatchUp=!1),this._refreshStart=this.buffer.y,this._refreshEnd=this.buffer.y,this._inputHandler.parse(s),this.updateRange(this.buffer.y),this.refresh(this._refreshStart,this._refreshEnd),Date.now()-i>=Pr)break}this.writeBuffer.length>e?(e>Ir&&(this.writeBuffer=this.writeBuffer.slice(e),e=0),setTimeout(function(){return r._innerWrite(e)},0)):(this._writeInProgress=!1,this.writeBuffer=[])},t.prototype.writeln=function(e){this.write(e+`\r
`)},t.prototype.attachCustomKeyEventHandler=function(e){this._customKeyEventHandler=e},t.prototype.addCsiHandler=function(e,r){return this._inputHandler.addCsiHandler(e,r)},t.prototype.addOscHandler=function(e,r){return this._inputHandler.addOscHandler(e,r)},t.prototype.registerLinkMatcher=function(e,r,i){var s=this.linkifier.registerLinkMatcher(e,r,i);return this.refresh(0,this.rows-1),s},t.prototype.deregisterLinkMatcher=function(e){this.linkifier.deregisterLinkMatcher(e)&&this.refresh(0,this.rows-1)},t.prototype.registerCharacterJoiner=function(e){var r=this._renderCoordinator.registerCharacterJoiner(e);return this.refresh(0,this.rows-1),r},t.prototype.deregisterCharacterJoiner=function(e){this._renderCoordinator.deregisterCharacterJoiner(e)&&this.refresh(0,this.rows-1)},Object.defineProperty(t.prototype,"markers",{get:function(){return this.buffer.markers},enumerable:!0,configurable:!0}),t.prototype.addMarker=function(e){if(this.buffer===this.buffers.normal)return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+e)},t.prototype.hasSelection=function(){return this.selectionManager?this.selectionManager.hasSelection:!1},t.prototype.select=function(e,r,i){this.selectionManager.setSelection(e,r,i)},t.prototype.getSelection=function(){return this.selectionManager?this.selectionManager.selectionText:""},t.prototype.getSelectionPosition=function(){if(this.selectionManager.hasSelection)return{startColumn:this.selectionManager.selectionStart[0],startRow:this.selectionManager.selectionStart[1],endColumn:this.selectionManager.selectionEnd[0],endRow:this.selectionManager.selectionEnd[1]}},t.prototype.clearSelection=function(){this.selectionManager&&this.selectionManager.clearSelection()},t.prototype.selectAll=function(){this.selectionManager&&this.selectionManager.selectAll()},t.prototype.selectLines=function(e,r){this.selectionManager&&this.selectionManager.selectLines(e,r)},t.prototype._keyDown=function(e){if(this._customKeyEventHandler&&this._customKeyEventHandler(e)===!1)return!1;if(!this._compositionHelper.keydown(e))return this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;var r=ba.evaluateKeyboardEvent(e,this.applicationCursor,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(e),r.type===3||r.type===2){var i=this.rows-1;return this.scrollLines(r.type===2?-i:i),this.cancel(e,!0)}return r.type===1&&this.selectAll(),this._isThirdLevelShift(this.browser,e)||(r.cancel&&this.cancel(e,!0),!r.key)?!0:(this.emit("keydown",e),this._onKey.fire({key:r.key,domEvent:e}),this.showCursor(),this.handler(r.key),this.cancel(e,!0))},t.prototype._isThirdLevelShift=function(e,r){var i=e.isMac&&!this.options.macOptionIsMeta&&r.altKey&&!r.ctrlKey&&!r.metaKey||e.isMSWindows&&r.altKey&&r.ctrlKey&&!r.metaKey;return r.type==="keypress"?i:i&&(!r.keyCode||r.keyCode>47)},t.prototype.setgLevel=function(e){this.glevel=e,this.charset=this.charsets[e]},t.prototype.setgCharset=function(e,r){this.charsets[e]=r,this.glevel===e&&(this.charset=r)},t.prototype._keyUp=function(e){this.updateCursorStyle(e)},t.prototype._keyPress=function(e){var r;if(this._customKeyEventHandler&&this._customKeyEventHandler(e)===!1)return!1;if(this.cancel(e),e.charCode)r=e.charCode;else if(e.which===null||e.which===void 0)r=e.keyCode;else if(e.which!==0&&e.charCode!==0)r=e.which;else return!1;return!r||(e.altKey||e.ctrlKey||e.metaKey)&&!this._isThirdLevelShift(this.browser,e)?!1:(r=String.fromCharCode(r),this.emit("keypress",r,e),this._onKey.fire({key:r,domEvent:e}),this.showCursor(),this.handler(r),!0)},t.prototype.bell=function(){var e=this;this.emit("bell"),this._soundBell()&&this.soundManager.playBellSound(),this._visualBell()&&(this.element.classList.add("visual-bell-active"),clearTimeout(this._visualBellTimer),this._visualBellTimer=window.setTimeout(function(){e.element.classList.remove("visual-bell-active")},200))},t.prototype.log=function(e,r){this.options.debug&&(!this._context.console||!this._context.console.log||this._context.console.log(e,r))},t.prototype.error=function(e,r){this.options.debug&&(!this._context.console||!this._context.console.error||this._context.console.error(e,r))},t.prototype.resize=function(e,r){if(!(isNaN(e)||isNaN(r))){if(e===this.cols&&r===this.rows){this.charMeasure&&(!this.charMeasure.width||!this.charMeasure.height)&&this.charMeasure.measure(this.options);return}e<Ct&&(e=Ct),r<bt&&(r=bt),this.buffers.resize(e,r),this.cols=e,this.rows=r,this.buffers.setupTabStops(this.cols),this.charMeasure&&this.charMeasure.measure(this.options),this.refresh(0,this.rows-1),this._onResize.fire({cols:e,rows:r})}},t.prototype.updateRange=function(e){e<this._refreshStart&&(this._refreshStart=e),e>this._refreshEnd&&(this._refreshEnd=e)},t.prototype.maxRange=function(){this._refreshStart=0,this._refreshEnd=this.rows-1},t.prototype.clear=function(){if(!(this.buffer.ybase===0&&this.buffer.y===0)){this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(var e=1;e<this.rows;e++)this.buffer.lines.push(this.buffer.getBlankLine(vt.DEFAULT_ATTR_DATA));this.refresh(0,this.rows-1),this._onScroll.fire(this.buffer.ydisp)}},t.prototype.is=function(e){return(this.options.termName+"").indexOf(e)===0},t.prototype.handler=function(e){this.options.disableStdin||(this.selectionManager&&this.selectionManager.hasSelection&&this.selectionManager.clearSelection(),this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),this._onData.fire(e))},t.prototype.handleTitle=function(e){this._onTitleChange.fire(e)},t.prototype.index=function(){this.buffer.y++,this.buffer.y>this.buffer.scrollBottom&&(this.buffer.y--,this.scroll()),this.buffer.x>=this.cols&&this.buffer.x--},t.prototype.reverseIndex=function(){if(this.buffer.y===this.buffer.scrollTop){var e=this.buffer.scrollBottom-this.buffer.scrollTop;this.buffer.lines.shiftElements(this.buffer.y+this.buffer.ybase,e,1),this.buffer.lines.set(this.buffer.y+this.buffer.ybase,this.buffer.getBlankLine(this.eraseAttrData())),this.updateRange(this.buffer.scrollTop),this.updateRange(this.buffer.scrollBottom)}else this.buffer.y--},t.prototype.reset=function(){this.options.rows=this.rows,this.options.cols=this.cols;var e=this._customKeyEventHandler,r=this._inputHandler,i=this.cursorState,s=this.writeBuffer,a=this.writeBufferUtf8,c=this._writeInProgress,o=this._xoffSentToCatchUp,l=this._userScrolling;this._setup(),this._customKeyEventHandler=e,this._inputHandler=r,this.cursorState=i,this.writeBuffer=s,this.writeBufferUtf8=a,this._writeInProgress=c,this._xoffSentToCatchUp=o,this._userScrolling=l,this.refresh(0,this.rows-1),this.viewport&&this.viewport.syncScrollArea()},t.prototype.tabSet=function(){this.buffer.tabs[this.buffer.x]=!0},t.prototype.cancel=function(e,r){if(!(!this.options.cancelEvents&&!r))return e.preventDefault(),e.stopPropagation(),!1},t.prototype._visualBell=function(){return!1},t.prototype._soundBell=function(){return this.options.bellStyle==="sound"},t}(ha.EventEmitter);kt.Terminal=Aa;function La(n){return n.keyCode===16||n.keyCode===17||n.keyCode===18}var ar={};Object.defineProperty(ar,"__esModule",{value:!0});var Ra=function(){function n(){this._addons=[]}return n.prototype.dispose=function(){for(var t=this._addons.length-1;t>=0;t--)this._addons[t].instance.dispose()},n.prototype.loadAddon=function(t,e){var r=this,i={instance:e,dispose:e.dispose,isDisposed:!1};this._addons.push(i),e.dispose=function(){return r._wrappedAddonDispose(i)},e.activate(t)},n.prototype._wrappedAddonDispose=function(t){if(!t.isDisposed){for(var e=-1,r=0;r<this._addons.length;r++)if(this._addons[r]===t){e=r;break}if(e===-1)throw new Error("Could not dispose an addon that has not been loaded");t.isDisposed=!0,t.dispose.apply(t.instance),this._addons.splice(e,1)}},n}();ar.AddonManager=Ra;Object.defineProperty(ti,"__esModule",{value:!0});var Ta=kt,ka=ae,Da=ar,Ma=function(){function n(t){this._core=new Ta.Terminal(t),this._addonManager=new Da.AddonManager}return Object.defineProperty(n.prototype,"onCursorMove",{get:function(){return this._core.onCursorMove},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"onLineFeed",{get:function(){return this._core.onLineFeed},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"onSelectionChange",{get:function(){return this._core.onSelectionChange},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"onData",{get:function(){return this._core.onData},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"onTitleChange",{get:function(){return this._core.onTitleChange},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"onScroll",{get:function(){return this._core.onScroll},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"onKey",{get:function(){return this._core.onKey},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"onRender",{get:function(){return this._core.onRender},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"onResize",{get:function(){return this._core.onResize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"element",{get:function(){return this._core.element},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textarea",{get:function(){return this._core.textarea},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rows",{get:function(){return this._core.rows},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"cols",{get:function(){return this._core.cols},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"buffer",{get:function(){return new Ba(this._core.buffer)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"markers",{get:function(){return this._core.markers},enumerable:!0,configurable:!0}),n.prototype.blur=function(){this._core.blur()},n.prototype.focus=function(){this._core.focus()},n.prototype.on=function(t,e){this._core.on(t,e)},n.prototype.off=function(t,e){this._core.off(t,e)},n.prototype.emit=function(t,e){this._core.emit(t,e)},n.prototype.addDisposableListener=function(t,e){return this._core.addDisposableListener(t,e)},n.prototype.resize=function(t,e){this._core.resize(t,e)},n.prototype.writeln=function(t){this._core.writeln(t)},n.prototype.open=function(t){this._core.open(t)},n.prototype.attachCustomKeyEventHandler=function(t){this._core.attachCustomKeyEventHandler(t)},n.prototype.addCsiHandler=function(t,e){return this._core.addCsiHandler(t,e)},n.prototype.addOscHandler=function(t,e){return this._core.addOscHandler(t,e)},n.prototype.registerLinkMatcher=function(t,e,r){return this._core.registerLinkMatcher(t,e,r)},n.prototype.deregisterLinkMatcher=function(t){this._core.deregisterLinkMatcher(t)},n.prototype.registerCharacterJoiner=function(t){return this._core.registerCharacterJoiner(t)},n.prototype.deregisterCharacterJoiner=function(t){this._core.deregisterCharacterJoiner(t)},n.prototype.addMarker=function(t){return this._core.addMarker(t)},n.prototype.hasSelection=function(){return this._core.hasSelection()},n.prototype.select=function(t,e,r){this._core.select(t,e,r)},n.prototype.getSelection=function(){return this._core.getSelection()},n.prototype.getSelectionPosition=function(){return this._core.getSelectionPosition()},n.prototype.clearSelection=function(){this._core.clearSelection()},n.prototype.selectAll=function(){this._core.selectAll()},n.prototype.selectLines=function(t,e){this._core.selectLines(t,e)},n.prototype.dispose=function(){this._addonManager.dispose(),this._core.dispose()},n.prototype.destroy=function(){this._core.destroy()},n.prototype.scrollLines=function(t){this._core.scrollLines(t)},n.prototype.scrollPages=function(t){this._core.scrollPages(t)},n.prototype.scrollToTop=function(){this._core.scrollToTop()},n.prototype.scrollToBottom=function(){this._core.scrollToBottom()},n.prototype.scrollToLine=function(t){this._core.scrollToLine(t)},n.prototype.clear=function(){this._core.clear()},n.prototype.write=function(t){this._core.write(t)},n.prototype.writeUtf8=function(t){this._core.writeUtf8(t)},n.prototype.getOption=function(t){return this._core.getOption(t)},n.prototype.setOption=function(t,e){this._core.setOption(t,e)},n.prototype.refresh=function(t,e){this._core.refresh(t,e)},n.prototype.reset=function(){this._core.reset()},n.applyAddon=function(t){t.apply(n)},n.prototype.loadAddon=function(t){return this._addonManager.loadAddon(this,t)},Object.defineProperty(n,"strings",{get:function(){return ka},enumerable:!0,configurable:!0}),n}(),He=ti.Terminal=Ma,Ba=function(){function n(t){this._buffer=t}return Object.defineProperty(n.prototype,"cursorY",{get:function(){return this._buffer.y},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"cursorX",{get:function(){return this._buffer.x},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"viewportY",{get:function(){return this._buffer.ydisp},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"baseY",{get:function(){return this._buffer.ybase},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"length",{get:function(){return this._buffer.lines.length},enumerable:!0,configurable:!0}),n.prototype.getLine=function(t){var e=this._buffer.lines.get(t);if(e)return new Oa(e)},n}(),Oa=function(){function n(t){this._line=t}return Object.defineProperty(n.prototype,"isWrapped",{get:function(){return this._line.isWrapped},enumerable:!0,configurable:!0}),n.prototype.getCell=function(t){if(!(t<0||t>=this._line.length))return new Ha(this._line,t)},n.prototype.translateToString=function(t,e,r){return this._line.translateToString(t,e,r)},n}(),Ha=function(){function n(t,e){this._line=t,this._x=e}return Object.defineProperty(n.prototype,"char",{get:function(){return this._line.getString(this._x)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this._line.getWidth(this._x)},enumerable:!0,configurable:!0}),n}();var de={};Object.defineProperty(de,"__esModule",{value:!0});function lr(n){if(!n.element.parentElement)return null;var t=window.getComputedStyle(n.element.parentElement),e=parseInt(t.getPropertyValue("height")),r=Math.max(0,parseInt(t.getPropertyValue("width"))),i=window.getComputedStyle(n.element),s={top:parseInt(i.getPropertyValue("padding-top")),bottom:parseInt(i.getPropertyValue("padding-bottom")),right:parseInt(i.getPropertyValue("padding-right")),left:parseInt(i.getPropertyValue("padding-left"))},a=s.top+s.bottom,c=s.right+s.left,o=e-a,l=r-c-n._core.viewport.scrollBarWidth,u={cols:Math.floor(l/n._core._renderCoordinator.dimensions.actualCellWidth),rows:Math.floor(o/n._core._renderCoordinator.dimensions.actualCellHeight)};return u}var Fa=de.proposeGeometry=lr;function pi(n){var t=lr(n);t&&(n.rows!==t.rows||n.cols!==t.cols)&&(n._core._renderCoordinator.clear(),n.resize(t.cols,t.rows))}var Pa=de.fit=pi;function Ia(n){n.prototype.proposeGeometry=function(){return lr(this)},n.prototype.fit=function(){pi(this)}}var Na=de.apply=Ia;const Wa=et({__proto__:null,apply:Na,default:de,fit:Pa,proposeGeometry:Fa},[de]);var pe={};Object.defineProperty(pe,"__esModule",{value:!0});function mi(n,t,e,r){var i=n;e=typeof e>"u"?!0:e,i.__socket=t,i.__flushBuffer=function(){i.write(i.__attachSocketBuffer),i.__attachSocketBuffer=null},i.__pushToBuffer=function(c){i.__attachSocketBuffer?i.__attachSocketBuffer+=c:(i.__attachSocketBuffer=c,setTimeout(i.__flushBuffer,10))};var s;i.__getMessage=function(c){var o;if(typeof c.data=="object")if(s||(s=new TextDecoder),c.data instanceof ArrayBuffer)o=s.decode(c.data),a(o);else{var l=new FileReader;l.addEventListener("load",function(){o=s.decode(l.result),a(o)}),l.readAsArrayBuffer(c.data)}else if(typeof c.data=="string")a(c.data);else throw Error('Cannot handle "'+typeof c.data+'" websocket message.')};function a(c,o){r?i.__pushToBuffer(c||o):i.write(c||o)}i.__sendData=function(c){t.readyState===1&&t.send(c)},i._core.register(wt(t,"message",i.__getMessage)),e&&(i.__dataListener=i.onData(i.__sendData),i._core.register(i.__dataListener)),i._core.register(wt(t,"close",function(){return Qe(i,t)})),i._core.register(wt(t,"error",function(){return Qe(i,t)}))}var Ua=pe.attach=mi;function wt(n,t,e){return n.addEventListener(t,e),{dispose:function(){e&&(n.removeEventListener(t,e),e=null)}}}function Qe(n,t){var e=n;e.__dataListener.dispose(),e.__dataListener=void 0,t=typeof t>"u"?e.__socket:t,t&&t.removeEventListener("message",e.__getMessage),delete e.__socket}var ja=pe.detach=Qe;function $a(n){n.prototype.attach=function(t,e,r){mi(this,t,e,r)},n.prototype.detach=function(t){Qe(this,t)}}var Ka=pe.apply=$a;const za=et({__proto__:null,apply:Ka,attach:Ua,default:pe,detach:ja},[pe]);var Le={};Object.defineProperty(Le,"__esModule",{value:!0});function yi(n,t){var e;typeof t>"u"?e=n.element.classList.contains("fullscreen")?n.element.classList.remove:n.element.classList.add:t?e=n.element.classList.add:e=n.element.classList.remove,e=e.bind(n.element.classList),e("fullscreen")}var qa=Le.toggleFullScreen=yi;function Va(n){n.prototype.toggleFullScreen=function(t){yi(this,t)}}var Ga=Le.apply=Va;const Ya=et({__proto__:null,apply:Ga,default:Le,toggleFullScreen:qa},[Le]);var me={},hr={};Object.defineProperty(hr,"__esModule",{value:!0});var Nr=" ~!@#$%^&*()+`-=[]{}|;:\"',./<>?",Xa=15*1e3,Ja=function(){function n(t){this._terminal=t,this._linesCache=null,this._linesCacheTimeoutId=0,this._destroyLinesCache=this._destroyLinesCache.bind(this)}return n.prototype.findNext=function(t,e){var r=e.incremental,i;if(!t||t.length===0)return this._terminal.clearSelection(),!1;var s=0,a=this._terminal.buffer.viewportY;if(this._terminal.hasSelection()){var c=this._terminal.getSelectionPosition();a=r?c.startRow:c.endRow,s=r?c.startColumn:c.endColumn}this._initLinesCache();for(var o=a,l=s;this._terminal.buffer.getLine(o).isWrapped;)o--,l+=this._terminal.cols;if(i=this._findInLine(t,o,l,e),!i)for(var u=a+1;u<this._terminal.buffer.baseY+this._terminal.rows&&(i=this._findInLine(t,u,0,e),!i);u++);if(!i)for(var u=0;u<o&&(i=this._findInLine(t,u,0,e),!i);u++);return this._selectResult(i)},n.prototype.findPrevious=function(t,e){var r;if(!t||t.length===0)return this._terminal.clearSelection(),!1;var i=!0,s=this._terminal.buffer.viewportY+this._terminal.rows-1,a=this._terminal.cols;if(this._terminal.hasSelection()){var c=this._terminal.getSelectionPosition();s=c.startRow,a=c.startColumn}if(this._initLinesCache(),r=this._findInLine(t,s,a,e,i),!r){var o=this._terminal.cols;this._terminal.buffer.getLine(s).isWrapped&&(o+=a);for(var l=s-1;l>=0&&(r=this._findInLine(t,l,o,e,i),!r);l--)this._terminal.buffer.getLine(l).isWrapped?o+=this._terminal.cols:o=this._terminal.cols}if(!r)for(var u=this._terminal.buffer.baseY+this._terminal.rows-1,o=this._terminal.cols,l=u;l>=s&&(r=this._findInLine(t,l,o,e,i),!r);l--)this._terminal.buffer.getLine(l).isWrapped?o+=this._terminal.cols:o=this._terminal.cols;return this._selectResult(r)},n.prototype._initLinesCache=function(){var t=this;this._linesCache||(this._linesCache=new Array(this._terminal.buffer.length),this._cursorMoveListener=this._terminal.onCursorMove(function(){return t._destroyLinesCache()}),this._resizeListener=this._terminal.onResize(function(){return t._destroyLinesCache()})),window.clearTimeout(this._linesCacheTimeoutId),this._linesCacheTimeoutId=window.setTimeout(function(){return t._destroyLinesCache()},Xa)},n.prototype._destroyLinesCache=function(){this._linesCache=null,this._cursorMoveListener&&(this._cursorMoveListener.dispose(),this._cursorMoveListener=void 0),this._resizeListener&&(this._resizeListener.dispose(),this._resizeListener=void 0),this._linesCacheTimeoutId&&(window.clearTimeout(this._linesCacheTimeoutId),this._linesCacheTimeoutId=0)},n.prototype._isWholeWord=function(t,e,r){return(t===0||Nr.indexOf(e[t-1])!==-1)&&(t+r.length===e.length||Nr.indexOf(e[t+r.length])!==-1)},n.prototype._findInLine=function(t,e,r,i,s){if(i===void 0&&(i={}),s===void 0&&(s=!1),!this._terminal.buffer.getLine(e).isWrapped){var a=this._linesCache?this._linesCache[e]:void 0;a===void 0&&(a=this.translateBufferLineToStringWithWrap(e,!0),this._linesCache&&(this._linesCache[e]=a));var c=i.caseSensitive?t:t.toLowerCase(),o=i.caseSensitive?a:a.toLowerCase(),l=-1;if(i.regex){var u=RegExp(c,"g"),h=void 0;if(s)for(;h=u.exec(o.slice(0,r));)l=u.lastIndex-h[0].length,t=h[0],u.lastIndex-=t.length-1;else h=u.exec(o.slice(r)),h&&h[0].length>0&&(l=r+(u.lastIndex-h[0].length),t=h[0])}else s?r-c.length>=0&&(l=o.lastIndexOf(c,r-c.length)):l=o.indexOf(c,r);if(l>=0){if(l>=this._terminal.cols&&(e+=Math.floor(l/this._terminal.cols),l=l%this._terminal.cols),i.wholeWord&&!this._isWholeWord(l,o,t))return;for(var f=this._terminal.buffer.getLine(e),_=0;_<l;_++){var d=f.getCell(_),p=d.char;p.length>1&&(l-=p.length-1);var m=d.width;m===0&&l++}return{term:t,col:l,row:e}}}},n.prototype.translateBufferLineToStringWithWrap=function(t,e){var r="",i;do{var s=this._terminal.buffer.getLine(t+1);i=s?s.isWrapped:!1,r+=this._terminal.buffer.getLine(t).translateToString(!i&&e).substring(0,this._terminal.cols),t++}while(i);return r},n.prototype._selectResult=function(t){return t?(this._terminal.select(t.col,t.row,t.term.length),this._terminal.scrollLines(t.row-this._terminal.buffer.viewportY),!0):(this._terminal.clearSelection(),!1)},n}();hr.SearchHelper=Ja;Object.defineProperty(me,"__esModule",{value:!0});var gi=hr;function vi(n,t,e){e===void 0&&(e={});var r=n;return r.__searchHelper||(r.__searchHelper=new gi.SearchHelper(r)),r.__searchHelper.findNext(t,e)}var Za=me.findNext=vi;function Ci(n,t,e){var r=n;return r.__searchHelper||(r.__searchHelper=new gi.SearchHelper(r)),r.__searchHelper.findPrevious(t,e)}var Qa=me.findPrevious=Ci;function el(n){n.prototype.findNext=function(t,e){return vi(this,t,e)},n.prototype.findPrevious=function(t,e){return Ci(this,t,e)}}var tl=me.apply=el;const rl=et({__proto__:null,apply:tl,default:me,findNext:Za,findPrevious:Qa},[me]);He.applyAddon(Wa);He.applyAddon(za);He.applyAddon(Ya);He.applyAddon(rl);const il={class:"terminal",id:"terminal"},nl={__name:"shell",setup(n){let t=Ye(window.location.origin+"/terminal",{reconnection:!0}),e="wt-cli-"+Math.random().toString(36).substr(3);function r(i=null){let s=new He({theme:null,fontWeight:400,fontSize:16,fontFamily:"FuraMono Nerd Font,Cascadia Code,Courier New,monospace",rows:40,cols:100}),a=document.getElementById("terminal");s.open(a),s.fit(),s.focus(),s.onResize("resize",c=>{t.emit(e+"-resize",[c.cols,c.rows])}),s.onData(c=>{t.emit(e+"-input",c)}),t.on(e+"-output",c=>{s.write(c)}),window.addEventListener("resize",()=>{s.fit()}),t.emit("create",{name:e,cwd:i})}return wi(()=>{r(),t.on("connect",()=>{console.log(t.id,"-connect")})}),xi(()=>{term.destroy(),t.emit(e+"-exit"),t.close()}),(i,s)=>(Si(),Ei("div",il))}},ll=bi(nl,[["__scopeId","data-v-9214e54e"]]);export{ll as default};
